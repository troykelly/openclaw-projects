# openclaw-projects environment configuration
#
# Copy to .env and edit as needed:
#   cp .env.example .env
#
# Required variables are marked with (REQUIRED)
# Variables with defaults show their default value
# 
# For production deployment with Traefik, see docker-compose.traefik.yml
# For basic deployment behind existing proxy, see docker-compose.yml

# =============================================================================
# Core Application Settings
# =============================================================================

# Public base URL — the app/root domain (NOT the api subdomain).
# Used for magic-link redirects, share links, and CORS origin.
# In production with Traefik: https://yourdomain.com
# In local dev: http://localhost:3000 (API and app are same-origin)
PUBLIC_BASE_URL=http://localhost:3000

# Cookie signing secret (REQUIRED)
# Generate a long random string:
#   openssl rand -base64 48
COOKIE_SECRET=

# M2M API token for OpenClaw plugin/gateway requests (REQUIRED for production)
# This is a long-lived JWT that authenticates machine-to-machine API requests.
# Generate with: JWT_SECRET=<your-jwt-secret> pnpm run generate-api-token
OPENCLAW_API_TOKEN=

# Disable auth entirely (NOT RECOMMENDED - development only!)
# OPENCLAW_PROJECTS_AUTH_DISABLED=false

# Node environment (production, development, test)
# NODE_ENV=production

# =============================================================================
# Service Ports
# =============================================================================

# API server port (default: 3000)
API_PORT=3000

# Frontend app port (default: 8080)
FRONTEND_PORT=8080

# SeaweedFS S3 port (default: 8333)
# SEAWEEDFS_PORT=8333

# =============================================================================
# PostgreSQL Database
# =============================================================================

# Database user (default: openclaw)
POSTGRES_USER=openclaw

# Database password (REQUIRED)
# Use a strong password in production
POSTGRES_PASSWORD=

# Database name (default: openclaw)
POSTGRES_DB=openclaw

# PostgreSQL connection parameters (used by API, usually auto-configured)
# PGHOST=db
# PGPORT=5432
# PGUSER=${POSTGRES_USER}
# PGPASSWORD=${POSTGRES_PASSWORD}
# PGDATABASE=${POSTGRES_DB}

# =============================================================================
# S3-Compatible Storage (SeaweedFS)
# =============================================================================

# S3 endpoint URL (auto-configured for internal SeaweedFS in compose)
# S3_ENDPOINT=http://seaweedfs:8333

# S3 bucket name (default: openclaw)
S3_BUCKET=openclaw

# S3 region (default: us-east-1, required for AWS S3)
S3_REGION=us-east-1

# S3 access key (default: openclaw)
# This key is used by both the API and SeaweedFS for authentication
# SeaweedFS will reject requests that don't have valid credentials
S3_ACCESS_KEY=openclaw

# S3 secret key (REQUIRED)
# Used by both API and SeaweedFS for authentication. All S3 requests require valid credentials.
# Generate with: openssl rand -hex 32
S3_SECRET_KEY=

# Force path-style access (required for SeaweedFS, default: true)
# Set to false for AWS S3 with virtual-hosted-style
# S3_FORCE_PATH_STYLE=true

# =============================================================================
# SeaweedFS Configuration
# =============================================================================

# Maximum volume size in MB
# Basic compose default: 1000MB
# Production default: 30000MB
SEAWEEDFS_VOLUME_SIZE_LIMIT_MB=1000

# =============================================================================
# Email Integration (Postmark)
# =============================================================================

# Postmark is used for transactional emails (magic links, notifications)
# If unconfigured, magic links work only in development mode

# Postmark server token for transactional emails
# Get from Postmark dashboard: https://account.postmarkapp.com/servers
# POSTMARK_TRANSACTIONAL_TOKEN=your-token-here

# Alternative: load token from file (for Docker secrets)
# POSTMARK_TRANSACTIONAL_TOKEN_FILE=/run/secrets/postmark_transactional_token

# Postmark server token for broadcast emails (newsletters, marketing)
# POSTMARK_BROADCAST_TOKEN_FILE=/run/secrets/postmark_broadcast_token

# From address for emails (must be verified sender in Postmark)
# POSTMARK_FROM=Projects <projects@example.com>

# Reply-to address
# POSTMARK_REPLY_TO=support@example.com

# Postmark message stream (default: outbound)
# POSTMARK_MESSAGE_STREAM=outbound

# Enable test email sending in non-production mode
# POSTMARK_ENABLE_TEST_SEND=false

# =============================================================================
# SMS Integration (Twilio)
# =============================================================================

# Twilio is used for SMS notifications and reminders
# All three variables required for SMS functionality

# Twilio Account SID (starts with AC)
# Get from Twilio Console: https://console.twilio.com/
# TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Twilio Auth Token
# TWILIO_AUTH_TOKEN=your-auth-token

# Twilio phone number for sending SMS (E.164 format)
# TWILIO_FROM_NUMBER=+15551234567

# =============================================================================
# Inbound Webhook Authentication
# =============================================================================

# These credentials authenticate inbound webhooks from external services
# (Twilio, Postmark, Cloudflare). Each webhook endpoint uses its own auth
# mechanism independent of JWT/bearer token authentication.

# Postmark inbound webhook Basic Auth credentials
# Used to authenticate Postmark delivery status and inbound email webhooks
# Configure matching credentials in your Postmark server webhook settings
# POSTMARK_WEBHOOK_USERNAME=your-webhook-username
# POSTMARK_WEBHOOK_PASSWORD=your-webhook-password

# Cloudflare Email Workers webhook shared secret
# Used to authenticate inbound email webhooks from Cloudflare Email Routing
# Set the same secret in your Cloudflare Email Worker environment
# CLOUDFLARE_EMAIL_SECRET=your-shared-secret

# =============================================================================
# Embedding Providers (for semantic search / pgvector)
# =============================================================================

# Which embedding provider to use (openai, voyagerai, gemini)
# EMBEDDING_PROVIDER=openai

# OpenAI API key for embeddings (ada-002)
# Get from: https://platform.openai.com/api-keys
# OPENAI_API_KEY=sk-...

# Alternative: load from file
# OPENAI_API_KEY_FILE=/path/to/key

# Alternative: load from command
# OPENAI_API_KEY_COMMAND=op read 'op://vault/openai/key'

# VoyageAI API key for embeddings
# Get from: https://dash.voyageai.com/
# VOYAGERAI_API_KEY=pa-...

# Alternative: load from file
# VOYAGERAI_API_KEY_FILE=/path/to/key

# Google Gemini API key for embeddings
# Get from: https://makersuite.google.com/app/apikey
# GEMINI_API_KEY=...

# Alternative: load from file
# GEMINI_API_KEY_FILE=/path/to/key

# =============================================================================
# OAuth Integration (Microsoft 365 / Google)
# =============================================================================

# Required for contacts, email, drive/files, and calendar features.
# See docs/guides/oauth-setup.md for step-by-step credential setup.
#
# If unconfigured, OAuth features are silently disabled (no error).
# In production, OAUTH_TOKEN_ENCRYPTION_KEY is REQUIRED to encrypt tokens at rest.

# --- Microsoft 365 / Azure AD ---
# Create an Azure AD app registration: docs/guides/oauth-setup.md#microsoft-365--azure-ad
#
# MS365_CLIENT_ID=your-application-client-id
# MS365_CLIENT_SECRET=your-client-secret

# Optional: restrict to a single Azure AD tenant (omit for multi-tenant /common/)
# AZURE_TENANT_ID=your-tenant-id

# --- Google ---
# Create Google Cloud OAuth credentials: docs/guides/oauth-setup.md#google
#
# GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
# GOOGLE_CLIENT_SECRET=your-client-secret

# --- Shared OAuth settings ---

# Redirect URI for OAuth callbacks. Must exactly match provider console config.
# Default: http://localhost:3000/api/oauth/callback
# For Traefik deployments: https://api.yourdomain.com/api/oauth/callback
# OAUTH_REDIRECT_URI=https://api.yourdomain.com/api/oauth/callback

# Token encryption master key (REQUIRED for production)
# Tokens are stored in plaintext without this key — unacceptable for production.
# Generate with: openssl rand -hex 32
# WARNING: Changing this key invalidates all existing encrypted tokens.
# OAUTH_TOKEN_ENCRYPTION_KEY=

# =============================================================================
# Nominatim (Reverse Geocoding)
# =============================================================================

# Self-hosted OpenStreetMap geocoder for geo-contextual search features.
# On first start, imports the PBF extract (this takes 10+ minutes depending
# on region size). After import, the service provides fast local geocoding.
# If NOMINATIM_URL is not set, geo features silently degrade (no error).

# Internal URL for the API to reach Nominatim (auto-configured in compose)
# NOMINATIM_URL=http://nominatim:8080

# OpenStreetMap PBF extract to import (determines which region is available)
# Find regional extracts at: https://download.geofabrik.de/
# Default: Australia (change to your deployment region)
# NOMINATIM_PBF_URL=https://download.geofabrik.de/australia-oceania/australia-latest.osm.pbf

# Replication URL for incremental updates from OpenStreetMap
# Must correspond to the PBF extract region
# NOMINATIM_REPLICATION_URL=https://download.geofabrik.de/australia-oceania/australia-updates/

# Password for the Nominatim internal PostgreSQL database
# NOMINATIM_PASSWORD=openclaw

# Nominatim host port (default: 8180 to avoid conflicts with other services)
# For basic compose: NOMINATIM_PORT=8180
# For traefik/full compose: NOMINATIM_HOST_PORT=8180

# =============================================================================
# OpenClaw Integration
# =============================================================================

# OpenClaw gateway URL for hooks and callbacks
# For docker-compose.traefik.yml (gateway runs on host):
#   OPENCLAW_GATEWAY_URL=http://host.docker.internal:18789
# For docker-compose.full.yml (gateway runs in Docker): auto-configured
# OPENCLAW_GATEWAY_URL=http://host.docker.internal:18789

# Authentication token for OpenClaw webhooks
# OPENCLAW_HOOK_TOKEN=your-hook-token

# Default model for OpenClaw interactions
# OPENCLAW_DEFAULT_MODEL=gpt-4

# Timeout for OpenClaw API calls in seconds
# OPENCLAW_TIMEOUT_SECONDS=30

# =============================================================================
# CORS (Cross-Origin Resource Sharing)
# =============================================================================

# Comma-separated list of allowed origins for CORS requests.
# Falls back to PUBLIC_BASE_URL, then http://localhost:3000.
# Example: https://app.example.com,https://admin.example.com
# CORS_ALLOWED_ORIGINS=

# =============================================================================
# Rate Limiting and Security
# =============================================================================

# Maximum requests per window (default: 100)
# RATE_LIMIT_MAX=100

# Rate limit window in milliseconds (default: 60000 = 1 minute)
# RATE_LIMIT_WINDOW_MS=60000

# Disable rate limiting (development only!)
# RATE_LIMIT_DISABLED=false

# Disable webhook IP whitelist validation (development only!)
# WEBHOOK_IP_WHITELIST_DISABLED=false

# (Auth configuration moved to Core Application Settings section above)

# JWT signing secret for API access tokens (REQUIRED for production)
# Must be at least 32 bytes. Used for HS256 signing.
# Generate with: openssl rand -base64 48
JWT_SECRET=

# Previous JWT secret for key rotation (optional)
# When rotating secrets, move the old JWT_SECRET here so tokens signed
# with the previous key remain valid until they expire.
# JWT_SECRET_PREVIOUS=

# =============================================================================
# File Upload Settings
# =============================================================================

# Maximum file upload size in bytes (default: 10MB = 10485760)
# MAX_FILE_SIZE_BYTES=10485760

# =============================================================================
# Traefik/TLS Configuration (docker-compose.traefik.yml only)
# =============================================================================

# Your domain name (REQUIRED for Traefik deployment)
# DOMAIN=example.com

# Email address for ACME/Let's Encrypt notifications (REQUIRED)
# ACME_EMAIL=admin@example.com

# DNS provider for ACME DNS-01 challenge (default: cloudflare)
# See DNS Provider section below for available options
# ACME_DNS_PROVIDER=cloudflare

# HTTPS port (default: 443)
# HTTPS_PORT=443

# HTTP port (default: 80, used for redirect to HTTPS)
# HTTP_PORT=80

# Disable HTTP listener entirely (use when behind another load balancer)
# DISABLE_HTTP=false

# Trusted IP ranges for proxy protocol/forwarded headers (comma-separated CIDRs)
# Example: TRUSTED_IPS=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
# TRUSTED_IPS=

# =============================================================================
# Host Networking Ports (docker-compose.traefik.yml / docker-compose.full.yml)
# =============================================================================

# Traefik runs with network_mode: host for real client IP visibility.
# Backend services publish their ports to localhost for Traefik to reach.
# Each port is published on both [::1] (IPv6, preferred) and 127.0.0.1 (IPv4 fallback).

# Address Traefik uses to reach backend services (default: [::1])
# Set to 127.0.0.1 for IPv4-only hosts
# SERVICE_HOST=[::1]

# ModSecurity WAF host port (container listens on 8080)
# MODSEC_HOST_PORT=8080

# API server host port (container listens on 3001)
# API_HOST_PORT=3001

# Frontend app host port (default: 8081, different from container port 8080
# to avoid conflict with ModSecurity)
# APP_HOST_PORT=8081

# OpenClaw Gateway host port (docker-compose.full.yml only, container listens on 18789)
# GATEWAY_HOST_PORT=18789

# SeaweedFS S3 host port (container listens on 8333)
# Published to localhost for Traefik to route s3.DOMAIN presigned URLs
# SEAWEEDFS_HOST_PORT=8333

# External S3 endpoint for presigned URL rewriting
# When set, the API rewrites internal S3 presigned URLs to use this public address.
# Default in Traefik compose: https://s3.${DOMAIN}
# Requires a DNS record for s3.DOMAIN pointing to the Traefik host.
# S3_EXTERNAL_ENDPOINT=https://s3.example.com

# =============================================================================
# DNS Provider Configuration
# =============================================================================

# DNS-01 challenge is required for wildcard certificates and split-horizon DNS
#
# Supported providers: See full list at:
# https://go-acme.github.io/lego/dns/
#
# Each provider requires specific environment variables.
# Below are examples for common providers.

# -----------------------------------------------------------------------------
# Cloudflare (ACME_DNS_PROVIDER=cloudflare)
# -----------------------------------------------------------------------------
# API Token with Zone:DNS:Edit permission
# Create at: https://dash.cloudflare.com/profile/api-tokens
# CF_DNS_API_TOKEN=your-cloudflare-api-token

# Alternative: Global API Key (less secure, not recommended)
# CF_API_KEY=your-global-api-key
# CF_API_EMAIL=your-cloudflare-email

# -----------------------------------------------------------------------------
# AWS Route53 (ACME_DNS_PROVIDER=route53)
# -----------------------------------------------------------------------------
# IAM user credentials with Route53 permissions
# AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
# AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

# Hosted Zone ID for your domain
# AWS_HOSTED_ZONE_ID=Z1234567890ABC

# AWS region (default: us-east-1)
# AWS_REGION=us-east-1

# =============================================================================
# ModSecurity/WAF Configuration (docker-compose.traefik.yml only)
# =============================================================================

# ModSecurity provides OWASP Core Rule Set protection for the API
#
# Paranoia Level (1-4):
#   1 = Low false positives, basic protection (recommended for most sites)
#   2 = Moderate protection, some false positives
#   3 = High security, more false positives
#   4 = Maximum security, expect false positives (requires tuning)
# MODSEC_PARANOIA_LEVEL=1

# Anomaly scoring thresholds
# Lower values = stricter (more blocking)
# MODSEC_ANOMALY_INBOUND=5
# MODSEC_ANOMALY_OUTBOUND=4

# Enable/disable ModSecurity (default: enabled)
# MODSEC_ENABLED=true

# =============================================================================
# OpenClaw Gateway (docker-compose.full.yml only)
# =============================================================================

# The full-fat compose includes an OpenClaw gateway for a complete self-hosted
# AI assistant deployment. Configure these settings when using docker-compose.full.yml

# Gateway authentication token (REQUIRED for full compose)
# This token is used to authenticate with the OpenClaw gateway dashboard and API
# Generate with: openssl rand -hex 32
# OPENCLAW_GATEWAY_TOKEN=your-gateway-token

# OpenClaw Docker image (default: pre-built image from phioranex)
# Alternative: Use 'openclaw:local' if building locally
# OPENCLAW_IMAGE=ghcr.io/phioranex/openclaw-docker:latest

# Default AI model to use
# Options depend on configured API keys (see Model Provider Credentials below)
# OPENCLAW_DEFAULT_MODEL=gpt-4-turbo

# -----------------------------------------------------------------------------
# Model Provider Credentials (at least one required for full compose)
# -----------------------------------------------------------------------------

# Anthropic Claude API key
# Get from: https://console.anthropic.com/
# ANTHROPIC_API_KEY=sk-ant-...

# Google AI (Gemini) API key
# Get from: https://makersuite.google.com/app/apikey
# GOOGLE_AI_API_KEY=...

# Note: OPENAI_API_KEY is also used by OpenClaw gateway (configured above in Embedding section)

# -----------------------------------------------------------------------------
# Channel Credentials (configure as needed)
# -----------------------------------------------------------------------------

# Telegram Bot Token
# Create a bot via @BotFather on Telegram
# TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz

# Discord Bot Token
# Create at: https://discord.com/developers/applications
# DISCORD_BOT_TOKEN=your-discord-bot-token
# DISCORD_APPLICATION_ID=your-discord-app-id

# WhatsApp via Twilio (uses TWILIO_* settings above plus:)
# TWILIO_WHATSAPP_NUMBER=+14155238886

# Slack Bot
# Create at: https://api.slack.com/apps
# SLACK_BOT_TOKEN=xoxb-...
# SLACK_APP_TOKEN=xapp-...
# SLACK_SIGNING_SECRET=your-signing-secret

# =============================================================================
# Frontend (Vite build-time)
# =============================================================================

# Override the API base URL for the frontend SPA (optional).
# When unset, the frontend derives the URL from the hostname:
#   localhost/127.0.0.1 → same-origin (empty, nginx proxy)
#   production → https://api.{domain}
# Set this for custom deployments where the convention doesn't apply.
# VITE_API_URL=

# =============================================================================
# Development/Testing
# =============================================================================

# Host binding for API server (default: ::, dual-stack)
# HOST=::

# API port (internal, default: 3000)
# PORT=3000

