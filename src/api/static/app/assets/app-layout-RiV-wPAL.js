import{r as s,j as t,u as zt,a as Ft,O as Ht}from"./index-dxUAcY-k.js";import{c as ut,u as mt,a as L,b as de,B as je}from"./button-BqoICpPk.js";import{P as Gt,c as Z,a as Wt,b as qt}from"./index-6gjEHE0t.js";import{R as Bt,A as Vt,P as Ut,a as Qt,c as ft,D as Jt,C as Yt}from"./index-BOjStPRS.js";import{u as Q,a as Xt}from"./index-VD3BCwW8.js";import{P as pt}from"./index-CsDA_5tK.js";import{R as Zt,S as $e,a as Ke,b as ze,c as Fe,d as ye}from"./select-Dd62rKlS.js";import{S as ht}from"./scroll-area-DwP-oL9g.js";import{C as er}from"./chevron-left-BKlCu-X2.js";import{P as ke}from"./plus-xSznKAtD.js";import{B as Qe}from"./bell-CucetOzx.js";import{F as ue}from"./folder-CTsiFJB2.js";import{C as Je,U as Ye,F as He}from"./users-B5K-FOO3.js";import{S as we}from"./search-DzLi3Dj6.js";import{S as tt}from"./settings-B_F8Y7Ha.js";import{C as Ge}from"./chevron-right-gRUN2IWL.js";import{D as Ce,a as Ne,b as Se,c as Ee,d as Te,R as tr,P as rr,O as nr,C as sr,e as xt}from"./dialog-BASUQdY5.js";import{S as ar,P as W}from"./separator-DJqU-5tf.js";import{C as or}from"./clock-C-2K3YI1.js";import{U as ir}from"./user-BwVCIEz4.js";import{I as We}from"./input-Te8OuQDQ.js";import{L as gt}from"./loader-circle-Du13m5LB.js";import{T as lr}from"./textarea-C1kQ-UYx.js";import{a as cr}from"./api-client-CDvRtWmo.js";import{r as dr}from"./work-item-utils-RZsWa1qH.js";import"./index-BdQq_4o_.js";import"./chevron-down-DvGeT3kk.js";const ur=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],mr=ut("hash",ur);const fr=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],pr=ut("house",fr);var[Ie]=Wt("Tooltip",[ft]),Pe=ft(),vt="TooltipProvider",hr=700,qe="tooltip.open",[xr,Xe]=Ie(vt),bt=e=>{const{__scopeTooltip:r,delayDuration:n=hr,skipDelayDuration:o=300,disableHoverableContent:a=!1,children:i}=e,l=s.useRef(!0),d=s.useRef(!1),c=s.useRef(0);return s.useEffect(()=>{const u=c.current;return()=>window.clearTimeout(u)},[]),t.jsx(xr,{scope:r,isOpenDelayedRef:l,delayDuration:n,onOpen:s.useCallback(()=>{window.clearTimeout(c.current),l.current=!1},[]),onClose:s.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>l.current=!0,o)},[o]),isPointerInTransitRef:d,onPointerInTransitChange:s.useCallback(u=>{d.current=u},[]),disableHoverableContent:a,children:i})};bt.displayName=vt;var me="Tooltip",[gr,fe]=Ie(me),yt=e=>{const{__scopeTooltip:r,children:n,open:o,defaultOpen:a,onOpenChange:i,disableHoverableContent:l,delayDuration:d}=e,c=Xe(me,e.__scopeTooltip),u=Pe(r),[p,f]=s.useState(null),v=Q(),x=s.useRef(0),y=l??c.disableHoverableContent,E=d??c.delayDuration,g=s.useRef(!1),[w,C]=Xt({prop:o,defaultProp:a??!1,onChange:h=>{h?(c.onOpen(),document.dispatchEvent(new CustomEvent(qe))):c.onClose(),i?.(h)},caller:me}),R=s.useMemo(()=>w?g.current?"delayed-open":"instant-open":"closed",[w]),T=s.useCallback(()=>{window.clearTimeout(x.current),x.current=0,g.current=!1,C(!0)},[C]),S=s.useCallback(()=>{window.clearTimeout(x.current),x.current=0,C(!1)},[C]),N=s.useCallback(()=>{window.clearTimeout(x.current),x.current=window.setTimeout(()=>{g.current=!0,C(!0),x.current=0},E)},[E,C]);return s.useEffect(()=>()=>{x.current&&(window.clearTimeout(x.current),x.current=0)},[]),t.jsx(Bt,{...u,children:t.jsx(gr,{scope:r,contentId:v,open:w,stateAttribute:R,trigger:p,onTriggerChange:f,onTriggerEnter:s.useCallback(()=>{c.isOpenDelayedRef.current?N():T()},[c.isOpenDelayedRef,N,T]),onTriggerLeave:s.useCallback(()=>{y?S():(window.clearTimeout(x.current),x.current=0)},[S,y]),onOpen:T,onClose:S,disableHoverableContent:y,children:n})})};yt.displayName=me;var Be="TooltipTrigger",jt=s.forwardRef((e,r)=>{const{__scopeTooltip:n,...o}=e,a=fe(Be,n),i=Xe(Be,n),l=Pe(n),d=s.useRef(null),c=mt(r,d,a.onTriggerChange),u=s.useRef(!1),p=s.useRef(!1),f=s.useCallback(()=>u.current=!1,[]);return s.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),t.jsx(Vt,{asChild:!0,...l,children:t.jsx(Gt.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...o,ref:c,onPointerMove:Z(e.onPointerMove,v=>{v.pointerType!=="touch"&&!p.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),p.current=!0)}),onPointerLeave:Z(e.onPointerLeave,()=>{a.onTriggerLeave(),p.current=!1}),onPointerDown:Z(e.onPointerDown,()=>{a.open&&a.onClose(),u.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:Z(e.onFocus,()=>{u.current||a.onOpen()}),onBlur:Z(e.onBlur,a.onClose),onClick:Z(e.onClick,a.onClose)})})});jt.displayName=Be;var Ze="TooltipPortal",[vr,br]=Ie(Ze,{forceMount:void 0}),kt=e=>{const{__scopeTooltip:r,forceMount:n,children:o,container:a}=e,i=fe(Ze,r);return t.jsx(vr,{scope:r,forceMount:n,children:t.jsx(pt,{present:n||i.open,children:t.jsx(Ut,{asChild:!0,container:a,children:o})})})};kt.displayName=Ze;var ne="TooltipContent",wt=s.forwardRef((e,r)=>{const n=br(ne,e.__scopeTooltip),{forceMount:o=n.forceMount,side:a="top",...i}=e,l=fe(ne,e.__scopeTooltip);return t.jsx(pt,{present:o||l.open,children:l.disableHoverableContent?t.jsx(Ct,{side:a,...i,ref:r}):t.jsx(yr,{side:a,...i,ref:r})})}),yr=s.forwardRef((e,r)=>{const n=fe(ne,e.__scopeTooltip),o=Xe(ne,e.__scopeTooltip),a=s.useRef(null),i=mt(r,a),[l,d]=s.useState(null),{trigger:c,onClose:u}=n,p=a.current,{onPointerInTransitChange:f}=o,v=s.useCallback(()=>{d(null),f(!1)},[f]),x=s.useCallback((y,E)=>{const g=y.currentTarget,w={x:y.clientX,y:y.clientY},C=Cr(w,g.getBoundingClientRect()),R=Nr(w,C),T=Sr(E.getBoundingClientRect()),S=Tr([...R,...T]);d(S),f(!0)},[f]);return s.useEffect(()=>()=>v(),[v]),s.useEffect(()=>{if(c&&p){const y=g=>x(g,p),E=g=>x(g,c);return c.addEventListener("pointerleave",y),p.addEventListener("pointerleave",E),()=>{c.removeEventListener("pointerleave",y),p.removeEventListener("pointerleave",E)}}},[c,p,x,v]),s.useEffect(()=>{if(l){const y=E=>{const g=E.target,w={x:E.clientX,y:E.clientY},C=c?.contains(g)||p?.contains(g),R=!Er(w,l);C?v():R&&(v(),u())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[c,p,l,u,v]),t.jsx(Ct,{...e,ref:i})}),[jr,kr]=Ie(me,{isInside:!1}),wr=qt("TooltipContent"),Ct=s.forwardRef((e,r)=>{const{__scopeTooltip:n,children:o,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:l,...d}=e,c=fe(ne,n),u=Pe(n),{onClose:p}=c;return s.useEffect(()=>(document.addEventListener(qe,p),()=>document.removeEventListener(qe,p)),[p]),s.useEffect(()=>{if(c.trigger){const f=v=>{v.target?.contains(c.trigger)&&p()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[c.trigger,p]),t.jsx(Jt,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:l,onFocusOutside:f=>f.preventDefault(),onDismiss:p,children:t.jsxs(Yt,{"data-state":c.stateAttribute,...u,...d,ref:r,style:{...d.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[t.jsx(wr,{children:o}),t.jsx(jr,{scope:n,isInside:!0,children:t.jsx(Zt,{id:c.contentId,role:"tooltip",children:a||o})})]})})});wt.displayName=ne;var Nt="TooltipArrow",St=s.forwardRef((e,r)=>{const{__scopeTooltip:n,...o}=e,a=Pe(n);return kr(Nt,n).isInside?null:t.jsx(Qt,{...a,...o,ref:r})});St.displayName=Nt;function Cr(e,r){const n=Math.abs(r.top-e.y),o=Math.abs(r.bottom-e.y),a=Math.abs(r.right-e.x),i=Math.abs(r.left-e.x);switch(Math.min(n,o,a,i)){case i:return"left";case a:return"right";case n:return"top";case o:return"bottom";default:throw new Error("unreachable")}}function Nr(e,r,n=5){const o=[];switch(r){case"top":o.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":o.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":o.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":o.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return o}function Sr(e){const{top:r,right:n,bottom:o,left:a}=e;return[{x:a,y:r},{x:n,y:r},{x:n,y:o},{x:a,y:o}]}function Er(e,r){const{x:n,y:o}=e;let a=!1;for(let i=0,l=r.length-1;i<r.length;l=i++){const d=r[i],c=r[l],u=d.x,p=d.y,f=c.x,v=c.y;p>o!=v>o&&n<(f-u)*(o-p)/(v-p)+u&&(a=!a)}return a}function Tr(e){const r=e.slice();return r.sort((n,o)=>n.x<o.x?-1:n.x>o.x?1:n.y<o.y?-1:n.y>o.y?1:0),Ir(r)}function Ir(e){if(e.length<=1)return e.slice();const r=[];for(let o=0;o<e.length;o++){const a=e[o];for(;r.length>=2;){const i=r[r.length-1],l=r[r.length-2];if((i.x-l.x)*(a.y-l.y)>=(i.y-l.y)*(a.x-l.x))r.pop();else break}r.push(a)}r.pop();const n=[];for(let o=e.length-1;o>=0;o--){const a=e[o];for(;n.length>=2;){const i=n[n.length-1],l=n[n.length-2];if((i.x-l.x)*(a.y-l.y)>=(i.y-l.y)*(a.x-l.x))n.pop();else break}n.push(a)}return n.pop(),r.length===1&&n.length===1&&r[0].x===n[0].x&&r[0].y===n[0].y?r:r.concat(n)}var Pr=bt,Rr=yt,Dr=jt,Ar=kt,_r=wt,Lr=St;function Et({delayDuration:e=0,...r}){return t.jsx(Pr,{"data-slot":"tooltip-provider",delayDuration:e,...r})}function ge({...e}){return t.jsx(Et,{children:t.jsx(Rr,{"data-slot":"tooltip",...e})})}function ve({...e}){return t.jsx(Dr,{"data-slot":"tooltip-trigger",...e})}function be({className:e,sideOffset:r=0,children:n,...o}){return t.jsx(Ar,{children:t.jsxs(_r,{"data-slot":"tooltip-content",sideOffset:r,className:L("bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...o,children:[n,t.jsx(Lr,{className:"bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}const Mr=[{id:"activity",label:"Activity",icon:Qe},{id:"projects",label:"Projects",icon:ue},{id:"timeline",label:"Timeline",icon:Je},{id:"people",label:"People",icon:Ye}];function Or({items:e=Mr,activeItem:r="activity",onItemClick:n,onCreateClick:o,collapsed:a=!1,onCollapsedChange:i,className:l}){const d=()=>{i?.(!a)};return t.jsx(Et,{delayDuration:0,children:t.jsxs("aside",{"data-testid":"sidebar","data-collapsed":a,className:L("flex h-full flex-col border-r border-border bg-surface z-20 transition-all duration-300 ease-out",a?"w-16":"w-60",l),children:[t.jsxs("div",{className:"flex h-14 items-center px-4",children:[t.jsxs("div",{className:L("flex items-center gap-3",a&&"justify-center w-full"),children:[t.jsx("div",{className:"flex size-8 items-center justify-center rounded-lg bg-gradient-to-br from-primary to-primary/70 shadow-sm",children:t.jsx("span",{className:"text-sm font-bold text-primary-foreground",children:"O"})}),!a&&t.jsx("span",{className:"text-base font-semibold tracking-tight text-foreground",children:"OpenClaw Projects"})]}),!a&&t.jsx("button",{onClick:d,className:"ml-auto flex size-6 items-center justify-center rounded-md text-muted-foreground hover:bg-muted hover:text-foreground transition-colors","aria-label":"Collapse sidebar",children:t.jsx(er,{className:"size-4"})})]}),o&&t.jsx("div",{className:"px-3 pt-4",children:t.jsxs(ge,{children:[t.jsx(ve,{asChild:!0,children:t.jsxs("button",{onClick:o,className:L("flex w-full items-center justify-center gap-2 rounded-lg bg-primary px-3 py-2.5 text-sm font-medium text-primary-foreground shadow-sm transition-colors hover:bg-primary/90",a&&"px-0"),"aria-label":"Create new work item",children:[t.jsx(ke,{className:"size-[18px] shrink-0"}),!a&&t.jsx("span",{children:"Create"})]})}),a&&t.jsxs(be,{side:"right",sideOffset:8,className:"font-medium",children:["Create ",t.jsx("kbd",{className:"ml-1 text-[10px]",children:"N"})]})]})}),t.jsx(ht,{className:"flex-1 px-3 py-4",children:t.jsx("nav",{className:"flex flex-col gap-1",role:"navigation","aria-label":"Main navigation",children:e.map(c=>{const u=c.icon,p=r===c.id,f=t.jsxs("button",{onClick:()=>{c.onClick?.(),n?.(c)},className:L("group flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm font-medium transition-all duration-150",a&&"justify-center px-0",p?"bg-primary/10 text-primary shadow-sm":"text-muted-foreground hover:bg-muted hover:text-foreground"),"aria-current":p?"page":void 0,children:[t.jsx(u,{className:L("size-[18px] shrink-0 transition-transform duration-150",!p&&"group-hover:scale-110")}),!a&&t.jsx("span",{children:c.label})]},c.id);return a?t.jsxs(ge,{children:[t.jsx(ve,{asChild:!0,children:f}),t.jsx(be,{side:"right",sideOffset:8,className:"font-medium",children:c.label})]},c.id):f})})}),t.jsxs("div",{className:"border-t border-border p-3 space-y-1",children:[t.jsxs(ge,{children:[t.jsx(ve,{asChild:!0,children:t.jsxs("button",{className:L("flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",a&&"justify-center px-0"),onClick:()=>n?.({id:"search",label:"Search",icon:we}),children:[t.jsx(we,{className:"size-[18px] shrink-0"}),!a&&t.jsxs("span",{className:"flex flex-1 items-center justify-between",children:[t.jsx("span",{children:"Search"}),t.jsx("kbd",{className:"hidden rounded border border-border bg-muted px-1.5 py-0.5 text-[10px] font-medium text-muted-foreground sm:inline-block",children:"⌘K"})]})]})}),a&&t.jsxs(be,{side:"right",sideOffset:8,className:"font-medium",children:["Search ",t.jsx("kbd",{className:"ml-1 text-[10px]",children:"⌘K"})]})]}),t.jsxs(ge,{children:[t.jsx(ve,{asChild:!0,children:t.jsxs("button",{className:L("flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm transition-colors",a&&"justify-center px-0",r==="settings"?"bg-primary/10 text-primary shadow-sm":"text-muted-foreground hover:bg-muted hover:text-foreground"),onClick:()=>n?.({id:"settings",label:"Settings",icon:tt}),children:[t.jsx(tt,{className:"size-[18px] shrink-0"}),!a&&t.jsx("span",{children:"Settings"})]})}),a&&t.jsx(be,{side:"right",sideOffset:8,className:"font-medium",children:"Settings"})]}),a&&t.jsx("button",{onClick:d,className:"mt-2 flex w-full items-center justify-center rounded-lg py-2 text-muted-foreground hover:bg-muted hover:text-foreground transition-colors","aria-label":"Expand sidebar",children:t.jsx(Ge,{className:"size-4"})})]})]})})}const $r=[{id:"activity",label:"Activity",icon:Qe},{id:"projects",label:"Projects",icon:ue},{id:"timeline",label:"Timeline",icon:Je},{id:"people",label:"People",icon:Ye},{id:"search",label:"Search",icon:we}];function Kr({items:e=$r,activeItem:r="activity",onItemClick:n,className:o}){return t.jsx("nav",{"data-testid":"mobile-nav",className:L("fixed inset-x-0 bottom-0 z-50 h-16 items-center justify-around border-t border-border bg-surface","flex md:!hidden",o),style:{display:"var(--mobile-nav-display, flex)"},role:"navigation","aria-label":"Mobile navigation",children:e.map(a=>{const i=a.icon,l=r===a.id;return t.jsxs("button",{type:"button",onClick:()=>{a.onClick?.(),n?.(a)},className:L("flex flex-col items-center justify-center gap-1 px-3 py-2 text-muted-foreground transition-colors hover:text-foreground",l&&"text-primary"),"aria-current":l?"page":void 0,children:[t.jsx(i,{className:"size-5"}),t.jsx("span",{className:"text-[10px] font-medium",children:a.label})]},a.id)})})}function zr({items:e,showHome:r=!0,onHomeClick:n,className:o}){return t.jsx("nav",{"data-testid":"breadcrumb","aria-label":"Breadcrumb",className:L("flex items-center gap-1 text-sm",o),children:t.jsxs("ol",{className:"flex items-center gap-1",children:[r&&t.jsxs("li",{className:"flex items-center",children:[t.jsx("button",{type:"button",onClick:n,className:"flex items-center text-muted-foreground hover:text-foreground transition-colors","aria-label":"Home",children:t.jsx(pr,{className:"size-4"})}),e.length>0&&t.jsx(Ge,{className:"mx-1 size-4 text-muted-foreground","aria-hidden":"true"})]}),e.map((a,i)=>{const l=i===e.length-1;return t.jsx("li",{className:"flex items-center",children:l?t.jsx("span",{className:"font-medium text-foreground","aria-current":"page",children:a.label}):t.jsxs(t.Fragment,{children:[t.jsx("button",{type:"button",onClick:a.onClick,className:"text-muted-foreground hover:text-foreground transition-colors",children:a.label}),t.jsx(Ge,{className:"mx-1 size-4 text-muted-foreground","aria-hidden":"true"})]})},i)})]})})}const Fr=[{title:"Global",shortcuts:[{keys:["⌘","K"],description:"Open command palette"},{keys:["⌘","/"],description:"Show keyboard shortcuts"},{keys:["Esc"],description:"Close modal / cancel"}]},{title:"Navigation",shortcuts:[{keys:["G","A"],description:"Go to Activity"},{keys:["G","P"],description:"Go to Projects"},{keys:["G","T"],description:"Go to Timeline"},{keys:["G","C"],description:"Go to Contacts"},{keys:["G","S"],description:"Go to Settings"}]},{title:"Lists",shortcuts:[{keys:["J"],description:"Move down"},{keys:["K"],description:"Move up"},{keys:["Enter"],description:"Open selected item"},{keys:["⌫"],description:"Go back / up hierarchy"}]},{title:"Actions",shortcuts:[{keys:["N"],description:"New item"},{keys:["E"],description:"Edit current item"},{keys:["S"],description:"Change status"},{keys:["Space"],description:"Toggle selection"}]}];function De({children:e}){return t.jsx("kbd",{className:"inline-flex h-5 min-w-5 items-center justify-center rounded border border-border bg-muted px-1.5 font-mono text-xs font-medium text-muted-foreground",children:e})}function Hr(){const[e,r]=s.useState(!1),n=s.useCallback(o=>{const a=o.target;a.tagName==="INPUT"||a.tagName==="TEXTAREA"||a.isContentEditable||((o.metaKey||o.ctrlKey)&&o.key==="/"&&(o.preventDefault(),r(i=>!i)),o.key==="?"&&!o.metaKey&&!o.ctrlKey&&!o.altKey&&(o.preventDefault(),r(!0)))},[]);return s.useEffect(()=>(document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)),[n]),t.jsx(Ce,{open:e,onOpenChange:r,children:t.jsxs(Ne,{className:"sm:max-w-lg",children:[t.jsxs(Se,{children:[t.jsx(Ee,{children:"Keyboard Shortcuts"}),t.jsxs(Te,{children:["Navigate and act faster with these shortcuts. Press"," ",t.jsx(De,{children:"⌘"})," ",t.jsx(De,{children:"/"})," to toggle this help."]})]}),t.jsx(ht,{className:"max-h-[60vh]",children:t.jsx("div",{className:"space-y-6 pr-4",children:Fr.map((o,a)=>t.jsxs("div",{children:[a>0&&t.jsx(ar,{className:"mb-4"}),t.jsx("h3",{className:"mb-3 text-sm font-medium text-foreground",children:o.title}),t.jsx("div",{className:"space-y-2",children:o.shortcuts.map(i=>t.jsxs("div",{className:"flex items-center justify-between py-1",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:i.description}),t.jsx("div",{className:"flex items-center gap-1",children:i.keys.map((l,d)=>t.jsxs(s.Fragment,{children:[t.jsx(De,{children:l}),d<i.keys.length-1&&t.jsx("span",{className:"text-xs text-muted-foreground",children:"+"})]},d))})]},i.description))})]},o.title))})}),t.jsx("div",{className:"text-center text-xs text-muted-foreground",children:t.jsx("span",{className:"opacity-75",children:"Shortcuts are disabled when typing in text fields"})})]})})}const rt="sidebar-collapsed";function Gr({children:e,activeSection:r="activity",onSectionChange:n,onCreateClick:o,breadcrumbs:a=[],onBreadcrumbClick:i,onHomeClick:l,header:d,className:c}){const[u,p]=s.useState(()=>typeof window>"u"?!1:localStorage.getItem(rt)==="true"),f=s.useCallback(x=>{p(x),localStorage.setItem(rt,String(x))},[]),v=s.useCallback(x=>{n?.(x.id)},[n]);return s.useEffect(()=>{const x=y=>{(y.metaKey||y.ctrlKey)&&y.key==="k"&&(y.preventDefault(),n?.("search"))};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[n]),t.jsxs("div",{"data-testid":"app-shell",className:L("flex h-screen bg-background",c),children:[t.jsx("div",{className:"hidden md:block",children:t.jsx(Or,{activeItem:r,onItemClick:v,onCreateClick:o,collapsed:u,onCollapsedChange:f})}),t.jsxs("main",{className:"flex flex-1 flex-col overflow-hidden",children:[t.jsxs("header",{className:"sticky top-0 z-10 flex h-14 shrink-0 items-center gap-4 border-b border-border bg-surface px-4",children:[a.length>0&&t.jsx(zr,{items:a,onHomeClick:l}),d&&t.jsx("div",{className:"ml-auto flex items-center gap-2",children:d})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-4 pb-20 md:p-6 md:pb-0",children:e})]}),t.jsx(Kr,{activeItem:r,onItemClick:v}),t.jsx(Hr,{})]})}var nt=1,Wr=.9,qr=.8,Br=.17,Ae=.1,_e=.999,Vr=.9999,Ur=.99,Qr=/[\\\/_+.#"@\[\(\{&]/,Jr=/[\\\/_+.#"@\[\(\{&]/g,Yr=/[\s-]/,Tt=/[\s-]/g;function Ve(e,r,n,o,a,i,l){if(i===r.length)return a===e.length?nt:Ur;var d=`${a},${i}`;if(l[d]!==void 0)return l[d];for(var c=o.charAt(i),u=n.indexOf(c,a),p=0,f,v,x,y;u>=0;)f=Ve(e,r,n,o,u+1,i+1,l),f>p&&(u===a?f*=nt:Qr.test(e.charAt(u-1))?(f*=qr,x=e.slice(a,u-1).match(Jr),x&&a>0&&(f*=Math.pow(_e,x.length))):Yr.test(e.charAt(u-1))?(f*=Wr,y=e.slice(a,u-1).match(Tt),y&&a>0&&(f*=Math.pow(_e,y.length))):(f*=Br,a>0&&(f*=Math.pow(_e,u-a))),e.charAt(u)!==r.charAt(i)&&(f*=Vr)),(f<Ae&&n.charAt(u-1)===o.charAt(i+1)||o.charAt(i+1)===o.charAt(i)&&n.charAt(u-1)!==o.charAt(i))&&(v=Ve(e,r,n,o,u+1,i+2,l),v*Ae>f&&(f=v*Ae)),f>p&&(p=f),u=n.indexOf(c,u+1);return l[d]=p,p}function st(e){return e.toLowerCase().replace(Tt," ")}function Xr(e,r,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,Ve(e,r,st(e),st(r),0,0,{})}var oe='[cmdk-group=""]',Le='[cmdk-group-items=""]',Zr='[cmdk-group-heading=""]',It='[cmdk-item=""]',at=`${It}:not([aria-disabled="true"])`,Ue="cmdk-item-select",te="data-value",en=(e,r,n)=>Xr(e,r,n),Pt=s.createContext(void 0),pe=()=>s.useContext(Pt),Rt=s.createContext(void 0),et=()=>s.useContext(Rt),Dt=s.createContext(void 0),At=s.forwardRef((e,r)=>{let n=re(()=>{var m,j;return{search:"",value:(j=(m=e.value)!=null?m:e.defaultValue)!=null?j:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),o=re(()=>new Set),a=re(()=>new Map),i=re(()=>new Map),l=re(()=>new Set),d=_t(e),{label:c,children:u,value:p,onValueChange:f,filter:v,shouldFilter:x,loop:y,disablePointerSelection:E=!1,vimBindings:g=!0,...w}=e,C=Q(),R=Q(),T=Q(),S=s.useRef(null),N=mn();J(()=>{if(p!==void 0){let m=p.trim();n.current.value=m,h.emit()}},[p]),J(()=>{N(6,B)},[]);let h=s.useMemo(()=>({subscribe:m=>(l.current.add(m),()=>l.current.delete(m)),snapshot:()=>n.current,setState:(m,j,I)=>{var b,P,A,K;if(!Object.is(n.current[m],j)){if(n.current[m]=j,m==="search")X(),F(),N(1,se);else if(m==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let M=document.getElementById(T);M?M.focus():(b=document.getElementById(C))==null||b.focus()}if(N(7,()=>{var M;n.current.selectedItemId=(M=H())==null?void 0:M.id,h.emit()}),I||N(5,B),((P=d.current)==null?void 0:P.value)!==void 0){let M=j??"";(K=(A=d.current).onValueChange)==null||K.call(A,M);return}}h.emit()}},emit:()=>{l.current.forEach(m=>m())}}),[]),_=s.useMemo(()=>({value:(m,j,I)=>{var b;j!==((b=i.current.get(m))==null?void 0:b.value)&&(i.current.set(m,{value:j,keywords:I}),n.current.filtered.items.set(m,$(j,I)),N(2,()=>{F(),h.emit()}))},item:(m,j)=>(o.current.add(m),j&&(a.current.has(j)?a.current.get(j).add(m):a.current.set(j,new Set([m]))),N(3,()=>{X(),F(),n.current.value||se(),h.emit()}),()=>{i.current.delete(m),o.current.delete(m),n.current.filtered.items.delete(m);let I=H();N(4,()=>{X(),I?.getAttribute("id")===m&&se(),h.emit()})}),group:m=>(a.current.has(m)||a.current.set(m,new Set),()=>{i.current.delete(m),a.current.delete(m)}),filter:()=>d.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>d.current.disablePointerSelection,listId:C,inputId:T,labelId:R,listInnerRef:S}),[]);function $(m,j){var I,b;let P=(b=(I=d.current)==null?void 0:I.filter)!=null?b:en;return m?P(m,n.current.search,j):0}function F(){if(!n.current.search||d.current.shouldFilter===!1)return;let m=n.current.filtered.items,j=[];n.current.filtered.groups.forEach(b=>{let P=a.current.get(b),A=0;P.forEach(K=>{let M=m.get(K);A=Math.max(M,A)}),j.push([b,A])});let I=S.current;V().sort((b,P)=>{var A,K;let M=b.getAttribute("id"),xe=P.getAttribute("id");return((A=m.get(xe))!=null?A:0)-((K=m.get(M))!=null?K:0)}).forEach(b=>{let P=b.closest(Le);P?P.appendChild(b.parentElement===P?b:b.closest(`${Le} > *`)):I.appendChild(b.parentElement===I?b:b.closest(`${Le} > *`))}),j.sort((b,P)=>P[1]-b[1]).forEach(b=>{var P;let A=(P=S.current)==null?void 0:P.querySelector(`${oe}[${te}="${encodeURIComponent(b[0])}"]`);A?.parentElement.appendChild(A)})}function se(){let m=V().find(I=>I.getAttribute("aria-disabled")!=="true"),j=m?.getAttribute(te);h.setState("value",j||void 0)}function X(){var m,j,I,b;if(!n.current.search||d.current.shouldFilter===!1){n.current.filtered.count=o.current.size;return}n.current.filtered.groups=new Set;let P=0;for(let A of o.current){let K=(j=(m=i.current.get(A))==null?void 0:m.value)!=null?j:"",M=(b=(I=i.current.get(A))==null?void 0:I.keywords)!=null?b:[],xe=$(K,M);n.current.filtered.items.set(A,xe),xe>0&&P++}for(let[A,K]of a.current)for(let M of K)if(n.current.filtered.items.get(M)>0){n.current.filtered.groups.add(A);break}n.current.filtered.count=P}function B(){var m,j,I;let b=H();b&&(((m=b.parentElement)==null?void 0:m.firstChild)===b&&((I=(j=b.closest(oe))==null?void 0:j.querySelector(Zr))==null||I.scrollIntoView({block:"nearest"})),b.scrollIntoView({block:"nearest"}))}function H(){var m;return(m=S.current)==null?void 0:m.querySelector(`${It}[aria-selected="true"]`)}function V(){var m;return Array.from(((m=S.current)==null?void 0:m.querySelectorAll(at))||[])}function ae(m){let j=V()[m];j&&h.setState("value",j.getAttribute(te))}function k(m){var j;let I=H(),b=V(),P=b.findIndex(K=>K===I),A=b[P+m];(j=d.current)!=null&&j.loop&&(A=P+m<0?b[b.length-1]:P+m===b.length?b[0]:b[P+m]),A&&h.setState("value",A.getAttribute(te))}function D(m){let j=H(),I=j?.closest(oe),b;for(;I&&!b;)I=m>0?dn(I,oe):un(I,oe),b=I?.querySelector(at);b?h.setState("value",b.getAttribute(te)):k(m)}let O=()=>ae(V().length-1),U=m=>{m.preventDefault(),m.metaKey?O():m.altKey?D(1):k(1)},he=m=>{m.preventDefault(),m.metaKey?ae(0):m.altKey?D(-1):k(-1)};return s.createElement(W.div,{ref:r,tabIndex:-1,...w,"cmdk-root":"",onKeyDown:m=>{var j;(j=w.onKeyDown)==null||j.call(w,m);let I=m.nativeEvent.isComposing||m.keyCode===229;if(!(m.defaultPrevented||I))switch(m.key){case"n":case"j":{g&&m.ctrlKey&&U(m);break}case"ArrowDown":{U(m);break}case"p":case"k":{g&&m.ctrlKey&&he(m);break}case"ArrowUp":{he(m);break}case"Home":{m.preventDefault(),ae(0);break}case"End":{m.preventDefault(),O();break}case"Enter":{m.preventDefault();let b=H();if(b){let P=new Event(Ue);b.dispatchEvent(P)}}}}},s.createElement("label",{"cmdk-label":"",htmlFor:_.inputId,id:_.labelId,style:pn},c),Re(e,m=>s.createElement(Rt.Provider,{value:h},s.createElement(Pt.Provider,{value:_},m))))}),tn=s.forwardRef((e,r)=>{var n,o;let a=Q(),i=s.useRef(null),l=s.useContext(Dt),d=pe(),c=_t(e),u=(o=(n=c.current)==null?void 0:n.forceMount)!=null?o:l?.forceMount;J(()=>{if(!u)return d.item(a,l?.id)},[u]);let p=Lt(a,i,[e.value,e.children,i],e.keywords),f=et(),v=q(N=>N.value&&N.value===p.current),x=q(N=>u||d.filter()===!1?!0:N.search?N.filtered.items.get(a)>0:!0);s.useEffect(()=>{let N=i.current;if(!(!N||e.disabled))return N.addEventListener(Ue,y),()=>N.removeEventListener(Ue,y)},[x,e.onSelect,e.disabled]);function y(){var N,h;E(),(h=(N=c.current).onSelect)==null||h.call(N,p.current)}function E(){f.setState("value",p.current,!0)}if(!x)return null;let{disabled:g,value:w,onSelect:C,forceMount:R,keywords:T,...S}=e;return s.createElement(W.div,{ref:de(i,r),...S,id:a,"cmdk-item":"",role:"option","aria-disabled":!!g,"aria-selected":!!v,"data-disabled":!!g,"data-selected":!!v,onPointerMove:g||d.getDisablePointerSelection()?void 0:E,onClick:g?void 0:y},e.children)}),rn=s.forwardRef((e,r)=>{let{heading:n,children:o,forceMount:a,...i}=e,l=Q(),d=s.useRef(null),c=s.useRef(null),u=Q(),p=pe(),f=q(x=>a||p.filter()===!1?!0:x.search?x.filtered.groups.has(l):!0);J(()=>p.group(l),[]),Lt(l,d,[e.value,e.heading,c]);let v=s.useMemo(()=>({id:l,forceMount:a}),[a]);return s.createElement(W.div,{ref:de(d,r),...i,"cmdk-group":"",role:"presentation",hidden:f?void 0:!0},n&&s.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:u},n),Re(e,x=>s.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?u:void 0},s.createElement(Dt.Provider,{value:v},x))))}),nn=s.forwardRef((e,r)=>{let{alwaysRender:n,...o}=e,a=s.useRef(null),i=q(l=>!l.search);return!n&&!i?null:s.createElement(W.div,{ref:de(a,r),...o,"cmdk-separator":"",role:"separator"})}),sn=s.forwardRef((e,r)=>{let{onValueChange:n,...o}=e,a=e.value!=null,i=et(),l=q(u=>u.search),d=q(u=>u.selectedItemId),c=pe();return s.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),s.createElement(W.input,{ref:r,...o,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":d,id:c.inputId,type:"text",value:a?e.value:l,onChange:u=>{a||i.setState("search",u.target.value),n?.(u.target.value)}})}),an=s.forwardRef((e,r)=>{let{children:n,label:o="Suggestions",...a}=e,i=s.useRef(null),l=s.useRef(null),d=q(u=>u.selectedItemId),c=pe();return s.useEffect(()=>{if(l.current&&i.current){let u=l.current,p=i.current,f,v=new ResizeObserver(()=>{f=requestAnimationFrame(()=>{let x=u.offsetHeight;p.style.setProperty("--cmdk-list-height",x.toFixed(1)+"px")})});return v.observe(u),()=>{cancelAnimationFrame(f),v.unobserve(u)}}},[]),s.createElement(W.div,{ref:de(i,r),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":d,"aria-label":o,id:c.listId},Re(e,u=>s.createElement("div",{ref:de(l,c.listInnerRef),"cmdk-list-sizer":""},u)))}),on=s.forwardRef((e,r)=>{let{open:n,onOpenChange:o,overlayClassName:a,contentClassName:i,container:l,...d}=e;return s.createElement(tr,{open:n,onOpenChange:o},s.createElement(rr,{container:l},s.createElement(nr,{"cmdk-overlay":"",className:a}),s.createElement(sr,{"aria-label":e.label,"cmdk-dialog":"",className:i},s.createElement(At,{ref:r,...d}))))}),ln=s.forwardRef((e,r)=>q(n=>n.filtered.count===0)?s.createElement(W.div,{ref:r,...e,"cmdk-empty":"",role:"presentation"}):null),cn=s.forwardRef((e,r)=>{let{progress:n,children:o,label:a="Loading...",...i}=e;return s.createElement(W.div,{ref:r,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},Re(e,l=>s.createElement("div",{"aria-hidden":!0},l)))}),Y=Object.assign(At,{List:an,Item:tn,Input:sn,Group:rn,Separator:nn,Dialog:on,Empty:ln,Loading:cn});function dn(e,r){let n=e.nextElementSibling;for(;n;){if(n.matches(r))return n;n=n.nextElementSibling}}function un(e,r){let n=e.previousElementSibling;for(;n;){if(n.matches(r))return n;n=n.previousElementSibling}}function _t(e){let r=s.useRef(e);return J(()=>{r.current=e}),r}var J=typeof window>"u"?s.useEffect:s.useLayoutEffect;function re(e){let r=s.useRef();return r.current===void 0&&(r.current=e()),r}function q(e){let r=et(),n=()=>e(r.snapshot());return s.useSyncExternalStore(r.subscribe,n,n)}function Lt(e,r,n,o=[]){let a=s.useRef(),i=pe();return J(()=>{var l;let d=(()=>{var u;for(let p of n){if(typeof p=="string")return p.trim();if(typeof p=="object"&&"current"in p)return p.current?(u=p.current.textContent)==null?void 0:u.trim():a.current}})(),c=o.map(u=>u.trim());i.value(e,d,c),(l=r.current)==null||l.setAttribute(te,d),a.current=d}),a}var mn=()=>{let[e,r]=s.useState(),n=re(()=>new Map);return J(()=>{n.current.forEach(o=>o()),n.current=new Map},[e]),(o,a)=>{n.current.set(o,a),r({})}};function fn(e){let r=e.type;return typeof r=="function"?r(e.props):"render"in r?r.render(e.props):e}function Re({asChild:e,children:r},n){return e&&s.isValidElement(r)?s.cloneElement(fn(r),{ref:r.ref},n(r.props.children)):n(r)}var pn={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function hn({className:e,...r}){return t.jsx(Y,{"data-slot":"command",className:L("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...r})}function xn({title:e="Command Palette",description:r="Search for a command to run...",children:n,className:o,showCloseButton:a=!0,...i}){return t.jsxs(Ce,{...i,children:[t.jsxs(Se,{className:"sr-only",children:[t.jsx(Ee,{children:e}),t.jsx(Te,{children:r})]}),t.jsx(Ne,{className:L("overflow-hidden p-0",o),showCloseButton:a,children:t.jsx(hn,{className:"[&_[cmdk-group-heading]]:text-muted-foreground **:data-[slot=command-input-wrapper]:h-12 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group]]:px-2 [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:n})})]})}function gn({className:e,...r}){return t.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[t.jsx(we,{className:"size-4 shrink-0 opacity-50"}),t.jsx(Y.Input,{"data-slot":"command-input",className:L("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...r})]})}function vn({className:e,...r}){return t.jsx(Y.List,{"data-slot":"command-list",className:L("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...r})}function bn({...e}){return t.jsx(Y.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function ie({className:e,...r}){return t.jsx(Y.Group,{"data-slot":"command-group",className:L("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...r})}function Me({className:e,...r}){return t.jsx(Y.Separator,{"data-slot":"command-separator",className:L("bg-border -mx-1 h-px",e),...r})}function G({className:e,...r}){return t.jsx(Y.Item,{"data-slot":"command-item",className:L("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function ot({className:e,...r}){return t.jsx("span",{"data-slot":"command-shortcut",className:L("text-muted-foreground ml-auto text-xs tracking-widest",e),...r})}const it="command-palette-recent",yn=5;function lt(e){switch(e){case"project":return t.jsx(ue,{className:"size-4"});case"issue":return t.jsx(He,{className:"size-4"});case"contact":return t.jsx(ir,{className:"size-4"});case"epic":return t.jsx(mr,{className:"size-4"});case"initiative":return t.jsx(ue,{className:"size-4"});default:return t.jsx(He,{className:"size-4"})}}function jn({open:e,onOpenChange:r,onSearch:n,onSelect:o,onNavigate:a,recentItems:i}){const[l,d]=s.useState(e??!1),[c,u]=s.useState(""),[p,f]=s.useState([]),[v,x]=s.useState(!1),[y,E]=s.useState(()=>{if(i)return i;if(typeof window>"u")return[];try{const h=localStorage.getItem(it);return h?JSON.parse(h):[]}catch{return[]}});s.useEffect(()=>{e!==void 0&&d(e)},[e]),s.useEffect(()=>{const h=_=>{(_.metaKey||_.ctrlKey)&&_.key==="k"&&(_.preventDefault(),d($=>!$))};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[]),s.useEffect(()=>{if(!c.trim()||!n){f([]);return}const h=setTimeout(async()=>{x(!0);try{const _=await n(c);f(_)}catch(_){console.error("Search failed:",_),f([])}finally{x(!1)}},200);return()=>clearTimeout(h)},[c,n]);const g=s.useCallback(h=>{d(h),r?.(h),h||(u(""),f([]))},[r]),w=s.useCallback(h=>{const _=[{id:h.id,type:h.type,title:h.title,timestamp:new Date},...y.filter($=>$.id!==h.id)].slice(0,yn);E(_),typeof window<"u"&&localStorage.setItem(it,JSON.stringify(_)),o?.(h),g(!1)},[y,o,g]),C=s.useCallback(h=>{a?.(h),g(!1)},[a,g]),R=s.useCallback(h=>{o?.(h),g(!1)},[o,g]),{filteredQuery:T,typeFilter:S}=s.useMemo(()=>{const h=c.match(/^(@|#|!)(\S*)\s*(.*)/);if(h){const[,_,,$]=h;let F;return _==="@"?F="contact":_==="#"?F="project":_==="!"&&(F="issue"),{filteredQuery:$||"",typeFilter:F}}return{filteredQuery:c,typeFilter:void 0}},[c]),N=S?p.filter(h=>h.type===S):p;return t.jsxs(xn,{open:l,onOpenChange:g,title:"Command Palette",description:"Search for commands, projects, issues, or contacts",children:[t.jsx(gn,{placeholder:"Type a command or search...",value:c,onValueChange:u}),t.jsxs(vn,{children:[t.jsx(bn,{children:v?"Searching...":"No results found."}),N.length>0&&t.jsx(ie,{heading:S?`${S}s`:"Search Results",children:N.map(h=>t.jsxs(G,{value:`${h.type}-${h.id}-${h.title}`,onSelect:()=>w(h),children:[lt(h.type),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{children:h.title}),h.subtitle&&t.jsx("span",{className:"text-xs text-muted-foreground",children:h.subtitle})]})]},`${h.type}-${h.id}`))}),!c&&y.length>0&&t.jsxs(t.Fragment,{children:[t.jsx(ie,{heading:"Recent",children:y.map(h=>t.jsxs(G,{value:`recent-${h.type}-${h.id}-${h.title}`,onSelect:()=>w(h),children:[t.jsx(or,{className:"size-4 text-muted-foreground"}),lt(h.type),t.jsx("span",{children:h.title})]},`recent-${h.type}-${h.id}`))}),t.jsx(Me,{})]}),!c&&t.jsxs(ie,{heading:"Actions",children:[t.jsxs(G,{onSelect:()=>R("create-issue"),children:[t.jsx(ke,{className:"size-4"}),t.jsx("span",{children:"Create new issue"}),t.jsx(ot,{children:"⌘I"})]}),t.jsxs(G,{onSelect:()=>R("create-project"),children:[t.jsx(ke,{className:"size-4"}),t.jsx("span",{children:"Create new project"}),t.jsx(ot,{children:"⌘P"})]})]}),!c&&t.jsxs(t.Fragment,{children:[t.jsx(Me,{}),t.jsxs(ie,{heading:"Navigate",children:[t.jsxs(G,{onSelect:()=>C("activity"),children:[t.jsx(Qe,{className:"size-4"}),t.jsx("span",{children:"Activity"})]}),t.jsxs(G,{onSelect:()=>C("projects"),children:[t.jsx(ue,{className:"size-4"}),t.jsx("span",{children:"Projects"})]}),t.jsxs(G,{onSelect:()=>C("timeline"),children:[t.jsx(Je,{className:"size-4"}),t.jsx("span",{children:"Timeline"})]}),t.jsxs(G,{onSelect:()=>C("people"),children:[t.jsx(Ye,{className:"size-4"}),t.jsx("span",{children:"People"})]})]})]}),!c&&t.jsxs(t.Fragment,{children:[t.jsx(Me,{}),t.jsx(ie,{heading:"Search Tips",children:t.jsx(G,{disabled:!0,children:t.jsxs("span",{className:"text-muted-foreground",children:[t.jsx("kbd",{className:"rounded border bg-muted px-1 text-xs",children:"@"})," contacts",t.jsx("kbd",{className:"ml-2 rounded border bg-muted px-1 text-xs",children:"#"})," projects",t.jsx("kbd",{className:"ml-2 rounded border bg-muted px-1 text-xs",children:"!"})," issues"]})})})]})]})]})}const kn=s.createContext(null);function Mt(){const e=s.useContext(kn);return e||{isEnabled:!0,setEnabled:()=>{}}}function Ot(e){if(!e||!(e instanceof HTMLElement))return!1;const r=e.tagName.toLowerCase();return r==="input"||r==="textarea"||r==="select"||e.isContentEditable}function wn(e){const r=e.toLowerCase().split("+");return{key:r[r.length-1],ctrl:r.includes("ctrl"),meta:r.includes("meta")||r.includes("cmd"),alt:r.includes("alt"),shift:r.includes("shift")}}function ct(e){const r={escape:"escape",esc:"escape",enter:"enter",return:"enter",space:" ",backspace:"backspace",delete:"delete",arrowup:"arrowup",arrowdown:"arrowdown",arrowleft:"arrowleft",arrowright:"arrowright"},n=e.toLowerCase();return r[n]||n}function Cn(e,r){const n=ct(e.key),o=ct(r.key),a=n===o,i=r.ctrl===e.ctrlKey,l=r.meta===e.metaKey,d=r.alt===e.altKey,c=!r.shift||r.shift===e.shiftKey;return a&&i&&l&&d&&c}function z(e,r,n={}){const{isEnabled:o}=Mt(),{enabled:a=!0}=n,i=s.useRef(r);i.current=r;const l=wn(e),d=s.useCallback(c=>{!a||!o||Ot(c.target)||Cn(c,l)&&(c.preventDefault(),i.current(c))},[a,o,l.key,l.ctrl,l.meta,l.alt,l.shift]);s.useEffect(()=>(document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)),[d])}function le(e,r,n={}){const{isEnabled:o}=Mt(),{timeout:a=1e3,enabled:i=!0}=n,l=s.useRef(r);l.current=r;const d=s.useRef([]),c=s.useRef(null),u=s.useCallback(()=>{d.current=[],c.current&&(clearTimeout(c.current),c.current=null)},[]),p=s.useCallback(f=>{if(!i||!o||Ot(f.target))return;const v=f.key.toLowerCase();c.current&&clearTimeout(c.current),d.current.push(v);const x=d.current,y=e.map(g=>g.toLowerCase());let E=!0;for(let g=0;g<x.length;g++)if(x[g]!==y[g]){E=!1;break}if(E&&x.length===y.length){f.preventDefault(),u(),l.current(f);return}if(!E)if(v===y[0])d.current=[v];else{u();return}c.current=setTimeout(u,a)},[i,o,e,a,u]);s.useEffect(()=>(document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p),u()}),[p,u])}function Nn({onNavigate:e,onSearch:r,onNewItem:n,onNewItemFullForm:o,onEdit:a,onDelete:i,onChangeStatus:l,onMoveUp:d,onMoveDown:c,onSelect:u,onBack:p,onOpenSelected:f}){const v=s.useCallback(()=>e?.("activity"),[e]),x=s.useCallback(()=>e?.("projects"),[e]),y=s.useCallback(()=>e?.("timeline"),[e]),E=s.useCallback(()=>e?.("people"),[e]),g=s.useCallback(()=>e?.("settings"),[e]);return le(["g","a"],v),le(["g","p"],x),le(["g","t"],y),le(["g","c"],E),le(["g","s"],g),z("meta+k",()=>r?.()),z("ctrl+k",()=>r?.()),z("j",()=>c?.()),z("k",()=>d?.()),z("enter",()=>f?.()),z("backspace",()=>p?.()),z("n",()=>n?.()),z("shift+n",()=>o?.()),z("e",()=>a?.()),z("d",()=>i?.()),z("s",()=>l?.()),z(" ",()=>u?.()),null}const Sn={project:"Project",initiative:"Initiative",epic:"Epic",issue:"Issue"};function En({open:e,onOpenChange:r,onCreated:n,defaultParentId:o,defaultKind:a="issue"}){const[i,l]=s.useState(""),[d,c]=s.useState(a),[u,p]=s.useState(!1),[f,v]=s.useState(null),x=s.useCallback(()=>{l(""),c(a),v(null)},[a]),y=s.useCallback(async()=>{if(u)return;p(!0),v(null);const w={title:i.trim(),kind:d,parentId:o??null};try{const C=await fetch("/api/work-items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)});if(!C.ok){const S=(await C.json().catch(()=>({}))).error??`Failed to create work item (${C.status})`;v(S),p(!1);return}const R=await C.json();n?.(R),x(),r(!1)}catch(C){v(C instanceof Error?C.message:"Network error")}finally{p(!1)}},[i,d,o,u,n,r,x]),E=s.useCallback(w=>{w.key==="Enter"&&!w.shiftKey&&(w.preventDefault(),y()),w.key==="Escape"&&r(!1)},[y,r]),g=s.useCallback(w=>{w||x(),r(w)},[r,x]);return t.jsx(Ce,{open:e,onOpenChange:g,children:t.jsxs(Ne,{className:"sm:max-w-md",children:[t.jsxs(Se,{children:[t.jsxs(Ee,{className:"flex items-center gap-2",children:[t.jsx(ke,{className:"size-5"}),"Quick Add"]}),t.jsx(Te,{children:"Create a new work item quickly."})]}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs($e,{value:d,onValueChange:w=>c(w),children:[t.jsx(Ke,{className:"w-[140px]","aria-label":"Kind",children:t.jsx(ze,{placeholder:"Kind"})}),t.jsx(Fe,{children:Object.entries(Sn).map(([w,C])=>t.jsx(ye,{value:w,children:C},w))})]}),t.jsx(We,{placeholder:"Title...",value:i,onChange:w=>l(w.target.value),onKeyDown:E,className:"flex-1",autoFocus:!0})]}),f&&t.jsx("p",{className:"text-sm text-destructive",role:"alert",children:f})]}),t.jsxs(xt,{children:[t.jsx(je,{variant:"outline",onClick:()=>g(!1),disabled:u,children:"Cancel"}),t.jsx(je,{onClick:y,disabled:u,children:u?t.jsxs(t.Fragment,{children:[t.jsx(gt,{className:"mr-2 size-4 animate-spin"}),"Creating..."]}):"Create"})]})]})})}var Tn="Label",$t=s.forwardRef((e,r)=>t.jsx(W.label,{...e,ref:r,onMouseDown:n=>{n.target.closest("button, input, select, textarea")||(e.onMouseDown?.(n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));$t.displayName=Tn;var In=$t;function ce({className:e,...r}){return t.jsx(In,{"data-slot":"label",className:L("flex items-center gap-2 text-sm font-medium leading-none select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...r})}const ee={project:"Project",initiative:"Initiative",epic:"Epic",issue:"Issue"},Pn={project:"Top-level container for initiatives",initiative:"Strategic goal or theme (belongs to a project)",epic:"Large body of work (belongs to an initiative)",issue:"Specific task or bug (belongs to an epic)"},Oe={project:null,initiative:"project",epic:"initiative",issue:"epic"};function Kt(e,r=0){const n=[];for(const o of e)n.push({id:o.id,title:o.title,kind:o.kind,depth:r}),o.children?.length>0&&n.push(...Kt(o.children,r+1));return n}function Rn({open:e,onOpenChange:r,onCreated:n,defaultParentId:o,defaultKind:a="issue"}){const[i,l]=s.useState(""),[d,c]=s.useState(a),[u,p]=s.useState(""),[f,v]=s.useState(o),[x,y]=s.useState(""),[E,g]=s.useState(!1),[w,C]=s.useState(null),[R,T]=s.useState({}),[S,N]=s.useState([]),[h,_]=s.useState(!1);s.useEffect(()=>{if(!e)return;async function k(){_(!0);try{const D=await fetch("/api/work-items/tree",{headers:{accept:"application/json"}});if(D.ok){const O=await D.json();N(Kt(O.items))}}catch{}finally{_(!1)}}k()},[e]);const $=s.useCallback(()=>{l(""),c(a),p(""),v(o),y(""),C(null),T({})},[a,o]),F=s.useCallback(()=>{const k={};i.trim()||(k.title="Title is required");const D=Oe[d];if(D&&!f&&d!=="issue"&&(k.parent=`${ee[d]} requires a parent ${ee[D]}`),f&&D){const O=S.find(U=>U.id===f);O&&O.kind!==D&&(k.parent=`${ee[d]} parent must be a ${ee[D]}`)}if(x){const O=parseInt(x,10);(isNaN(O)||O<0||O>525600)&&(k.estimate="Estimate must be between 0 and 525600 minutes")}return T(k),Object.keys(k).length===0},[i,d,f,S,x]),se=s.useCallback(async()=>{if(E||!F())return;g(!0),C(null);const k={title:i.trim(),kind:d,description:u.trim()||void 0,parentId:f??null,estimateMinutes:x?parseInt(x,10):null};try{const D=await fetch("/api/work-items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)});if(!D.ok){const he=(await D.json().catch(()=>({}))).error??`Failed to create work item (${D.status})`;C(he),g(!1);return}const O=await D.json();n?.(O),$(),r(!1)}catch(D){C(D instanceof Error?D.message:"Network error")}finally{g(!1)}},[i,d,u,f,x,E,F,n,r,$]),X=s.useCallback(k=>{k||$(),r(k)},[r,$]),B=Oe[d],H=B?S.filter(k=>k.kind===B):[],V=d!=="project",ae=d==="issue"||d==="epic";return t.jsx(Ce,{open:e,onOpenChange:X,children:t.jsxs(Ne,{className:"sm:max-w-lg",children:[t.jsxs(Se,{children:[t.jsxs(Ee,{className:"flex items-center gap-2",children:[t.jsx(He,{className:"size-5"}),"Create Work Item"]}),t.jsx(Te,{children:"Fill in the details to create a new work item."})]}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(ce,{htmlFor:"title",children:"Title"}),t.jsx(We,{id:"title",placeholder:"Enter title...",value:i,onChange:k=>l(k.target.value),"aria-invalid":!!R.title,autoFocus:!0}),R.title&&t.jsx("p",{className:"text-sm text-destructive",children:R.title})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(ce,{htmlFor:"kind",children:"Kind"}),t.jsxs($e,{value:d,onValueChange:k=>{if(c(k),f){const D=Oe[k];S.find(U=>U.id===f)?.kind!==D&&v(void 0)}},children:[t.jsx(Ke,{id:"kind","aria-label":"Kind",children:t.jsx(ze,{placeholder:"Select kind"})}),t.jsx(Fe,{children:Object.entries(ee).map(([k,D])=>t.jsx(ye,{value:k,children:t.jsxs("span",{className:"flex flex-col",children:[t.jsx("span",{children:D}),t.jsx("span",{className:"text-xs text-muted-foreground",children:Pn[k]})]})},k))})]})]}),V&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(ce,{htmlFor:"parent",children:"Parent"}),t.jsxs($e,{value:f??"__none__",onValueChange:k=>v(k==="__none__"?void 0:k),disabled:d==="project"||h,children:[t.jsx(Ke,{id:"parent","aria-label":"Parent",disabled:d==="project"||h,children:t.jsx(ze,{placeholder:h?"Loading...":H.length===0?`No ${B?ee[B]+"s":"parents"} available`:"Select parent..."})}),t.jsxs(Fe,{children:[t.jsx(ye,{value:"__none__",children:"None"}),H.map(k=>t.jsx(ye,{value:k.id,children:t.jsx("span",{style:{paddingLeft:`${k.depth*12}px`},children:k.title})},k.id))]})]}),R.parent&&t.jsx("p",{className:"text-sm text-destructive",children:R.parent})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(ce,{htmlFor:"description",children:"Description"}),t.jsx(lr,{id:"description",placeholder:"Enter description...",value:u,onChange:k=>p(k.target.value),rows:3})]}),ae&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(ce,{htmlFor:"estimate",children:"Estimate (minutes)"}),t.jsx(We,{id:"estimate",type:"number",placeholder:"e.g., 60",value:x,onChange:k=>y(k.target.value),min:0,max:525600,"aria-invalid":!!R.estimate}),R.estimate&&t.jsx("p",{className:"text-sm text-destructive",children:R.estimate})]}),w&&t.jsx("p",{className:"text-sm text-destructive",role:"alert",children:w})]}),t.jsxs(xt,{children:[t.jsx(je,{variant:"outline",onClick:()=>X(!1),disabled:E,children:"Cancel"}),t.jsx(je,{onClick:se,disabled:E,children:E?t.jsxs(t.Fragment,{children:[t.jsx(gt,{className:"mr-2 size-4 animate-spin"}),"Creating..."]}):"Create"})]})]})})}function Dn(e){return e.startsWith("/dashboard")?"dashboard":e.startsWith("/activity")?"activity":e.startsWith("/timeline")?"timeline":e.startsWith("/contacts")?"people":e.startsWith("/communications")?"communications":e.startsWith("/settings")?"settings":e.startsWith("/work-items")||e.startsWith("/kanban")?"projects":"dashboard"}const dt={dashboard:"/dashboard",activity:"/activity",projects:"/work-items",timeline:"/timeline",people:"/contacts",communications:"/communications",settings:"/settings"};function An(e,r){if(e.startsWith("/dashboard"))return[{id:"dashboard",label:"Dashboard"}];if(e.startsWith("/activity"))return[{id:"activity",label:"Activity"}];if(e.startsWith("/timeline"))return[{id:"timeline",label:"Timeline"}];if(e.startsWith("/contacts"))return[{id:"contacts",label:"People"}];if(e.startsWith("/communications"))return[{id:"communications",label:"Communications"}];if(e.startsWith("/settings"))return[{id:"settings",label:"Settings"}];const n=[{id:"work-items",label:"Projects",href:"/work-items"}];if(e.startsWith("/kanban"))return n.push({id:"kanban",label:"Kanban Board"}),n;const o=/^\/work-items\/([^/]+)\/timeline\/?$/.exec(e);if(o){const l=o[1];return n.push({id:"detail",label:r?.workItem?.title||l,href:`/work-items/${l}`},{id:"timeline",label:"Timeline"}),n}const a=/^\/work-items\/([^/]+)\/graph\/?$/.exec(e);if(a){const l=a[1];return n.push({id:"detail",label:r?.workItem?.title||l,href:`/work-items/${l}`},{id:"graph",label:"Dependencies"}),n}const i=/^\/work-items\/([^/]+)\/?$/.exec(e);if(i){const l=i[1];return n.push({id:"detail",label:r?.workItem?.title||l}),n}return n}function is(){const e=zt(),r=Ft(),n=dr(),[o,a]=s.useState(!1),[i,l]=s.useState(!1),[d,c]=s.useState(void 0),u=s.useMemo(()=>Dn(e.pathname),[e.pathname]),p=s.useMemo(()=>An(e.pathname,n),[e.pathname,n]),f=s.useCallback(T=>{const S=dt[T];S&&r(S)},[r]),v=s.useCallback(async T=>{try{return(await cr.get(`/api/search?q=${encodeURIComponent(T)}&limit=10`)).results.map(N=>({id:N.id,type:N.type==="work_item"?"issue":N.type==="contact"?"contact":"issue",title:N.title,subtitle:N.description?.slice(0,80)||void 0,href:N.url}))}catch{return[]}},[]),x=s.useCallback(T=>{if(typeof T=="string")(T==="create-issue"||T==="create-project")&&r("/work-items");else if(T.href){const S=T.href.startsWith("/app/")?T.href.replace("/app",""):T.href;r(S)}else r(`/work-items/${T.id}`)},[r]),y=s.useCallback(T=>{const S=dt[T];S&&r(S)},[r]),E=s.useCallback(()=>{f("search")},[f]),g=s.useMemo(()=>/^\/work-items\/([^/]+)/.exec(e.pathname)?.[1],[e.pathname]),w=s.useCallback(()=>{c(g||void 0),a(!0)},[g]),C=s.useCallback(T=>{r(`/work-items/${T.id}`)},[r]),R=s.useCallback(()=>{c(g||void 0),l(!0)},[g]);return t.jsxs(t.Fragment,{children:[t.jsx(Nn,{onNavigate:y,onSearch:E,onNewItem:w,onNewItemFullForm:R}),t.jsx(En,{open:o,onOpenChange:a,onCreated:C,defaultParentId:d}),t.jsx(Rn,{open:i,onOpenChange:l,onCreated:C,defaultParentId:d}),t.jsx(jn,{onSearch:v,onSelect:x,onNavigate:y}),t.jsx(Gr,{activeSection:u,onSectionChange:f,onCreateClick:R,breadcrumbs:p,onHomeClick:()=>r("/dashboard"),children:t.jsx(Ht,{})})]})}export{is as AppLayout};
//# sourceMappingURL=app-layout-RiV-wPAL.js.map
