import{r as y,j as e,L as k,c as Z,b as J,R as C}from"./index-BTKavlMF.js";import{b as ee,a as te}from"./use-work-items-B8WMpGIx.js";import{d as se,T as re,a as ae,b as $,G as oe,c as M}from"./tabs-CZntYfta.js";import{g as K,C as ne,b as ie,S as g}from"./card-B-p_muP1.js";import{C as B,E as le}from"./error-state-B03uaCNt.js";import{c as I,B as D}from"./button-4HlqvOJz.js";import{B as v}from"./badge-DQI7MJbM.js";import{I as de}from"./inline-editable-text-XoSdd9h8.js";import{p as L,m as ce}from"./work-item-utils-RZsWa1qH.js";import{E as T}from"./empty-state-4YFWPGw_.js";import{C as E}from"./circle-x-DRjP2nxp.js";import{C as S,a as _}from"./circle-BqKqtdYv.js";import{C as P}from"./clock-BGwPwmWQ.js";import{C as xe}from"./chevron-down-CL9L_-27.js";import{C as A}from"./chevron-right-Lgun2PAU.js";import{F as me}from"./folder-open-CVH1OSKw.js";import{F as ue}from"./folder-Bj2P8qXH.js";import{C as he}from"./chevron-left-B5wWngVX.js";import{L as pe}from"./list-CRcOQ0I1.js";import{L as ge}from"./layout-grid-DsD8s560.js";import{C as fe}from"./calendar-Bg7Wilqy.js";import"./useQuery-CvMXqy2m.js";import"./api-client-CDvRtWmo.js";import"./index-DYGATo4h.js";import"./index-D0a-lQNP.js";import"./index-LpP5_qxK.js";import"./index-B3VtdiG5.js";import"./input-Hd3OJA0G.js";import"./textarea-D3RCZ6Tj.js";import"./bell-DDXm4AVD.js";import"./mail-Dxtcdvk2.js";import"./users-CqTs1AU5.js";import"./search-CshjFlwn.js";const je=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],be=I("arrow-down",je);const Ne=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],ye=I("arrow-up",Ne);const ve=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],ke=I("chevrons-up-down",ve);const we=[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]],Ce=I("folder-kanban",we),G={open:e.jsx(_,{className:"size-3.5 text-blue-500"}),not_started:e.jsx(_,{className:"size-3.5 text-gray-400"}),in_progress:e.jsx(P,{className:"size-3.5 text-yellow-500"}),blocked:e.jsx(B,{className:"size-3.5 text-red-500"}),closed:e.jsx(S,{className:"size-3.5 text-green-500"}),done:e.jsx(S,{className:"size-3.5 text-green-500"}),cancelled:e.jsx(E,{className:"size-3.5 text-gray-400"})},De={open:"Open",not_started:"Not Started",in_progress:"In Progress",blocked:"Blocked",closed:"Done",done:"Done",cancelled:"Cancelled"},_e={project:"Project",initiative:"Initiative",epic:"Epic",issue:"Issue"},ze={project:"bg-blue-500/10 text-blue-600 dark:text-blue-400 border-blue-500/20",initiative:"bg-violet-500/10 text-violet-600 dark:text-violet-400 border-violet-500/20",epic:"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400 border-emerald-500/20",issue:"bg-gray-500/10 text-gray-600 dark:text-gray-400 border-gray-500/20"},W={P0:0,P1:1,P2:2,P3:3,P4:4};function $e({items:t,isLoading:o,projectId:s}){const[a,n]=y.useState("title"),[i,r]=y.useState("asc"),m=l=>{a===l?r(p=>p==="asc"?"desc":"asc"):(n(l),r("asc"))},h=y.useMemo(()=>{const l=[...t];return l.sort((p,N)=>{let f=0;switch(a){case"title":f=p.title.localeCompare(N.title);break;case"status":f=(p.status??"").localeCompare(N.status??"");break;case"priority":f=(W[p.priority]??99)-(W[N.priority]??99);break;case"kind":f=p.kind.localeCompare(N.kind);break}return i==="asc"?f:-f}),l},[t,a,i]);function b({field:l}){return a!==l?e.jsx(ke,{className:"size-3 text-muted-foreground/50"}):i==="asc"?e.jsx(ye,{className:"size-3 text-foreground"}):e.jsx(be,{className:"size-3 text-foreground"})}return o?e.jsx("div",{children:e.jsx(K,{rows:5,columns:5})}):t.length===0?e.jsx("div",{children:e.jsx(T,{variant:"folder",title:"No items in this project",description:"Add work items to this project to see them here."})}):e.jsx("div",{children:e.jsx(ne,{children:e.jsx(ie,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground cursor-pointer select-none hover:text-foreground transition-colors",onClick:()=>m("title"),children:e.jsxs("div",{className:"flex items-center gap-1.5",children:["Title",e.jsx(b,{field:"title"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground cursor-pointer select-none hover:text-foreground transition-colors",onClick:()=>m("status"),children:e.jsxs("div",{className:"flex items-center gap-1.5",children:["Status",e.jsx(b,{field:"status"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground cursor-pointer select-none hover:text-foreground transition-colors",onClick:()=>m("priority"),children:e.jsxs("div",{className:"flex items-center gap-1.5",children:["Priority",e.jsx(b,{field:"priority"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground cursor-pointer select-none hover:text-foreground transition-colors",onClick:()=>m("kind"),children:e.jsxs("div",{className:"flex items-center gap-1.5",children:["Type",e.jsx(b,{field:"kind"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Due Date"})]})}),e.jsx("tbody",{className:"divide-y",children:h.map(l=>e.jsxs("tr",{className:"hover:bg-muted/50 transition-colors cursor-pointer",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(k,{to:`/work-items/${encodeURIComponent(l.id)}`,className:"font-medium text-foreground hover:text-primary transition-colors",children:l.title})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[G[l.status]??G.open,e.jsx("span",{className:"text-sm",children:De[l.status]??l.status})]})}),e.jsx("td",{className:"px-4 py-3",children:l.priority&&e.jsx(v,{className:`text-xs ${L[l.priority]??"bg-gray-500"}`,children:l.priority})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(v,{variant:"outline",className:`text-xs border ${ze[l.kind]??""}`,children:_e[l.kind]??l.kind})}),e.jsx("td",{className:"px-4 py-3 text-sm text-muted-foreground",children:l.not_after?new Date(l.not_after).toLocaleDateString(void 0,{month:"short",day:"numeric"}):"--"})]},l.id))})]})})})})})}const V=[{status:"open",label:"Not Started",color:"bg-blue-400",bgGradient:"from-blue-500/5 to-blue-500/0"},{status:"in_progress",label:"In Progress",color:"bg-yellow-400",bgGradient:"from-yellow-500/5 to-yellow-500/0"},{status:"blocked",label:"Blocked",color:"bg-red-400",bgGradient:"from-red-500/5 to-red-500/0"},{status:"closed",label:"Done",color:"bg-green-400",bgGradient:"from-green-500/5 to-green-500/0"},{status:"cancelled",label:"Cancelled",color:"bg-gray-400",bgGradient:"from-gray-500/5 to-gray-500/0"}],Me={P0:"#ef4444",P1:"#f97316",P2:"#eab308",P3:"#22c55e",P4:"#6b7280"},Se={project:{label:"P",color:"bg-blue-500"},initiative:{label:"I",color:"bg-violet-500"},epic:{label:"E",color:"bg-emerald-500"},issue:{label:"T",color:"bg-gray-500"}};function Ie(t,o){return t.filter(s=>{const a=s.status;return o==="open"?a==="open"||a==="not_started":o==="closed"?a==="closed"||a==="done":a===o})}function Le({items:t,isLoading:o}){return o?e.jsx("div",{className:"flex gap-4 overflow-x-auto",children:V.map(s=>e.jsx("div",{className:"flex-1 min-w-[260px] rounded-xl bg-muted/30 animate-pulse min-h-[300px]"},s.status))}):t.length===0?e.jsx("div",{children:e.jsx(T,{variant:"folder",title:"No items to display",description:"Add work items to see them on the board."})}):e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2",children:V.map(s=>{const a=Ie(t,s.status);return e.jsxs("div",{className:"flex-1 min-w-[260px] max-w-[360px] flex flex-col rounded-xl",children:[e.jsx("div",{className:`px-3 py-2.5 rounded-t-xl bg-gradient-to-b ${s.bgGradient} border-b border-border/30`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`size-2 rounded-full ${s.color}`}),e.jsx("h3",{className:"font-semibold text-sm",children:s.label})]}),e.jsx("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-muted text-muted-foreground",children:a.length})]})}),e.jsxs("div",{className:"flex-1 p-2 space-y-2 overflow-y-auto bg-muted/20 rounded-b-xl min-h-[200px]",children:[a.map(n=>{const i=Se[n.kind]??{label:"?",color:"bg-gray-500"},r=Me[n.priority]??"#6b7280";return e.jsxs(k,{to:`/work-items/${n.id}`,className:"block bg-card border border-border/50 rounded-lg p-3 transition-all duration-150 hover:border-border hover:shadow-lg hover:shadow-black/5 hover:-translate-y-0.5",style:{borderLeftWidth:3,borderLeftColor:r},children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"font-medium text-sm text-foreground line-clamp-2 leading-snug",children:n.title})}),e.jsx("div",{className:`shrink-0 size-5 rounded flex items-center justify-center text-[10px] font-bold text-white ${i.color}`,title:n.kind,children:i.label})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx(v,{className:`text-[10px] px-1.5 py-0 ${L[n.priority]??"bg-gray-500"}`,children:n.priority}),n.not_after&&e.jsxs("span",{className:"flex items-center gap-1 text-[11px] text-muted-foreground",children:[e.jsx(P,{className:"size-3"}),new Date(n.not_after).toLocaleDateString(void 0,{month:"short",day:"numeric"})]})]})]},n.id)}),a.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[e.jsx("div",{className:"size-8 rounded-full bg-muted/50 flex items-center justify-center mb-2",children:s.status==="open"||s.status==="not_started"?e.jsx(_,{className:"size-4"}):s.status==="blocked"?e.jsx(B,{className:"size-4"}):s.status==="cancelled"?e.jsx(E,{className:"size-4"}):e.jsx(S,{className:"size-4"})}),e.jsx("span",{className:"text-xs",children:"No items"})]})]})]},s.status)})})}const R={project:{color:"text-blue-500",bgColor:"bg-blue-500/10"},initiative:{color:"text-violet-500",bgColor:"bg-violet-500/10"},epic:{color:"text-emerald-500",bgColor:"bg-emerald-500/10"},issue:{color:"text-gray-500",bgColor:"bg-gray-500/10"}},U={not_started:{icon:e.jsx(_,{className:"size-3 text-gray-400"}),label:"Not Started"},in_progress:{icon:e.jsx(P,{className:"size-3 text-yellow-500"}),label:"In Progress"},blocked:{icon:e.jsx(B,{className:"size-3 text-red-500"}),label:"Blocked"},done:{icon:e.jsx(S,{className:"size-3 text-green-500"}),label:"Done"},cancelled:{icon:e.jsx(E,{className:"size-3 text-gray-400"}),label:"Cancelled"}};function Q({item:t,expanded:o,onToggle:s,depth:a}){const n=o.has(t.id),i=t.children&&t.children.length>0,r=R[t.kind]??R.issue,m=U[t.status]??U.not_started;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 py-1.5 px-2 rounded-md hover:bg-muted/50 transition-colors group",style:{paddingLeft:`${a*20+8}px`},children:[i?e.jsx("button",{onClick:()=>s(t.id),className:"shrink-0 size-5 rounded flex items-center justify-center hover:bg-muted text-muted-foreground","aria-label":n?"Collapse":"Expand",children:n?e.jsx(xe,{className:"size-3.5"}):e.jsx(A,{className:"size-3.5"})}):e.jsx("span",{className:"shrink-0 size-5"}),e.jsx("div",{className:`shrink-0 size-5 rounded flex items-center justify-center ${r.bgColor}`,children:i&&n?e.jsx(me,{className:`size-3.5 ${r.color}`}):i?e.jsx(ue,{className:`size-3.5 ${r.color}`}):e.jsx(_,{className:`size-3 ${r.color}`})}),e.jsx(k,{to:`/work-items/${t.id}`,className:"flex-1 min-w-0 text-sm font-medium text-foreground hover:text-primary transition-colors truncate",children:t.title}),e.jsxs("div",{className:"flex items-center gap-1.5 shrink-0",children:[m.icon,e.jsx("span",{className:"text-xs text-muted-foreground hidden sm:inline",children:m.label})]}),t.kind==="issue"&&e.jsx(v,{className:`text-[10px] px-1 py-0 ${L[t.kind==="issue","P2"]}`,variant:"secondary",children:t.kind}),(t.childCount??0)>0&&e.jsxs("span",{className:"text-xs text-muted-foreground/60",children:["(",t.childCount,")"]})]}),i&&n&&e.jsx("div",{children:t.children.map(h=>e.jsx(Q,{item:h,expanded:o,onToggle:s,depth:a+1},h.id))})]})}function Te({items:t,isLoading:o,projectId:s}){const[a,n]=y.useState(()=>{const r=new Set;for(const m of t)r.add(m.id);return r}),i=y.useCallback(r=>{n(m=>{const h=new Set(m);return h.has(r)?h.delete(r):h.add(r),h})},[]);return o?e.jsx("div",{className:"space-y-2",children:Array.from({length:5}).map((r,m)=>e.jsxs("div",{className:"flex items-center gap-2",style:{paddingLeft:`${m%3*20+8}px`},children:[e.jsx(g,{width:16,height:16}),e.jsx(g,{width:16,height:16}),e.jsx(g,{width:`${60+Math.random()*30}%`,height:14})]},m))}):t.length===0?e.jsx("div",{children:e.jsx(T,{variant:"folder",title:"No items in this project",description:"Add work items to see the project hierarchy."})}):e.jsx("div",{className:"space-y-0.5",children:t.map(r=>e.jsx(Q,{item:r,expanded:a,onToggle:i,depth:0},r.id))})}const Y={open:"bg-blue-400",not_started:"bg-gray-400",in_progress:"bg-yellow-400",blocked:"bg-red-400",closed:"bg-green-400",done:"bg-green-400",cancelled:"bg-gray-300"},Pe=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function Fe(t,o){return new Date(t,o,1)}function Be(t,o){return new Date(t,o+1,0).getDate()}function Ee(t,o){const s=Fe(t,o),a=Be(t,o),n=s.getDay(),i=[];for(let r=0;r<n;r++)i.push({date:null,dayOfMonth:0});for(let r=1;r<=a;r++)i.push({date:new Date(t,o,r),dayOfMonth:r});for(;i.length%7!==0;)i.push({date:null,dayOfMonth:0});return i}function Ae(t,o){return t.filter(s=>s.not_after?s.not_after.split("T")[0]===o:!1)}function q(t){const o=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${o}-${s}-${a}`}function Oe({items:t,isLoading:o}){const s=new Date,[a,n]=y.useState(s.getFullYear()),[i,r]=y.useState(s.getMonth()),m=y.useMemo(()=>Ee(a,i),[a,i]),h=new Date(a,i).toLocaleDateString(void 0,{month:"long",year:"numeric"}),b=()=>{i===0?(n(c=>c-1),r(11)):r(c=>c-1)},l=()=>{i===11?(n(c=>c+1),r(0)):r(c=>c+1)},p=()=>{n(s.getFullYear()),r(s.getMonth())},N=q(s),f=t.filter(c=>c.not_after);return o?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{width:200,height:24}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{width:32,height:32}),e.jsx(g,{width:60,height:32}),e.jsx(g,{width:32,height:32})]})]}),e.jsx(g,{width:"100%",height:400})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:h}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(D,{variant:"outline",size:"sm",onClick:b,children:e.jsx(he,{className:"size-4"})}),e.jsx(D,{variant:"outline",size:"sm",onClick:p,children:"Today"}),e.jsx(D,{variant:"outline",size:"sm",onClick:l,children:e.jsx(A,{className:"size-4"})})]})]}),e.jsxs("div",{className:"border border-border rounded-lg overflow-hidden",children:[e.jsx("div",{className:"grid grid-cols-7 bg-muted/50",children:Pe.map(c=>e.jsx("div",{className:"px-2 py-2 text-center text-xs font-medium text-muted-foreground border-b border-border",children:c},c))}),e.jsx("div",{className:"grid grid-cols-7",children:m.map((c,u)=>{if(!c.date)return e.jsx("div",{className:"min-h-[80px] sm:min-h-[100px] border-b border-r border-border bg-muted/10 last:border-r-0"},`empty-${u}`);const w=q(c.date),x=Ae(t,w),z=w===N,d=c.date.getDay()===0||c.date.getDay()===6;return e.jsxs("div",{className:`min-h-[80px] sm:min-h-[100px] border-b border-r border-border p-1 transition-colors ${z?"bg-primary/5":d?"bg-muted/20":""} last:border-r-0`,children:[e.jsxs("div",{className:"flex items-center justify-between px-1 mb-1",children:[e.jsx("span",{className:`text-xs font-medium ${z?"text-primary-foreground bg-primary size-5 rounded-full flex items-center justify-center":"text-muted-foreground"}`,children:c.dayOfMonth}),x.length>2&&e.jsxs("span",{className:"text-[10px] text-muted-foreground",children:["+",x.length-2]})]}),e.jsx("div",{className:"space-y-0.5 overflow-hidden max-h-[60px]",children:x.slice(0,2).map(j=>e.jsxs(k,{to:`/work-items/${j.id}`,className:"flex items-center gap-1 px-1 py-0.5 rounded text-[10px] leading-tight truncate hover:bg-muted/50 transition-colors",title:j.title,children:[e.jsx("span",{className:`shrink-0 size-1.5 rounded-full ${Y[j.status]??Y.open}`}),e.jsx("span",{className:"truncate text-foreground",children:j.title})]},j.id))})]},w)})})]}),f.length===0&&t.length>0&&e.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No items have due dates set. Add due dates to work items to see them on the calendar."}),t.length===0&&e.jsx(T,{variant:"calendar",title:"No items to display",description:"Add work items to this project to see them on the calendar."})]})}function Ge(t){const s=new Date().getTime()-t.getTime(),a=Math.floor(s/6e4),n=Math.floor(a/60),i=Math.floor(n/24);return a<1?"just now":a<60?`${a}m ago`:n<24?`${n}h ago`:i<7?`${i}d ago`:t.toLocaleDateString(void 0,{month:"short",day:"numeric"})}function H(t){return t?new Date(t).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):"--"}function X(t){const o=[];for(const s of t.children)o.push(s),s.children.length>0&&o.push(...X(s));return o}const We={open:"Open",in_progress:"In Progress",blocked:"Blocked",closed:"Done",done:"Done",not_started:"Not Started",cancelled:"Cancelled"},Ve={open:"bg-blue-500/10 text-blue-600 dark:text-blue-400",in_progress:"bg-yellow-500/10 text-yellow-600 dark:text-yellow-400",blocked:"bg-red-500/10 text-red-600 dark:text-red-400",closed:"bg-green-500/10 text-green-600 dark:text-green-400",done:"bg-green-500/10 text-green-600 dark:text-green-400",not_started:"bg-gray-500/10 text-gray-600 dark:text-gray-400",cancelled:"bg-gray-500/10 text-gray-500"};function kt(){const{projectId:t,view:o}=Z(),s=t??"";J();const a=o??"list",{data:n,isLoading:i,error:r,refetch:m}=ee(s),{data:h,isLoading:b}=te(),l=se(),p=C.useMemo(()=>{if(!h)return null;const d=j=>{for(const F of j){if(F.id===s)return F;const O=d(F.children);if(O)return O}return null};return d(h.items)},[h,s]),N=C.useMemo(()=>p?X(p):[],[p]),f=C.useMemo(()=>N.map(d=>({id:d.id,title:d.title,description:null,status:d.status,priority:d.priority,task_type:null,kind:d.kind,estimate_minutes:null,created_at:"",not_before:null,not_after:null,children_count:d.children_count})),[N]),c=C.useMemo(()=>p?ce(p.children):[],[p]),u=C.useMemo(()=>{const d={done:0,in_progress:0,blocked:0,open:0,total:0};for(const j of N)d.total++,j.status==="closed"||j.status==="done"?d.done++:j.status==="in_progress"?d.in_progress++:j.status==="blocked"?d.blocked++:d.open++;return d},[N]),w=y.useCallback(async d=>{l.mutate({id:s,body:{title:d}})},[s,l]);if(i)return e.jsx("div",{"data-testid":"page-project-detail",className:"flex flex-col h-full",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{width:32,height:32}),e.jsx(g,{width:300,height:28})]}),e.jsx(g,{width:"60%",height:16}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{width:80,height:24}),e.jsx(g,{width:80,height:24}),e.jsx(g,{width:80,height:24})]}),e.jsx(K,{rows:5,columns:5})]})});if(r||!n)return e.jsx("div",{"data-testid":"page-project-detail",className:"p-6",children:e.jsx(le,{type:"generic",title:"Failed to load project",description:r instanceof Error?r.message:"The requested project could not be loaded.",onRetry:()=>m(),action:e.jsx(D,{variant:"outline",asChild:!0,children:e.jsx(k,{to:"/work-items",children:"Back to Work Items"})})})});const x=n,z=u.total>0?Math.round(u.done/u.total*100):0;return e.jsxs("div",{"data-testid":"page-project-detail",className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-border bg-background flex items-center gap-3 shrink-0",children:[e.jsx(D,{variant:"ghost",size:"sm",asChild:!0,children:e.jsxs(k,{to:"/work-items",children:[e.jsx(A,{className:"mr-1 size-4 rotate-180"}),"Back"]})}),e.jsxs("div",{className:"ml-auto flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(P,{className:"size-3"}),"Updated ",Ge(new Date(x.updated_at)),l.isPending&&e.jsx(v,{variant:"outline",className:"text-xs animate-pulse ml-2",children:"Saving..."})]})]}),e.jsxs("div",{className:"px-6 pt-5 pb-4 border-b border-border bg-gradient-to-b from-muted/30 to-background",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"mt-1 size-8 rounded-md bg-blue-500/10 flex items-center justify-center shrink-0",children:e.jsx(Ce,{className:"size-4 text-blue-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(de,{value:x.title,onSave:w,selectOnFocus:!0,className:"text-xl font-bold text-foreground leading-snug",validate:d=>d.trim().length>0}),x.description&&e.jsx("p",{className:"mt-1 text-sm text-muted-foreground line-clamp-2",children:x.description})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[e.jsx(v,{variant:"outline",className:"text-xs capitalize",children:x.kind}),e.jsx(v,{variant:"secondary",className:`text-xs ${Ve[x.status]??""}`,children:We[x.status]??x.status}),x.priority&&e.jsx(v,{className:`text-xs ${L[x.priority]??""}`,children:x.priority}),x.not_before&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Start: ",H(x.not_before)]}),x.not_after&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Due: ",H(x.not_after)]})]}),u.total>0&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[u.done," of ",u.total," items done"]}),e.jsxs("span",{children:[z,"%"]})]}),e.jsxs("div",{className:"h-2 rounded-full bg-muted overflow-hidden flex","data-testid":"progress-bar",children:[u.done>0&&e.jsx("div",{className:"bg-green-500 transition-all",style:{width:`${u.done/u.total*100}%`}}),u.in_progress>0&&e.jsx("div",{className:"bg-yellow-500 transition-all",style:{width:`${u.in_progress/u.total*100}%`}}),u.blocked>0&&e.jsx("div",{className:"bg-red-500 transition-all",style:{width:`${u.blocked/u.total*100}%`}})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs(re,{defaultValue:a,className:"h-full",children:[e.jsx("div",{className:"px-6 pt-3 border-b border-border bg-background",children:e.jsxs(ae,{variant:"line",className:"w-full justify-start",children:[e.jsxs($,{value:"list",className:"gap-1.5",children:[e.jsx(pe,{className:"size-3.5"}),"List"]}),e.jsxs($,{value:"board",className:"gap-1.5",children:[e.jsx(ge,{className:"size-3.5"}),"Board"]}),e.jsxs($,{value:"tree",className:"gap-1.5",children:[e.jsx(oe,{className:"size-3.5"}),"Tree"]}),e.jsxs($,{value:"calendar",className:"gap-1.5",children:[e.jsx(fe,{className:"size-3.5"}),"Calendar"]})]})}),e.jsx(M,{value:"list","data-testid":"view-list",className:"px-6 py-4",children:e.jsx($e,{items:f,isLoading:b,projectId:s})}),e.jsx(M,{value:"board","data-testid":"view-board",className:"px-6 py-4",children:e.jsx(Le,{items:f,isLoading:b})}),e.jsx(M,{value:"tree","data-testid":"view-tree",className:"px-6 py-4",children:e.jsx(Te,{items:c,isLoading:b,projectId:s})}),e.jsx(M,{value:"calendar","data-testid":"view-calendar",className:"px-6 py-4",children:e.jsx(Oe,{items:f,isLoading:b})})]})})]})}export{kt as ProjectDetailPage};
//# sourceMappingURL=ProjectDetailPage-DGA1mLpB.js.map
