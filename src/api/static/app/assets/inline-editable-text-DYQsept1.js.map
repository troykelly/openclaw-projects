{"version":3,"file":"inline-editable-text-DYQsept1.js","sources":["../../../../ui/components/inline-edit/inline-editable-text.tsx"],"sourcesContent":["import * as React from 'react';\nimport { useState, useRef, useCallback, useEffect } from 'react';\nimport { cn } from '@/ui/lib/utils';\nimport { Input } from '@/ui/components/ui/input';\nimport { Textarea } from '@/ui/components/ui/textarea';\nimport type { InlineEditableTextProps } from './types';\n\nexport function InlineEditableText({\n  value,\n  onSave,\n  validate,\n  saveOnBlur = true,\n  selectOnFocus = true,\n  placeholder,\n  className,\n  editClassName,\n  disabled = false,\n  multiline = false,\n  doubleClick = false,\n}: InlineEditableTextProps) {\n  const [isEditing, setIsEditing] = useState(false);\n  const [editValue, setEditValue] = useState(value);\n  const [isSaving, setIsSaving] = useState(false);\n  const inputRef = useRef<HTMLInputElement | HTMLTextAreaElement>(null);\n\n  // Update edit value when prop value changes\n  useEffect(() => {\n    if (!isEditing) {\n      setEditValue(value);\n    }\n  }, [value, isEditing]);\n\n  const startEditing = useCallback(() => {\n    if (disabled) return;\n    setEditValue(value);\n    setIsEditing(true);\n  }, [value, disabled]);\n\n  const handleClick = useCallback(() => {\n    if (!doubleClick) {\n      startEditing();\n    }\n  }, [doubleClick, startEditing]);\n\n  const handleDoubleClick = useCallback(() => {\n    startEditing();\n  }, [startEditing]);\n\n  const handleSave = useCallback(async () => {\n    // Don't save if value unchanged\n    if (editValue === value) {\n      setIsEditing(false);\n      return;\n    }\n\n    // Validate if provided\n    if (validate && !validate(editValue)) {\n      return;\n    }\n\n    setIsSaving(true);\n    try {\n      await onSave(editValue);\n      setIsEditing(false);\n    } catch {\n      // Keep editing on error\n    } finally {\n      setIsSaving(false);\n    }\n  }, [editValue, value, validate, onSave]);\n\n  const handleCancel = useCallback(() => {\n    setEditValue(value);\n    setIsEditing(false);\n  }, [value]);\n\n  const handleKeyDown = useCallback(\n    (e: React.KeyboardEvent) => {\n      if (e.key === 'Enter' && !multiline) {\n        e.preventDefault();\n        handleSave();\n      } else if (e.key === 'Enter' && multiline && (e.metaKey || e.ctrlKey)) {\n        e.preventDefault();\n        handleSave();\n      } else if (e.key === 'Escape') {\n        e.preventDefault();\n        handleCancel();\n      }\n    },\n    [handleSave, handleCancel, multiline]\n  );\n\n  const handleBlur = useCallback(() => {\n    if (saveOnBlur) {\n      handleSave();\n    }\n  }, [saveOnBlur, handleSave]);\n\n  // Focus and select on edit start\n  useEffect(() => {\n    if (isEditing && inputRef.current) {\n      inputRef.current.focus();\n      if (selectOnFocus && inputRef.current instanceof HTMLInputElement) {\n        inputRef.current.select();\n      }\n    }\n  }, [isEditing, selectOnFocus]);\n\n  if (isEditing) {\n    const commonProps = {\n      value: editValue,\n      onChange: (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) =>\n        setEditValue(e.target.value),\n      onKeyDown: handleKeyDown,\n      onBlur: handleBlur,\n      disabled: isSaving,\n      className: cn('ring-2 ring-primary', editClassName),\n    };\n\n    if (multiline) {\n      return (\n        <Textarea\n          ref={inputRef as React.RefObject<HTMLTextAreaElement>}\n          {...commonProps}\n          data-testid=\"inline-edit-textarea\"\n        />\n      );\n    }\n\n    return (\n      <Input\n        ref={inputRef as React.RefObject<HTMLInputElement>}\n        {...commonProps}\n        data-testid=\"inline-edit-input\"\n      />\n    );\n  }\n\n  return (\n    <span\n      onClick={handleClick}\n      onDoubleClick={handleDoubleClick}\n      className={cn(\n        'cursor-text rounded px-1 -mx-1 hover:bg-muted/50 transition-colors',\n        disabled && 'cursor-default hover:bg-transparent',\n        !value && 'text-muted-foreground italic',\n        className\n      )}\n      data-testid=\"inline-edit-display\"\n    >\n      {value || placeholder || '\\u00A0'}\n    </span>\n  );\n}\n"],"names":["InlineEditableText","value","onSave","validate","saveOnBlur","selectOnFocus","placeholder","className","editClassName","disabled","multiline","doubleClick","isEditing","setIsEditing","useState","editValue","setEditValue","isSaving","setIsSaving","inputRef","useRef","useEffect","startEditing","useCallback","handleClick","handleDoubleClick","handleSave","handleCancel","handleKeyDown","e","handleBlur","commonProps","cn","jsx","Textarea","Input"],"mappings":"2KAOO,SAASA,EAAmB,CACjC,MAAAC,EACA,OAAAC,EACA,SAAAC,EACA,WAAAC,EAAa,GACb,cAAAC,EAAgB,GAChB,YAAAC,EACA,UAAAC,EACA,cAAAC,EACA,SAAAC,EAAW,GACX,UAAAC,EAAY,GACZ,YAAAC,EAAc,EAChB,EAA4B,CAC1B,KAAM,CAACC,EAAWC,CAAY,EAAIC,EAAAA,SAAS,EAAK,EAC1C,CAACC,EAAWC,CAAY,EAAIF,EAAAA,SAASb,CAAK,EAC1C,CAACgB,EAAUC,CAAW,EAAIJ,EAAAA,SAAS,EAAK,EACxCK,EAAWC,EAAAA,OAA+C,IAAI,EAGpEC,EAAAA,UAAU,IAAM,CACTT,GACHI,EAAaf,CAAK,CAEtB,EAAG,CAACA,EAAOW,CAAS,CAAC,EAErB,MAAMU,EAAeC,EAAAA,YAAY,IAAM,CACjCd,IACJO,EAAaf,CAAK,EAClBY,EAAa,EAAI,EACnB,EAAG,CAACZ,EAAOQ,CAAQ,CAAC,EAEde,EAAcD,EAAAA,YAAY,IAAM,CAC/BZ,GACHW,EAAA,CAEJ,EAAG,CAACX,EAAaW,CAAY,CAAC,EAExBG,EAAoBF,EAAAA,YAAY,IAAM,CAC1CD,EAAA,CACF,EAAG,CAACA,CAAY,CAAC,EAEXI,EAAaH,EAAAA,YAAY,SAAY,CAEzC,GAAIR,IAAcd,EAAO,CACvBY,EAAa,EAAK,EAClB,MACF,CAGA,GAAI,EAAAV,GAAY,CAACA,EAASY,CAAS,GAInC,CAAAG,EAAY,EAAI,EAChB,GAAI,CACF,MAAMhB,EAAOa,CAAS,EACtBF,EAAa,EAAK,CACpB,MAAQ,CAER,QAAA,CACEK,EAAY,EAAK,CACnB,EACF,EAAG,CAACH,EAAWd,EAAOE,EAAUD,CAAM,CAAC,EAEjCyB,EAAeJ,EAAAA,YAAY,IAAM,CACrCP,EAAaf,CAAK,EAClBY,EAAa,EAAK,CACpB,EAAG,CAACZ,CAAK,CAAC,EAEJ2B,EAAgBL,EAAAA,YACnBM,GAA2B,CACtBA,EAAE,MAAQ,SAAW,CAACnB,GAGfmB,EAAE,MAAQ,SAAWnB,IAAcmB,EAAE,SAAWA,EAAE,UAF3DA,EAAE,eAAA,EACFH,EAAA,GAISG,EAAE,MAAQ,WACnBA,EAAE,eAAA,EACFF,EAAA,EAEJ,EACA,CAACD,EAAYC,EAAcjB,CAAS,CAAA,EAGhCoB,EAAaP,EAAAA,YAAY,IAAM,CAC/BnB,GACFsB,EAAA,CAEJ,EAAG,CAACtB,EAAYsB,CAAU,CAAC,EAY3B,GATAL,EAAAA,UAAU,IAAM,CACVT,GAAaO,EAAS,UACxBA,EAAS,QAAQ,MAAA,EACbd,GAAiBc,EAAS,mBAAmB,kBAC/CA,EAAS,QAAQ,OAAA,EAGvB,EAAG,CAACP,EAAWP,CAAa,CAAC,EAEzBO,EAAW,CACb,MAAMmB,EAAc,CAClB,MAAOhB,EACP,SAAWc,GACTb,EAAaa,EAAE,OAAO,KAAK,EAC7B,UAAWD,EACX,OAAQE,EACR,SAAUb,EACV,UAAWe,EAAG,sBAAuBxB,CAAa,CAAA,EAGpD,OAAIE,EAEAuB,EAAAA,IAACC,EAAA,CACC,IAAKf,EACJ,GAAGY,EACJ,cAAY,sBAAA,CAAA,EAMhBE,EAAAA,IAACE,EAAA,CACC,IAAKhB,EACJ,GAAGY,EACJ,cAAY,mBAAA,CAAA,CAGlB,CAEA,OACEE,EAAAA,IAAC,OAAA,CACC,QAAST,EACT,cAAeC,EACf,UAAWO,EACT,qEACAvB,GAAY,sCACZ,CAACR,GAAS,+BACVM,CAAA,EAEF,cAAY,sBAEX,YAASD,GAAe,GAAA,CAAA,CAG/B"}