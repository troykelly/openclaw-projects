import{S as G,p as z,i as l,s as _,k as R,c as T,l as Q,m as A,t as J,o as w,q as X,v as Z,w as B,n as K,r as p,d as Y,b as ee,j as d}from"./index-DoQKFsVP.js";import{c as S,B as te,a as H}from"./button-BTQRjsho.js";var se=class extends G{constructor(e,t){super(),this.options=t,this.#s=e,this.#i=null,this.#r=z(),this.bindMethods(),this.setOptions(t)}#s;#e=void 0;#p=void 0;#t=void 0;#n;#u;#r;#i;#m;#l;#d;#o;#h;#a;#f=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),W(this.#e,this.options)?this.#c():this.updateResult(),this.#g())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return N(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return N(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#R(),this.#S(),this.#e.removeObserver(this)}setOptions(e){const t=this.options,s=this.#e;if(this.options=this.#s.defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof l(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#x(),this.#e.setOptions(this.options),t._defaulted&&!_(this.options,t)&&this.#s.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const r=this.hasListeners();r&&V(this.#e,s,this.options,t)&&this.#c(),this.updateResult(),r&&(this.#e!==s||l(this.options.enabled,this.#e)!==l(t.enabled,this.#e)||R(this.options.staleTime,this.#e)!==R(t.staleTime,this.#e))&&this.#y();const i=this.#v();r&&(this.#e!==s||l(this.options.enabled,this.#e)!==l(t.enabled,this.#e)||i!==this.#a)&&this.#b(i)}getOptimisticResult(e){const t=this.#s.getQueryCache().build(this.#s,e),s=this.createResult(t,e);return ie(this,s)&&(this.#t=s,this.#u=this.options,this.#n=this.#e.state),s}getCurrentResult(){return this.#t}trackResult(e,t){return new Proxy(e,{get:(s,r)=>(this.trackProp(r),t?.(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#r.status==="pending"&&this.#r.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(s,r))})}trackProp(e){this.#f.add(e)}getCurrentQuery(){return this.#e}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#s.defaultQueryOptions(e),s=this.#s.getQueryCache().build(this.#s,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#c({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#t))}#c(e){this.#x();let t=this.#e.fetch(this.options,e);return e?.throwOnError||(t=t.catch(T)),t}#y(){this.#R();const e=R(this.options.staleTime,this.#e);if(Q||this.#t.isStale||!A(e))return;const s=J(this.#t.dataUpdatedAt,e)+1;this.#o=w.setTimeout(()=>{this.#t.isStale||this.updateResult()},s)}#v(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#b(e){this.#S(),this.#a=e,!(Q||l(this.options.enabled,this.#e)===!1||!A(this.#a)||this.#a===0)&&(this.#h=w.setInterval(()=>{(this.options.refetchIntervalInBackground||X.isFocused())&&this.#c()},this.#a))}#g(){this.#y(),this.#b(this.#v())}#R(){this.#o&&(w.clearTimeout(this.#o),this.#o=void 0)}#S(){this.#h&&(w.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){const s=this.#e,r=this.options,i=this.#t,c=this.#n,a=this.#u,m=e!==s?e.state:this.#p,{state:h}=e;let n={...h},b=!1,o;if(t._optimisticResults){const u=this.hasListeners(),g=!u&&W(e,t),C=u&&V(e,s,t,r);(g||C)&&(n={...n,...Z(h.data,e.options)}),t._optimisticResults==="isRestoring"&&(n.fetchStatus="idle")}let{error:x,errorUpdatedAt:j,status:v}=n;o=n.data;let U=!1;if(t.placeholderData!==void 0&&o===void 0&&v==="pending"){let u;i?.isPlaceholderData&&t.placeholderData===a?.placeholderData?(u=i.data,U=!0):u=typeof t.placeholderData=="function"?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,u!==void 0&&(v="success",o=B(i?.data,u,t),b=!0)}if(t.select&&o!==void 0&&!U)if(i&&o===c?.data&&t.select===this.#m)o=this.#l;else try{this.#m=t.select,o=t.select(o),o=B(i?.data,o,t),this.#l=o,this.#i=null}catch(u){this.#i=u}this.#i&&(x=this.#i,o=this.#l,j=Date.now(),v="error");const k=n.fetchStatus==="fetching",M=v==="pending",I=v==="error",D=M&&k,F=o!==void 0,y={status:v,fetchStatus:n.fetchStatus,isPending:M,isSuccess:v==="success",isError:I,isInitialLoading:D,isLoading:D,data:o,dataUpdatedAt:n.dataUpdatedAt,error:x,errorUpdatedAt:j,failureCount:n.fetchFailureCount,failureReason:n.fetchFailureReason,errorUpdateCount:n.errorUpdateCount,isFetched:n.dataUpdateCount>0||n.errorUpdateCount>0,isFetchedAfterMount:n.dataUpdateCount>m.dataUpdateCount||n.errorUpdateCount>m.errorUpdateCount,isFetching:k,isRefetching:k&&!M,isLoadingError:I&&!F,isPaused:n.fetchStatus==="paused",isPlaceholderData:b,isRefetchError:I&&F,isStale:P(e,t),refetch:this.refetch,promise:this.#r,isEnabled:l(t.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const u=y.data!==void 0,g=y.status==="error"&&!u,C=O=>{g?O.reject(y.error):u&&O.resolve(y.data)},L=()=>{const O=this.#r=y.promise=z();C(O)},E=this.#r;switch(E.status){case"pending":e.queryHash===s.queryHash&&C(E);break;case"fulfilled":(g||y.data!==E.value)&&L();break;case"rejected":(!g||y.error!==E.reason)&&L();break}}return y}updateResult(){const e=this.#t,t=this.createResult(this.#e,this.options);if(this.#n=this.#e.state,this.#u=this.options,this.#n.data!==void 0&&(this.#d=this.#e),_(t,e))return;this.#t=t;const s=()=>{if(!e)return!0;const{notifyOnChangeProps:r}=this.options,i=typeof r=="function"?r():r;if(i==="all"||!i&&!this.#f.size)return!0;const c=new Set(i??this.#f);return this.options.throwOnError&&c.add("error"),Object.keys(this.#t).some(a=>{const f=a;return this.#t[f]!==e[f]&&c.has(f)})};this.#C({listeners:s()})}#x(){const e=this.#s.getQueryCache().build(this.#s,this.options);if(e===this.#e)return;const t=this.#e;this.#e=e,this.#p=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#g()}#C(e){K.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(this.#t)}),this.#s.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function re(e,t){return l(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function W(e,t){return re(e,t)||e.state.data!==void 0&&N(e,t,t.refetchOnMount)}function N(e,t,s){if(l(t.enabled,e)!==!1&&R(t.staleTime,e)!=="static"){const r=typeof s=="function"?s(e):s;return r==="always"||r!==!1&&P(e,t)}return!1}function V(e,t,s,r){return(e!==t||l(r.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&P(e,s)}function P(e,t){return l(t.enabled,e)!==!1&&e.isStaleByTime(R(t.staleTime,e))}function ie(e,t){return!_(e.getCurrentResult(),t)}var q=p.createContext(!1),ae=()=>p.useContext(q);q.Provider;function ne(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var oe=p.createContext(ne()),he=()=>p.useContext(oe),ce=(e,t,s)=>{const r=s?.state.error&&typeof e.throwOnError=="function"?Y(e.throwOnError,[s.state.error,s]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||r)&&(t.isReset()||(e.retryOnMount=!1))},ue=e=>{p.useEffect(()=>{e.clearReset()},[e])},le=({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(i&&e.data===void 0||Y(s,[e.error,r])),de=e=>{if(e.suspense){const s=i=>i==="static"?i:Math.max(i??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...i)=>s(r(...i)):s(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},fe=(e,t)=>e.isLoading&&e.isFetching&&!t,pe=(e,t)=>e?.suspense&&t.isPending,$=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function me(e,t,s){const r=ae(),i=he(),c=ee(),a=c.defaultQueryOptions(e);c.getDefaultOptions().queries?._experimental_beforeQuery?.(a);const f=c.getQueryCache().get(a.queryHash);a._optimisticResults=r?"isRestoring":"optimistic",de(a),ce(a,i,f),ue(i);const m=!c.getQueryCache().get(a.queryHash),[h]=p.useState(()=>new t(c,a)),n=h.getOptimisticResult(a),b=!r&&e.subscribed!==!1;if(p.useSyncExternalStore(p.useCallback(o=>{const x=b?h.subscribe(K.batchCalls(o)):T;return h.updateResult(),x},[h,b]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),p.useEffect(()=>{h.setOptions(a)},[a,h]),pe(a,n))throw $(a,h,i);if(le({result:n,errorResetBoundary:i,throwOnError:a.throwOnError,query:f,suspense:a.suspense}))throw n.error;return c.getDefaultOptions().queries?._experimental_afterQuery?.(a,n),a.experimental_prefetchInRender&&!Q&&fe(n,r)&&(m?$(a,h,i):f?.promise)?.catch(T).finally(()=>{h.updateResult()}),a.notifyOnChangeProps?n:h.trackResult(n)}function Te(e,t){return me(e,se)}const ye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ve=S("circle-alert",ye);const be=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ge=S("refresh-cw",be);const Re=[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]],Se=S("server-crash",Re);const xe=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Ce=S("shield-alert",xe);const Ee=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Oe=S("wifi-off",Ee);function we(e){switch(e){case"network":return d.jsx(Oe,{className:"size-12"});case"server":return d.jsx(Se,{className:"size-12"});case"unauthorized":return d.jsx(Ce,{className:"size-12"});default:return d.jsx(ve,{className:"size-12"})}}function ke(e){switch(e){case"network":return{title:"Connection problem",description:"We couldn't reach the server. Check your internet connection and try again."};case"server":return{title:"Server error",description:"Something went wrong on our end. Our team has been notified."};case"unauthorized":return{title:"Access denied",description:"You don't have permission to view this content. Please sign in or contact support."};case"not-found":return{title:"Not found",description:"The item you're looking for doesn't exist or has been removed."};default:return{title:"Something went wrong",description:"An unexpected error occurred. Please try again."}}}function Qe({type:e="generic",title:t,description:s,onRetry:r,retryLabel:i="Try again",isRetrying:c=!1,action:a,className:f}){const m=ke(e);return d.jsxs("div",{"data-testid":"error-state",role:"alert",className:H("flex flex-col items-center justify-center py-12 text-center",f),children:[d.jsx("div",{className:"text-muted-foreground/50",children:we(e)}),d.jsx("h3",{className:"mt-4 text-lg font-semibold",children:t??m.title}),d.jsx("p",{className:"mt-2 max-w-sm text-sm text-muted-foreground",children:s??m.description}),(r||a)&&d.jsxs("div",{className:"mt-6 flex gap-3",children:[r&&d.jsxs(te,{onClick:r,disabled:c,children:[d.jsx(ge,{className:H("mr-2 size-4",c&&"animate-spin")}),i]}),a]})]})}export{ve as C,Qe as E,Te as u};
//# sourceMappingURL=error-state-BiIOivoY.js.map
