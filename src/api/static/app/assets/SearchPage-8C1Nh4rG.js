import{d as N,r as w,j as e,L as v}from"./index-8lelR6qN.js";import{u as k}from"./useQuery-C5fTQTrO.js";import{a as S}from"./api-client-CDvRtWmo.js";import{I as b}from"./input-8OCkwTCE.js";import{B as x}from"./badge-Crynehbs.js";import{a as _,C,b as E}from"./card-iotqpvc8.js";import{E as I}from"./error-state-DLctD4sJ.js";import{E as f}from"./empty-state-DE2qD6F6.js";import{S as q}from"./search-Bq9T0uel.js";import{F as g,U as L}from"./users-BTXwO7qa.js";import{B as z}from"./brain-ZHV8X7Fw.js";import"./button-CCcTHsAD.js";import"./bell-DnBa4S1K.js";import"./mail-BvTIWAWD.js";import"./calendar-c0kNGWNj.js";import"./folder-open-CX6VBEV4.js";const j={all:["search"],query:(t,s)=>[...j.all,t,s]};function B(t,s){const a=new URLSearchParams;return t&&a.set("q",t),k({queryKey:j.query(t,s),queryFn:({signal:r})=>S.get(`/api/search?${a.toString()}`,{signal:r}),enabled:t.length>0})}function F(t){const s=t.url;return s.startsWith("/app/")?s.replace("/app",""):s}function P(t){switch(t){case"work_item":return e.jsx(g,{className:"size-5"});case"contact":return e.jsx(L,{className:"size-5"});case"memory":return e.jsx(z,{className:"size-5"});default:return e.jsx(g,{className:"size-5"})}}function R(t){switch(t){case"work_item":return"Work Items";case"contact":return"Contacts";case"memory":return"Memories";default:return"Results"}}function Q(t){switch(t){case"work_item":return"Work Item";case"contact":return"Contact";case"memory":return"Memory";default:return t}}function ee(){const[t,s]=N(),a=t.get("q")??"",{data:r,isLoading:d,error:o}=B(a),n=w.useMemo(()=>{if(!r?.results)return{work_items:[],contacts:[],memories:[]};const m=[],i=[],p=[];for(const l of r.results)l.type==="work_item"?m.push(l):l.type==="contact"?i.push(l):p.push(l);return{work_items:m,contacts:i,memories:p}},[r]),y=m=>{const i=m.target.value;s(i?{q:i}:{})},c=a.length>0,h=n.work_items.length>0||n.contacts.length>0||n.memories.length>0;return e.jsxs("div",{"data-testid":"page-search",className:"p-6 h-full flex flex-col",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-semibold text-foreground",children:"Search"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Find work items, contacts, and memories"})]}),e.jsxs("div",{className:"relative mb-6 max-w-2xl",children:[e.jsx(q,{className:"absolute left-3 top-1/2 size-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(b,{type:"text",placeholder:"Search...",value:a,onChange:y,className:"pl-9","data-testid":"search-input",autoFocus:!0})]}),!c&&e.jsx("div",{"data-testid":"search-prompt",className:"flex-1 flex items-center justify-center",children:e.jsx(f,{variant:"search",title:"Start searching",description:"Enter a query above to search across work items, contacts, and memories."})}),c&&d&&e.jsx("div",{"data-testid":"search-loading",className:"flex-1",children:e.jsx(_,{count:6,variant:"row"})}),c&&o&&e.jsx(I,{type:"generic",title:"Search failed",description:o instanceof Error?o.message:"An unexpected error occurred."}),c&&!d&&!o&&!h&&e.jsx(f,{variant:"search",title:"No results found",description:`No results for "${a}". Try a different search term.`}),c&&!d&&!o&&h&&e.jsxs("div",{className:"flex-1 space-y-6","data-testid":"search-results",children:[n.work_items.length>0&&e.jsx(u,{testId:"group-work_items",type:"work_item",items:n.work_items}),n.contacts.length>0&&e.jsx(u,{testId:"group-contacts",type:"contact",items:n.contacts}),n.memories.length>0&&e.jsx(u,{testId:"group-memories",type:"memory",items:n.memories})]})]})}function u({testId:t,type:s,items:a}){return e.jsxs("div",{"data-testid":t,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"text-muted-foreground",children:P(s)}),e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:R(s)}),e.jsx(x,{variant:"secondary",className:"text-xs",children:a.length})]}),e.jsx("div",{className:"space-y-2",children:a.map(r=>e.jsx(C,{className:"transition-colors hover:bg-accent/30",children:e.jsx(E,{className:"p-3",children:e.jsx(v,{to:F(r),"data-testid":`result-link-${r.id}`,className:"block",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"font-medium text-foreground truncate",children:r.title}),r.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-0.5 line-clamp-2",children:r.description})]}),e.jsx(x,{variant:"outline",className:"text-xs shrink-0",children:Q(r.type)})]})})})},r.id))})]})}export{ee as SearchPage};
//# sourceMappingURL=SearchPage-8C1Nh4rG.js.map
