import{j as e,L as m}from"./index-Dmu1Cmf3.js";import{u as x,E as p}from"./error-state-CCoNnbdR.js";import{a as u}from"./api-client-CDvRtWmo.js";import{S as h,a as f,C as n,b as c}from"./card-BWtpZjNX.js";import{E as y}from"./empty-state-Cr_6DAnC.js";import{S as v}from"./scroll-area-C0mBrwpt.js";import"./button-B4tyHn7n.js";import"./bell-DMA7QWwP.js";import"./mail-Bh_6JRWm.js";import"./users-DVF8IM-O.js";import"./search-CGjsCXTe.js";import"./index-DT505RDd.js";import"./index-CicDskkn.js";import"./index-BdQq_4o_.js";const d={all:["activity"],list:t=>[...d.all,"list",t]};function g(t=50){return x({queryKey:d.list(t),queryFn:({signal:s})=>u.get(`/api/activity?limit=${t}`,{signal:s})})}function j(t){return{id:t.id,actorType:t.actor_email?.includes("agent")?"agent":"human",actorName:t.actor_email||"System",action:t.type==="status_change"?"status_changed":t.type,entityId:t.work_item_id,entityTitle:t.work_item_title,detail:t.description,timestamp:new Date(t.created_at)}}function N(t){switch(t){case"created":return"created";case"updated":return"updated";case"status_changed":return"changed status of";case"commented":return"commented on";case"assigned":return"assigned";default:return t}}function q(){const{data:t,isLoading:s,error:i,refetch:l}=g(50);if(s)return e.jsxs("div",{"data-testid":"page-activity",className:"p-6",children:[e.jsx("div",{className:"mb-6 flex items-center justify-between",children:e.jsx(h,{width:200,height:32})}),e.jsx(f,{count:5,variant:"row"})]});if(i)return e.jsx("div",{"data-testid":"page-activity",className:"p-6",children:e.jsx(p,{type:"generic",title:"Failed to load activity",description:i instanceof Error?i.message:"Unknown error",onRetry:()=>l()})});const r=t?.items??[];if(r.length===0)return e.jsxs("div",{"data-testid":"page-activity",className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-semibold text-foreground mb-4",children:"Activity Feed"}),e.jsx(n,{children:e.jsx(c,{className:"p-8",children:e.jsx(y,{variant:"no-data",title:"No activity yet",description:"Activity will appear here when work items are created or updated."})})})]});const o=r.map(j);return e.jsxs("div",{"data-testid":"page-activity",className:"p-6 h-full flex flex-col",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-semibold text-foreground",children:"Activity Feed"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Recent updates across all work items"})]}),e.jsx(n,{className:"flex-1",children:e.jsx(c,{className:"p-0",children:e.jsx(v,{className:"h-[calc(100vh-200px)]",children:e.jsx("div",{className:"divide-y",children:o.map(a=>e.jsx("div",{className:"p-4 hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`size-8 rounded-full flex items-center justify-center shrink-0 ${a.actorType==="agent"?"bg-violet-500/10 text-violet-500":"bg-primary/10 text-primary"}`,children:e.jsx("span",{className:"text-xs font-medium",children:a.actorName.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:a.actorName}),e.jsx("span",{className:"text-xs text-muted-foreground",children:N(a.action)})]}),e.jsx(m,{to:`/work-items/${a.entityId}`,className:"text-sm font-medium text-primary hover:underline",children:a.entityTitle}),a.detail&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.detail}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[a.timestamp.toLocaleDateString()," at"," ",a.timestamp.toLocaleTimeString()]})]})]})},a.id))})})})})]})}export{q as ActivityPage};
//# sourceMappingURL=ActivityPage-aPq8MJ0Z.js.map
