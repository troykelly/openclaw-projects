{"version":3,"file":"GlobalTimelinePage-Bxc9Is-g.js","sources":["../../../../ui/pages/GlobalTimelinePage.tsx"],"sourcesContent":["/**\n * Global timeline page.\n *\n * Displays a Gantt-style view of all work items with scheduled dates.\n * Supports zoom levels (day/week/month/quarter) and filtering by item\n * kind. Uses TanStack Query via the useGlobalTimeline hook for data\n * fetching with automatic refetch on filter changes.\n */\nimport React, { useState, useMemo } from 'react';\nimport { Link } from 'react-router';\nimport { useGlobalTimeline } from '@/ui/hooks/queries/use-timeline';\nimport { kindFillColors } from '@/ui/lib/work-item-utils';\nimport { Skeleton, ErrorState, EmptyState } from '@/ui/components/feedback';\nimport { Button } from '@/ui/components/ui/button';\nimport { Card, CardContent } from '@/ui/components/ui/card';\nimport { ScrollArea, ScrollBar } from '@/ui/components/ui/scroll-area';\n\n/** Supported zoom levels for the timeline view. */\ntype TimelineZoomLevel = 'day' | 'week' | 'month' | 'quarter';\n\n/** Pixels-per-day and display label for each zoom level. */\nconst ZOOM_CONFIGS: Record<TimelineZoomLevel, { pixelsPerDay: number; label: string }> = {\n  day: { pixelsPerDay: 60, label: 'Day' },\n  week: { pixelsPerDay: 12, label: 'Week' },\n  month: { pixelsPerDay: 3, label: 'Month' },\n  quarter: { pixelsPerDay: 1, label: 'Quarter' },\n};\n\nexport function GlobalTimelinePage(): React.JSX.Element {\n  const [zoom, setZoom] = useState<TimelineZoomLevel>('week');\n  const [kindFilter, setKindFilter] = useState<string[]>([]);\n\n  const { data, isLoading, error, refetch } = useGlobalTimeline(\n    kindFilter.length > 0 ? kindFilter : undefined,\n  );\n\n  const handleKindToggle = (kind: string) => {\n    setKindFilter((prev) =>\n      prev.includes(kind) ? prev.filter((k) => k !== kind) : [...prev, kind],\n    );\n  };\n\n  const handleZoomIn = () => {\n    const levels: TimelineZoomLevel[] = ['quarter', 'month', 'week', 'day'];\n    const idx = levels.indexOf(zoom);\n    if (idx < levels.length - 1) setZoom(levels[idx + 1]);\n  };\n\n  const handleZoomOut = () => {\n    const levels: TimelineZoomLevel[] = ['quarter', 'month', 'week', 'day'];\n    const idx = levels.indexOf(zoom);\n    if (idx > 0) setZoom(levels[idx - 1]);\n  };\n\n  if (isLoading) {\n    return (\n      <div data-testid=\"page-global-timeline\" className=\"p-6\">\n        <div className=\"mb-6 flex items-center justify-between\">\n          <Skeleton width={200} height={32} />\n          <div className=\"flex gap-2\">\n            <Skeleton width={100} height={36} />\n            <Skeleton width={100} height={36} />\n          </div>\n        </div>\n        <Skeleton width=\"100%\" height={400} />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div data-testid=\"page-global-timeline\" className=\"p-6\">\n        <ErrorState\n          type=\"generic\"\n          title=\"Failed to load timeline\"\n          description={error instanceof Error ? error.message : 'Unknown error'}\n          onRetry={() => refetch()}\n        />\n      </div>\n    );\n  }\n\n  const items = data?.items ?? [];\n  const dependencies = data?.dependencies ?? [];\n\n  if (items.length === 0) {\n    return (\n      <div data-testid=\"page-global-timeline\" className=\"p-6\">\n        <div className=\"mb-6\">\n          <h1 className=\"text-2xl font-semibold text-foreground\">Timeline</h1>\n          <p className=\"text-sm text-muted-foreground mt-1\">Gantt view of all work items</p>\n        </div>\n        <Card>\n          <CardContent className=\"p-8\">\n            <EmptyState\n              variant=\"no-data\"\n              title=\"No scheduled items\"\n              description=\"Add dates to your work items to see them on the timeline.\"\n            />\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  // Compute date range from items\n  const dates = items\n    .flatMap((i) => [i.not_before, i.not_after])\n    .filter((d): d is string => d !== null)\n    .map((d) => new Date(d).getTime());\n\n  const now = Date.now();\n  let minDate = dates.length > 0 ? Math.min(...dates) : now;\n  let maxDate = dates.length > 0 ? Math.max(...dates) : now + 30 * 24 * 60 * 60 * 1000;\n\n  const range = maxDate - minDate || 1;\n  minDate -= range * 0.05;\n  maxDate += range * 0.05;\n\n  const zoomConfig = ZOOM_CONFIGS[zoom];\n  const dayMs = 24 * 60 * 60 * 1000;\n  const totalDays = Math.ceil((maxDate - minDate) / dayMs);\n  const chartWidth = Math.max(800, totalDays * zoomConfig.pixelsPerDay);\n  const rowHeight = 36;\n  const labelWidth = 240;\n  const chartHeight = Math.max(200, items.length * rowHeight + 60);\n\n  function dateToX(date: number): number {\n    return labelWidth + ((date - minDate) / (maxDate - minDate)) * (chartWidth - labelWidth - 20);\n  }\n\n  const itemPositions: Record<string, { y: number }> = {};\n  items.forEach((item, idx) => {\n    itemPositions[item.id] = { y: idx * rowHeight + 40 };\n  });\n\n  const statusBgColors: Record<string, string> = {\n    done: 'opacity-60',\n    in_progress: '',\n    blocked: 'opacity-80 stroke-red-500 stroke-2',\n    open: 'opacity-40',\n  };\n\n  // Generate date markers\n  const markerInterval = zoom === 'day' ? dayMs : zoom === 'week' ? 7 * dayMs : zoom === 'month' ? 30 * dayMs : 90 * dayMs;\n  const dateMarkers: { x: number; label: string }[] = [];\n  for (let d = minDate; d <= maxDate; d += markerInterval) {\n    dateMarkers.push({ x: dateToX(d), label: new Date(d).toLocaleDateString() });\n  }\n\n  return (\n    <div data-testid=\"page-global-timeline\" className=\"p-6 h-full flex flex-col\">\n      {/* Header */}\n      <div className=\"mb-6 flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-semibold text-foreground\">Timeline</h1>\n          <p className=\"text-sm text-muted-foreground mt-1\">\n            {items.length} item{items.length !== 1 ? 's' : ''} with scheduled dates\n          </p>\n        </div>\n        <div className=\"flex items-center gap-4\">\n          {/* Kind filters */}\n          <div className=\"flex gap-1\">\n            {(['project', 'initiative', 'epic', 'issue'] as const).map((kind) => (\n              <Button\n                key={kind}\n                variant={kindFilter.length === 0 || kindFilter.includes(kind) ? 'secondary' : 'outline'}\n                size=\"sm\"\n                onClick={() => handleKindToggle(kind)}\n                className=\"text-xs\"\n              >\n                {kind.charAt(0).toUpperCase() + kind.slice(1)}\n              </Button>\n            ))}\n          </div>\n          {/* Zoom controls */}\n          <div className=\"flex gap-1\">\n            <Button variant=\"outline\" size=\"sm\" onClick={handleZoomIn} disabled={zoom === 'day'}>\n              Zoom In\n            </Button>\n            <Button variant=\"outline\" size=\"sm\" onClick={handleZoomOut} disabled={zoom === 'quarter'}>\n              Zoom Out\n            </Button>\n            <span className=\"ml-2 text-sm text-muted-foreground self-center\">{zoomConfig.label} view</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Timeline Chart */}\n      <Card className=\"flex-1 overflow-hidden\">\n        <CardContent className=\"p-0 h-full\">\n          <ScrollArea className=\"h-full\">\n            <div className=\"flex\" style={{ minWidth: `${chartWidth}px` }}>\n              {/* Sticky labels column */}\n              <div\n                className=\"sticky left-0 z-10 bg-background border-r\"\n                style={{ width: `${labelWidth}px`, minWidth: `${labelWidth}px` }}\n              >\n                <div className=\"h-10 border-b bg-muted/30 px-3 flex items-center\">\n                  <span className=\"text-sm font-medium text-muted-foreground\">Work Item</span>\n                </div>\n                {items.map((item) => (\n                  <div\n                    key={item.id}\n                    className=\"h-9 border-b px-3 flex items-center gap-2 hover:bg-muted/50 transition-colors\"\n                    style={{ paddingLeft: `${12 + (item.level || 0) * 16}px` }}\n                  >\n                    <span\n                      className={`size-2 rounded-full ${kindFillColors[item.kind] || 'bg-gray-400'}`}\n                    />\n                    <Link\n                      to={`/work-items/${item.id}`}\n                      className=\"text-sm truncate hover:text-primary hover:underline\"\n                      title={item.title}\n                    >\n                      {item.title}\n                    </Link>\n                  </div>\n                ))}\n              </div>\n\n              {/* Chart area */}\n              <div className=\"flex-1\">\n                <svg width={chartWidth - labelWidth} height={chartHeight}>\n                  {/* Date axis */}\n                  <g className=\"text-[10px]\">\n                    {dateMarkers.map((m, i) => (\n                      <g key={i}>\n                        <line\n                          x1={m.x - labelWidth}\n                          y1={40}\n                          x2={m.x - labelWidth}\n                          y2={chartHeight}\n                          className=\"stroke-border\"\n                          strokeDasharray=\"4,4\"\n                        />\n                        <text\n                          x={m.x - labelWidth}\n                          y={28}\n                          textAnchor=\"middle\"\n                          className=\"fill-muted-foreground\"\n                        >\n                          {m.label}\n                        </text>\n                      </g>\n                    ))}\n                  </g>\n\n                  {/* Today line */}\n                  {now >= minDate && now <= maxDate && (\n                    <line\n                      x1={dateToX(now) - labelWidth}\n                      y1={40}\n                      x2={dateToX(now) - labelWidth}\n                      y2={chartHeight}\n                      className=\"stroke-red-500\"\n                      strokeWidth={2}\n                    />\n                  )}\n\n                  {/* Item bars */}\n                  {items.map((item) => {\n                    const start = item.not_before ? new Date(item.not_before).getTime() : now;\n                    const end = item.not_after ? new Date(item.not_after).getTime() : start + 7 * dayMs;\n                    const x1 = dateToX(start) - labelWidth;\n                    const x2 = dateToX(end) - labelWidth;\n                    const y = itemPositions[item.id]?.y || 0;\n                    const barHeight = 20;\n                    const barY = y + (rowHeight - barHeight) / 2 - 4;\n\n                    return (\n                      <g key={item.id}>\n                        <rect\n                          x={x1}\n                          y={barY}\n                          width={Math.max(4, x2 - x1)}\n                          height={barHeight}\n                          rx={4}\n                          className={`${kindFillColors[item.kind] || 'fill-gray-400'} ${statusBgColors[item.status || 'open'] || ''}`}\n                        />\n                        {item.actual_minutes && item.estimate_minutes && item.estimate_minutes > 0 && (\n                          <rect\n                            x={x1}\n                            y={barY + barHeight - 3}\n                            width={Math.min(1, item.actual_minutes / item.estimate_minutes) * Math.max(4, x2 - x1)}\n                            height={3}\n                            rx={1}\n                            className=\"fill-white/50\"\n                          />\n                        )}\n                      </g>\n                    );\n                  })}\n\n                  {/* Dependency arrows */}\n                  {dependencies.map((dep) => {\n                    const fromItem = items.find((i) => i.id === dep.from_id);\n                    const toItem = items.find((i) => i.id === dep.to_id);\n                    if (!fromItem || !toItem) return null;\n\n                    const fromEnd = fromItem.not_after ? new Date(fromItem.not_after).getTime() : now;\n                    const toStart = toItem.not_before ? new Date(toItem.not_before).getTime() : now;\n\n                    const x1 = dateToX(fromEnd) - labelWidth;\n                    const y1 = (itemPositions[dep.from_id]?.y || 0) + rowHeight / 2;\n                    const x2 = dateToX(toStart) - labelWidth;\n                    const y2 = (itemPositions[dep.to_id]?.y || 0) + rowHeight / 2;\n\n                    return (\n                      <g key={dep.id}>\n                        <path\n                          d={`M ${x1} ${y1} C ${x1 + 20} ${y1}, ${x2 - 20} ${y2}, ${x2} ${y2}`}\n                          fill=\"none\"\n                          className=\"stroke-muted-foreground\"\n                          strokeWidth={1.5}\n                          markerEnd=\"url(#arrowhead)\"\n                        />\n                      </g>\n                    );\n                  })}\n\n                  <defs>\n                    <marker\n                      id=\"arrowhead\"\n                      markerWidth=\"10\"\n                      markerHeight=\"7\"\n                      refX=\"9\"\n                      refY=\"3.5\"\n                      orient=\"auto\"\n                    >\n                      <polygon points=\"0 0, 10 3.5, 0 7\" className=\"fill-muted-foreground\" />\n                    </marker>\n                  </defs>\n                </svg>\n              </div>\n            </div>\n            <ScrollBar orientation=\"horizontal\" />\n          </ScrollArea>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":["ZOOM_CONFIGS","GlobalTimelinePage","zoom","setZoom","useState","kindFilter","setKindFilter","data","isLoading","error","refetch","useGlobalTimeline","handleKindToggle","kind","prev","k","handleZoomIn","levels","idx","handleZoomOut","jsxs","jsx","Skeleton","ErrorState","items","dependencies","Card","CardContent","EmptyState","dates","i","d","now","minDate","maxDate","range","zoomConfig","dayMs","totalDays","chartWidth","rowHeight","labelWidth","chartHeight","dateToX","date","itemPositions","item","statusBgColors","markerInterval","dateMarkers","Button","ScrollArea","kindFillColors","Link","m","start","end","x1","x2","y","barHeight","barY","dep","fromItem","toItem","fromEnd","toStart","y1","y2","ScrollBar"],"mappings":"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"}