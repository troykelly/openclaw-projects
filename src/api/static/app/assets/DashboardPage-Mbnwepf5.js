import{a as _,r as x,j as e,L as j}from"./index-ro4a9Q5M.js";import{u as z}from"./use-work-items-d_fseGMd.js";import{u as D,A as k}from"./use-activity-MnyqfU60.js";import{p as L}from"./work-item-utils-RZsWa1qH.js";import{C as u,d as h,e as p,f,b as g,c,S as n}from"./card-BHiA1sJf.js";import{B as y}from"./button-DA_iHpNz.js";import{B as N}from"./badge-CgqI5a1N.js";import{C as w,a as S}from"./circle-EEWPoZoI.js";import{A as v}from"./arrow-right-CBkgDz4p.js";import{C as b}from"./calendar-CQ44GTMm.js";import{P as I}from"./plus-CQqLjOLW.js";import{S as A}from"./search-DqMWWgfa.js";import{F as T}from"./folder-open-ybL5FUwl.js";import{L as M}from"./loader-circle-NfjsmSiQ.js";import{T as $}from"./triangle-alert-D4miQcuN.js";import"./useQuery-BM5zrqpQ.js";import"./api-client-CDvRtWmo.js";function B(){const s=new Date().getHours();return s<12?"Good morning":s<17?"Good afternoon":"Good evening"}function P(){return new Date().toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}function G(s){switch(s){case"in_progress":return{label:"In Progress",colorClass:"bg-blue-500/10 text-blue-600 dark:text-blue-400"};case"not_started":return{label:"Not Started",colorClass:"bg-gray-500/10 text-gray-600 dark:text-gray-400"};case"blocked":return{label:"Blocked",colorClass:"bg-red-500/10 text-red-600 dark:text-red-400"};case"done":return{label:"Done",colorClass:"bg-green-500/10 text-green-600 dark:text-green-400"};case"cancelled":return{label:"Cancelled",colorClass:"bg-gray-500/10 text-gray-500"};default:return{label:s.replace(/_/g," "),colorClass:"bg-gray-500/10 text-gray-600"}}}function R(s){const a=new Date(s),d=new Date().getTime()-a.getTime(),t=Math.floor(d/6e4),o=Math.floor(t/60),m=Math.floor(o/24);return t<1?"just now":t<60?`${t}m ago`:o<24?`${o}h ago`:m<7?`${m}d ago`:a.toLocaleDateString(void 0,{month:"short",day:"numeric"})}function q(s){switch(s){case"created":return"created";case"updated":return"updated";case"status_change":return"changed status of";case"commented":return"commented on";case"assigned":return"assigned";case"memory_added":return"added memory to";default:return s.replace(/_/g," ")}}function H(s){const a=["in_progress","not_started","blocked"],i=s.filter(t=>t.status!==null&&a.includes(t.status));return[{key:"in_progress",label:"In Progress",icon:e.jsx(M,{className:"size-4"}),colorClass:"text-blue-600 dark:text-blue-400",items:i.filter(t=>t.status==="in_progress")},{key:"not_started",label:"Not Started",icon:e.jsx(S,{className:"size-4"}),colorClass:"text-gray-600 dark:text-gray-400",items:i.filter(t=>t.status==="not_started")},{key:"blocked",label:"Blocked",icon:e.jsx($,{className:"size-4"}),colorClass:"text-red-600 dark:text-red-400",items:i.filter(t=>t.status==="blocked")}].filter(t=>t.items.length>0)}function Q(s,a){return s.status!=="done"&&s.status!=="cancelled"}function W(){return e.jsxs("div",{"data-testid":"page-dashboard",className:"p-6 space-y-8",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{width:300,height:32}),e.jsx(n,{width:200,height:18})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(n,{width:150,height:24}),e.jsx(c,{}),e.jsx(c,{})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(n,{width:150,height:24}),e.jsx(c,{}),e.jsx(c,{})]})]}),e.jsxs("div",{children:[e.jsx(n,{width:180,height:24}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx(n,{width:"100%",height:48}),e.jsx(n,{width:"100%",height:48}),e.jsx(n,{width:"100%",height:48})]})]})]})}function C({item:s}){const a=G(s.status??"not_started"),i=s.priority?L[s.priority]:void 0;return e.jsxs(j,{to:`/work-items/${s.id}`,className:"flex items-center gap-3 rounded-lg border border-border bg-card p-3 transition-colors hover:bg-muted/50 dark:hover:bg-muted/30","data-testid":"work-item-card",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(N,{variant:"secondary",className:`text-xs ${a.colorClass}`,children:a.label}),i&&e.jsx(N,{className:`text-xs ${i}`,children:s.priority}),s.task_type&&e.jsx("span",{className:"text-xs text-muted-foreground capitalize",children:s.task_type})]})]}),e.jsx(v,{className:"size-4 text-muted-foreground shrink-0"})]})}function E({item:s}){return e.jsxs("div",{className:"flex items-start gap-3 py-2",children:[e.jsx("div",{className:"size-2 rounded-full bg-primary mt-2 shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm text-foreground",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s.actor_email??"System"," "]}),e.jsxs("span",{className:"text-muted-foreground",children:[q(s.type)," "]}),e.jsx(j,{to:`/work-items/${s.work_item_id}`,className:"font-medium text-primary hover:underline",children:s.work_item_title})]}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 line-clamp-1",children:s.description})]}),e.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap shrink-0",children:R(s.created_at)})]})}function oe(){const s=_(),a=z(),i=D(10),d=x.useMemo(()=>H(a.data?.items??[]),[a.data]),t=x.useMemo(()=>d.reduce((r,l)=>r+l.items.length,0),[d]),o=x.useMemo(()=>(a.data?.items??[]).filter(l=>Q(l)).slice(0,5),[a.data]),m=x.useMemo(()=>(i.data?.items??[]).slice(0,10),[i.data]);return a.isLoading&&i.isLoading?e.jsx(W,{}):e.jsxs("div",{"data-testid":"page-dashboard",className:"p-6 space-y-8",children:[e.jsxs("div",{"data-testid":"welcome-header",className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl font-semibold text-foreground sm:text-3xl",children:B()}),e.jsx("p",{className:"text-sm text-muted-foreground",children:P()})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(u,{"data-testid":"section-my-tasks",children:[e.jsxs(h,{children:[e.jsxs(p,{className:"flex items-center gap-2 text-base",children:[e.jsx(w,{className:"size-5 text-primary"}),"My Tasks"]}),e.jsx(f,{children:t>0?`${t} active task${t!==1?"s":""}`:"Your assigned tasks"})]}),e.jsx(g,{children:a.isLoading?e.jsxs("div",{className:"space-y-3",children:[e.jsx(c,{}),e.jsx(c,{})]}):d.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(w,{className:"mx-auto size-10 text-muted-foreground/30"}),e.jsx("p",{className:"mt-3 text-sm font-medium text-muted-foreground",children:"No tasks assigned"}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Tasks assigned to you will appear here."})]}):e.jsxs("div",{className:"space-y-4",children:[d.map(r=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:r.colorClass,children:r.icon}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:r.label}),e.jsx(N,{variant:"outline",className:"text-xs",children:r.items.length})]}),e.jsx("div",{className:"space-y-2",children:r.items.slice(0,10).map(l=>e.jsx(C,{item:l},l.id))})]},r.key)),t>0&&e.jsxs(j,{to:"/work-items",className:"flex items-center justify-center gap-1 text-sm text-primary hover:underline py-2",children:["View all tasks",e.jsx(v,{className:"size-3.5"})]})]})})]}),e.jsxs(u,{"data-testid":"section-upcoming-due",children:[e.jsxs(h,{children:[e.jsxs(p,{className:"flex items-center gap-2 text-base",children:[e.jsx(b,{className:"size-5 text-orange-500"}),"Upcoming Due"]}),e.jsx(f,{children:"Items due within 7 days"})]}),e.jsx(g,{children:a.isLoading?e.jsxs("div",{className:"space-y-3",children:[e.jsx(c,{}),e.jsx(c,{})]}):o.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(b,{className:"mx-auto size-10 text-muted-foreground/30"}),e.jsx("p",{className:"mt-3 text-sm font-medium text-muted-foreground",children:"No upcoming deadlines"}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Items with upcoming due dates will appear here."})]}):e.jsx("div",{className:"space-y-2",children:o.map(r=>e.jsx(C,{item:r},r.id))})})]})]}),e.jsxs(u,{"data-testid":"section-recent-activity",children:[e.jsxs(h,{children:[e.jsxs(p,{className:"flex items-center gap-2 text-base",children:[e.jsx(k,{className:"size-5 text-violet-500"}),"Recent Activity"]}),e.jsx(f,{children:"Latest updates across your projects"})]}),e.jsx(g,{children:i.isLoading?e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{width:"100%",height:40}),e.jsx(n,{width:"100%",height:40}),e.jsx(n,{width:"100%",height:40})]}):m.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(k,{className:"mx-auto size-10 text-muted-foreground/30"}),e.jsx("p",{className:"mt-3 text-sm font-medium text-muted-foreground",children:"No recent activity"}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Activity will appear here when work items are created or updated."})]}):e.jsxs("div",{className:"divide-y divide-border",children:[m.map(r=>e.jsx(E,{item:r},r.id)),e.jsx("div",{className:"pt-3",children:e.jsxs(j,{to:"/activity",className:"flex items-center justify-center gap-1 text-sm text-primary hover:underline py-2",children:["View all activity",e.jsx(v,{className:"size-3.5"})]})})]})})]}),e.jsxs(u,{"data-testid":"section-quick-actions",children:[e.jsx(h,{children:e.jsx(p,{className:"flex items-center gap-2 text-base",children:"Quick Actions"})}),e.jsx(g,{children:e.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[e.jsxs(y,{variant:"outline",className:"h-auto flex-col gap-2 py-4",onClick:()=>s("/work-items"),"data-testid":"quick-action-create",children:[e.jsx(I,{className:"size-5 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Create Task"})]}),e.jsxs(y,{variant:"outline",className:"h-auto flex-col gap-2 py-4",onClick:()=>s("/work-items"),"data-testid":"quick-action-search",children:[e.jsx(A,{className:"size-5 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Search"})]}),e.jsxs(y,{variant:"outline",className:"h-auto flex-col gap-2 py-4",onClick:()=>s("/work-items"),"data-testid":"quick-action-projects",children:[e.jsx(T,{className:"size-5 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Open Projects"})]})]})})]})]})}export{oe as DashboardPage};
//# sourceMappingURL=DashboardPage-Mbnwepf5.js.map
