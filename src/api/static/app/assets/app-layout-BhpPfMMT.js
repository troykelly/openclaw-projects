import{r as s,j as e,u as zt,a as Kt,O as Ft}from"./index-8lelR6qN.js";import{c as Je,u as dt,a as M,b as de,B as je}from"./button-CCcTHsAD.js";import{P as Gt,c as ee,a as Ht,b as Wt}from"./index-D1CsxaJp.js";import{R as qt,A as Bt,P as Vt,a as Ut,c as ut,D as Jt,C as Qt}from"./index-CD2rqmPv.js";import{u as Y,a as Yt}from"./index-C8I01OpR.js";import{P as mt}from"./index-BECoGD9f.js";import{R as Xt,S as Oe,a as $e,b as ze,c as Ke,d as ye}from"./select-pnFGNNLb.js";import{S as ft}from"./scroll-area-Cm_wDnln.js";import{C as Zt}from"./chevron-left-Cy3Z-PVr.js";import{P as Qe}from"./plus-CZtrUMzj.js";import{B as Ye}from"./bell-DnBa4S1K.js";import{F as ue}from"./folder-DNBXxC61.js";import{C as pt}from"./calendar-c0kNGWNj.js";import{U as Xe,F as Fe}from"./users-BTXwO7qa.js";import{S as ke}from"./search-Bq9T0uel.js";import{S as Ge,M as er}from"./settings-DixCOPXi.js";import{C as He}from"./chevron-right-Cb-zPlN1.js";import{D as we,a as Ce,b as Ne,c as Se,d as Ee,R as tr,P as rr,O as nr,C as sr,e as ht}from"./dialog-BnAQ6QZP.js";import{S as ar,P as V}from"./separator-Coc4R9ut.js";import{C as or}from"./clock-BQl2mhxC.js";import{B as ir}from"./brain-ZHV8X7Fw.js";import{S as lr,M as cr}from"./sun-DiCKc5Rv.js";import{P as dr,a as ur}from"./panel-left-CpWb8f9D.js";import{U as mr}from"./user-BHANPHrT.js";import{I as We}from"./input-8OCkwTCE.js";import{L as xt}from"./loader-circle-BpYw4fU9.js";import{T as fr}from"./textarea-D3T0Y15y.js";import{a as pr}from"./api-client-CDvRtWmo.js";import{r as hr}from"./work-item-utils-RZsWa1qH.js";import"./index-BdQq_4o_.js";import"./chevron-down-BsatJQ7x.js";const xr=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],gr=Je("hash",xr);const vr=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],br=Je("house",vr);const yr=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],jr=Je("layout-dashboard",yr);var[Te]=Ht("Tooltip",[ut]),Ie=ut(),gt="TooltipProvider",kr=700,qe="tooltip.open",[wr,Ze]=Te(gt),vt=t=>{const{__scopeTooltip:r,delayDuration:n=kr,skipDelayDuration:o=300,disableHoverableContent:a=!1,children:i}=t,l=s.useRef(!0),c=s.useRef(!1),d=s.useRef(0);return s.useEffect(()=>{const m=d.current;return()=>window.clearTimeout(m)},[]),e.jsx(wr,{scope:r,isOpenDelayedRef:l,delayDuration:n,onOpen:s.useCallback(()=>{window.clearTimeout(d.current),l.current=!1},[]),onClose:s.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>l.current=!0,o)},[o]),isPointerInTransitRef:c,onPointerInTransitChange:s.useCallback(m=>{c.current=m},[]),disableHoverableContent:a,children:i})};vt.displayName=gt;var me="Tooltip",[Cr,fe]=Te(me),bt=t=>{const{__scopeTooltip:r,children:n,open:o,defaultOpen:a,onOpenChange:i,disableHoverableContent:l,delayDuration:c}=t,d=Ze(me,t.__scopeTooltip),m=Ie(r),[f,h]=s.useState(null),g=Y(),p=s.useRef(0),y=l??d.disableHoverableContent,E=c??d.delayDuration,b=s.useRef(!1),[C,N]=Yt({prop:o,defaultProp:a??!1,onChange:P=>{P?(d.onOpen(),document.dispatchEvent(new CustomEvent(qe))):d.onClose(),i?.(P)},caller:me}),R=s.useMemo(()=>C?b.current?"delayed-open":"instant-open":"closed",[C]),T=s.useCallback(()=>{window.clearTimeout(p.current),p.current=0,b.current=!1,N(!0)},[N]),k=s.useCallback(()=>{window.clearTimeout(p.current),p.current=0,N(!1)},[N]),S=s.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{b.current=!0,N(!0),p.current=0},E)},[E,N]);return s.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),e.jsx(qt,{...m,children:e.jsx(Cr,{scope:r,contentId:g,open:C,stateAttribute:R,trigger:f,onTriggerChange:h,onTriggerEnter:s.useCallback(()=>{d.isOpenDelayedRef.current?S():T()},[d.isOpenDelayedRef,S,T]),onTriggerLeave:s.useCallback(()=>{y?k():(window.clearTimeout(p.current),p.current=0)},[k,y]),onOpen:T,onClose:k,disableHoverableContent:y,children:n})})};bt.displayName=me;var Be="TooltipTrigger",yt=s.forwardRef((t,r)=>{const{__scopeTooltip:n,...o}=t,a=fe(Be,n),i=Ze(Be,n),l=Ie(n),c=s.useRef(null),d=dt(r,c,a.onTriggerChange),m=s.useRef(!1),f=s.useRef(!1),h=s.useCallback(()=>m.current=!1,[]);return s.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),e.jsx(Bt,{asChild:!0,...l,children:e.jsx(Gt.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...o,ref:d,onPointerMove:ee(t.onPointerMove,g=>{g.pointerType!=="touch"&&!f.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),f.current=!0)}),onPointerLeave:ee(t.onPointerLeave,()=>{a.onTriggerLeave(),f.current=!1}),onPointerDown:ee(t.onPointerDown,()=>{a.open&&a.onClose(),m.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:ee(t.onFocus,()=>{m.current||a.onOpen()}),onBlur:ee(t.onBlur,a.onClose),onClick:ee(t.onClick,a.onClose)})})});yt.displayName=Be;var et="TooltipPortal",[Nr,Sr]=Te(et,{forceMount:void 0}),jt=t=>{const{__scopeTooltip:r,forceMount:n,children:o,container:a}=t,i=fe(et,r);return e.jsx(Nr,{scope:r,forceMount:n,children:e.jsx(mt,{present:n||i.open,children:e.jsx(Vt,{asChild:!0,container:a,children:o})})})};jt.displayName=et;var se="TooltipContent",kt=s.forwardRef((t,r)=>{const n=Sr(se,t.__scopeTooltip),{forceMount:o=n.forceMount,side:a="top",...i}=t,l=fe(se,t.__scopeTooltip);return e.jsx(mt,{present:o||l.open,children:l.disableHoverableContent?e.jsx(wt,{side:a,...i,ref:r}):e.jsx(Er,{side:a,...i,ref:r})})}),Er=s.forwardRef((t,r)=>{const n=fe(se,t.__scopeTooltip),o=Ze(se,t.__scopeTooltip),a=s.useRef(null),i=dt(r,a),[l,c]=s.useState(null),{trigger:d,onClose:m}=n,f=a.current,{onPointerInTransitChange:h}=o,g=s.useCallback(()=>{c(null),h(!1)},[h]),p=s.useCallback((y,E)=>{const b=y.currentTarget,C={x:y.clientX,y:y.clientY},N=Rr(C,b.getBoundingClientRect()),R=Dr(C,N),T=Lr(E.getBoundingClientRect()),k=Ar([...R,...T]);c(k),h(!0)},[h]);return s.useEffect(()=>()=>g(),[g]),s.useEffect(()=>{if(d&&f){const y=b=>p(b,f),E=b=>p(b,d);return d.addEventListener("pointerleave",y),f.addEventListener("pointerleave",E),()=>{d.removeEventListener("pointerleave",y),f.removeEventListener("pointerleave",E)}}},[d,f,p,g]),s.useEffect(()=>{if(l){const y=E=>{const b=E.target,C={x:E.clientX,y:E.clientY},N=d?.contains(b)||f?.contains(b),R=!_r(C,l);N?g():R&&(g(),m())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[d,f,l,m,g]),e.jsx(wt,{...t,ref:i})}),[Tr,Ir]=Te(me,{isInside:!1}),Pr=Wt("TooltipContent"),wt=s.forwardRef((t,r)=>{const{__scopeTooltip:n,children:o,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:l,...c}=t,d=fe(se,n),m=Ie(n),{onClose:f}=d;return s.useEffect(()=>(document.addEventListener(qe,f),()=>document.removeEventListener(qe,f)),[f]),s.useEffect(()=>{if(d.trigger){const h=g=>{g.target?.contains(d.trigger)&&f()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[d.trigger,f]),e.jsx(Jt,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:l,onFocusOutside:h=>h.preventDefault(),onDismiss:f,children:e.jsxs(Qt,{"data-state":d.stateAttribute,...m,...c,ref:r,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(Pr,{children:o}),e.jsx(Tr,{scope:n,isInside:!0,children:e.jsx(Xt,{id:d.contentId,role:"tooltip",children:a||o})})]})})});kt.displayName=se;var Ct="TooltipArrow",Nt=s.forwardRef((t,r)=>{const{__scopeTooltip:n,...o}=t,a=Ie(n);return Ir(Ct,n).isInside?null:e.jsx(Ut,{...a,...o,ref:r})});Nt.displayName=Ct;function Rr(t,r){const n=Math.abs(r.top-t.y),o=Math.abs(r.bottom-t.y),a=Math.abs(r.right-t.x),i=Math.abs(r.left-t.x);switch(Math.min(n,o,a,i)){case i:return"left";case a:return"right";case n:return"top";case o:return"bottom";default:throw new Error("unreachable")}}function Dr(t,r,n=5){const o=[];switch(r){case"top":o.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":o.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":o.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":o.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return o}function Lr(t){const{top:r,right:n,bottom:o,left:a}=t;return[{x:a,y:r},{x:n,y:r},{x:n,y:o},{x:a,y:o}]}function _r(t,r){const{x:n,y:o}=t;let a=!1;for(let i=0,l=r.length-1;i<r.length;l=i++){const c=r[i],d=r[l],m=c.x,f=c.y,h=d.x,g=d.y;f>o!=g>o&&n<(h-m)*(o-f)/(g-f)+m&&(a=!a)}return a}function Ar(t){const r=t.slice();return r.sort((n,o)=>n.x<o.x?-1:n.x>o.x?1:n.y<o.y?-1:n.y>o.y?1:0),Mr(r)}function Mr(t){if(t.length<=1)return t.slice();const r=[];for(let o=0;o<t.length;o++){const a=t[o];for(;r.length>=2;){const i=r[r.length-1],l=r[r.length-2];if((i.x-l.x)*(a.y-l.y)>=(i.y-l.y)*(a.x-l.x))r.pop();else break}r.push(a)}r.pop();const n=[];for(let o=t.length-1;o>=0;o--){const a=t[o];for(;n.length>=2;){const i=n[n.length-1],l=n[n.length-2];if((i.x-l.x)*(a.y-l.y)>=(i.y-l.y)*(a.x-l.x))n.pop();else break}n.push(a)}return n.pop(),r.length===1&&n.length===1&&r[0].x===n[0].x&&r[0].y===n[0].y?r:r.concat(n)}var Or=vt,$r=bt,zr=yt,Kr=jt,Fr=kt,Gr=Nt;function St({delayDuration:t=0,...r}){return e.jsx(Or,{"data-slot":"tooltip-provider",delayDuration:t,...r})}function ge({...t}){return e.jsx(St,{children:e.jsx($r,{"data-slot":"tooltip",...t})})}function ve({...t}){return e.jsx(zr,{"data-slot":"tooltip-trigger",...t})}function be({className:t,sideOffset:r=0,children:n,...o}){return e.jsx(Kr,{children:e.jsxs(Fr,{"data-slot":"tooltip-content",sideOffset:r,className:M("bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",t),...o,children:[n,e.jsx(Gr,{className:"bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}const Hr=[{id:"activity",label:"Activity",icon:Ye},{id:"projects",label:"Projects",icon:ue},{id:"timeline",label:"Timeline",icon:pt},{id:"people",label:"People",icon:Xe}];function Wr({items:t=Hr,activeItem:r="activity",onItemClick:n,onCreateClick:o,collapsed:a=!1,onCollapsedChange:i,className:l}){const c=()=>{i?.(!a)};return e.jsx(St,{delayDuration:0,children:e.jsxs("aside",{"data-testid":"sidebar","data-collapsed":a,className:M("flex h-full flex-col border-r border-border bg-surface z-20 transition-all duration-300 ease-out",a?"w-16":"w-60",l),children:[e.jsxs("div",{className:"flex h-14 items-center px-4",children:[e.jsxs("div",{className:M("flex items-center gap-3",a&&"justify-center w-full"),children:[e.jsx("div",{className:"flex size-8 items-center justify-center rounded-lg bg-gradient-to-br from-primary to-primary/70 shadow-sm",children:e.jsx("span",{className:"text-sm font-bold text-primary-foreground",children:"O"})}),!a&&e.jsx("span",{className:"text-base font-semibold tracking-tight text-foreground",children:"OpenClaw Projects"})]}),!a&&e.jsx("button",{onClick:c,className:"ml-auto flex size-6 items-center justify-center rounded-md text-muted-foreground hover:bg-muted hover:text-foreground transition-colors","aria-label":"Collapse sidebar",children:e.jsx(Zt,{className:"size-4"})})]}),o&&e.jsx("div",{className:"px-3 pt-4",children:e.jsxs(ge,{children:[e.jsx(ve,{asChild:!0,children:e.jsxs("button",{onClick:o,className:M("flex w-full items-center justify-center gap-2 rounded-lg bg-primary px-3 py-2.5 text-sm font-medium text-primary-foreground shadow-sm transition-colors hover:bg-primary/90",a&&"px-0"),"aria-label":"Create new work item",children:[e.jsx(Qe,{className:"size-[18px] shrink-0"}),!a&&e.jsx("span",{children:"Create"})]})}),a&&e.jsxs(be,{side:"right",sideOffset:8,className:"font-medium",children:["Create ",e.jsx("kbd",{className:"ml-1 text-[10px]",children:"N"})]})]})}),e.jsx(ft,{className:"flex-1 px-3 py-4",children:e.jsx("nav",{className:"flex flex-col gap-1",role:"navigation","aria-label":"Main navigation",children:t.map(d=>{const m=d.icon,f=r===d.id,h=e.jsxs("button",{onClick:()=>{d.onClick?.(),n?.(d)},className:M("group flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm font-medium transition-all duration-150",a&&"justify-center px-0",f?"bg-primary/10 text-primary shadow-sm":"text-muted-foreground hover:bg-muted hover:text-foreground"),"aria-current":f?"page":void 0,children:[e.jsx(m,{className:M("size-[18px] shrink-0 transition-transform duration-150",!f&&"group-hover:scale-110")}),!a&&e.jsx("span",{children:d.label})]},d.id);return a?e.jsxs(ge,{children:[e.jsx(ve,{asChild:!0,children:h}),e.jsx(be,{side:"right",sideOffset:8,className:"font-medium",children:d.label})]},d.id):h})})}),e.jsxs("div",{className:"border-t border-border p-3 space-y-1",children:[e.jsxs(ge,{children:[e.jsx(ve,{asChild:!0,children:e.jsxs("button",{className:M("flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",a&&"justify-center px-0"),onClick:()=>n?.({id:"search",label:"Search",icon:ke}),children:[e.jsx(ke,{className:"size-[18px] shrink-0"}),!a&&e.jsxs("span",{className:"flex flex-1 items-center justify-between",children:[e.jsx("span",{children:"Search"}),e.jsx("kbd",{className:"hidden rounded border border-border bg-muted px-1.5 py-0.5 text-[10px] font-medium text-muted-foreground sm:inline-block",children:"⌘K"})]})]})}),a&&e.jsxs(be,{side:"right",sideOffset:8,className:"font-medium",children:["Search ",e.jsx("kbd",{className:"ml-1 text-[10px]",children:"⌘K"})]})]}),e.jsxs(ge,{children:[e.jsx(ve,{asChild:!0,children:e.jsxs("button",{className:M("flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm transition-colors",a&&"justify-center px-0",r==="settings"?"bg-primary/10 text-primary shadow-sm":"text-muted-foreground hover:bg-muted hover:text-foreground"),onClick:()=>n?.({id:"settings",label:"Settings",icon:Ge}),children:[e.jsx(Ge,{className:"size-[18px] shrink-0"}),!a&&e.jsx("span",{children:"Settings"})]})}),a&&e.jsx(be,{side:"right",sideOffset:8,className:"font-medium",children:"Settings"})]}),a&&e.jsx("button",{onClick:c,className:"mt-2 flex w-full items-center justify-center rounded-lg py-2 text-muted-foreground hover:bg-muted hover:text-foreground transition-colors","aria-label":"Expand sidebar",children:e.jsx(He,{className:"size-4"})})]})]})})}const qr=[{id:"activity",label:"Activity",icon:Ye},{id:"projects",label:"Projects",icon:ue},{id:"timeline",label:"Timeline",icon:pt},{id:"people",label:"People",icon:Xe},{id:"search",label:"Search",icon:ke}];function Br({items:t=qr,activeItem:r="activity",onItemClick:n,className:o}){return e.jsx("nav",{"data-testid":"mobile-nav",className:M("fixed inset-x-0 bottom-0 z-50 h-16 items-center justify-around border-t border-border bg-surface","flex md:!hidden",o),style:{display:"var(--mobile-nav-display, flex)"},role:"navigation","aria-label":"Mobile navigation",children:t.map(a=>{const i=a.icon,l=r===a.id;return e.jsxs("button",{type:"button",onClick:()=>{a.onClick?.(),n?.(a)},className:M("flex flex-col items-center justify-center gap-1 px-3 py-2 text-muted-foreground transition-colors hover:text-foreground",l&&"text-primary"),"aria-current":l?"page":void 0,children:[e.jsx(i,{className:"size-5"}),e.jsx("span",{className:"text-[10px] font-medium",children:a.label})]},a.id)})})}function Vr({items:t,showHome:r=!0,onHomeClick:n,className:o}){return e.jsx("nav",{"data-testid":"breadcrumb","aria-label":"Breadcrumb",className:M("flex items-center gap-1 text-sm",o),children:e.jsxs("ol",{className:"flex items-center gap-1",children:[r&&e.jsxs("li",{className:"flex items-center",children:[e.jsx("button",{type:"button",onClick:n,className:"flex items-center text-muted-foreground hover:text-foreground transition-colors","aria-label":"Home",children:e.jsx(br,{className:"size-4"})}),t.length>0&&e.jsx(He,{className:"mx-1 size-4 text-muted-foreground","aria-hidden":"true"})]}),t.map((a,i)=>{const l=i===t.length-1;return e.jsx("li",{className:"flex items-center",children:l?e.jsx("span",{className:"font-medium text-foreground","aria-current":"page",children:a.label}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:a.onClick,className:"text-muted-foreground hover:text-foreground transition-colors",children:a.label}),e.jsx(He,{className:"mx-1 size-4 text-muted-foreground","aria-hidden":"true"})]})},i)})]})})}const Ur=[{title:"Global",shortcuts:[{keys:["⌘","K"],description:"Open command palette"},{keys:["⌘","/"],description:"Show keyboard shortcuts"},{keys:["Esc"],description:"Close modal / cancel"}]},{title:"Navigation",shortcuts:[{keys:["G","A"],description:"Go to Activity"},{keys:["G","P"],description:"Go to Projects"},{keys:["G","T"],description:"Go to Timeline"},{keys:["G","C"],description:"Go to Contacts"},{keys:["G","S"],description:"Go to Settings"}]},{title:"Lists",shortcuts:[{keys:["J"],description:"Move down"},{keys:["K"],description:"Move up"},{keys:["Enter"],description:"Open selected item"},{keys:["⌫"],description:"Go back / up hierarchy"}]},{title:"Actions",shortcuts:[{keys:["N"],description:"New item"},{keys:["E"],description:"Edit current item"},{keys:["S"],description:"Change status"},{keys:["Space"],description:"Toggle selection"}]}];function Re({children:t}){return e.jsx("kbd",{className:"inline-flex h-5 min-w-5 items-center justify-center rounded border border-border bg-muted px-1.5 font-mono text-xs font-medium text-muted-foreground",children:t})}function Jr(){const[t,r]=s.useState(!1),n=s.useCallback(o=>{const a=o.target;a.tagName==="INPUT"||a.tagName==="TEXTAREA"||a.isContentEditable||((o.metaKey||o.ctrlKey)&&o.key==="/"&&(o.preventDefault(),r(i=>!i)),o.key==="?"&&!o.metaKey&&!o.ctrlKey&&!o.altKey&&(o.preventDefault(),r(!0)))},[]);return s.useEffect(()=>(document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)),[n]),e.jsx(we,{open:t,onOpenChange:r,children:e.jsxs(Ce,{className:"sm:max-w-lg",children:[e.jsxs(Ne,{children:[e.jsx(Se,{children:"Keyboard Shortcuts"}),e.jsxs(Ee,{children:["Navigate and act faster with these shortcuts. Press"," ",e.jsx(Re,{children:"⌘"})," ",e.jsx(Re,{children:"/"})," to toggle this help."]})]}),e.jsx(ft,{className:"max-h-[60vh]",children:e.jsx("div",{className:"space-y-6 pr-4",children:Ur.map((o,a)=>e.jsxs("div",{children:[a>0&&e.jsx(ar,{className:"mb-4"}),e.jsx("h3",{className:"mb-3 text-sm font-medium text-foreground",children:o.title}),e.jsx("div",{className:"space-y-2",children:o.shortcuts.map(i=>e.jsxs("div",{className:"flex items-center justify-between py-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:i.description}),e.jsx("div",{className:"flex items-center gap-1",children:i.keys.map((l,c)=>e.jsxs(s.Fragment,{children:[e.jsx(Re,{children:l}),c<i.keys.length-1&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"+"})]},c))})]},i.description))})]},o.title))})}),e.jsx("div",{className:"text-center text-xs text-muted-foreground",children:e.jsx("span",{className:"opacity-75",children:"Shortcuts are disabled when typing in text fields"})})]})})}const rt="sidebar-collapsed";function Qr({children:t,activeSection:r="activity",onSectionChange:n,onCreateClick:o,breadcrumbs:a=[],onBreadcrumbClick:i,onHomeClick:l,header:c,className:d}){const[m,f]=s.useState(()=>typeof window>"u"?!1:localStorage.getItem(rt)==="true"),h=s.useCallback(p=>{f(p),localStorage.setItem(rt,String(p))},[]),g=s.useCallback(p=>{n?.(p.id)},[n]);return s.useEffect(()=>{const p=y=>{(y.metaKey||y.ctrlKey)&&y.key==="k"&&(y.preventDefault(),n?.("search"))};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[n]),e.jsxs("div",{"data-testid":"app-shell",className:M("flex h-screen bg-background",d),children:[e.jsx("div",{className:"hidden md:block",children:e.jsx(Wr,{activeItem:r,onItemClick:g,onCreateClick:o,collapsed:m,onCollapsedChange:h})}),e.jsxs("main",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsxs("header",{className:"sticky top-0 z-10 flex h-14 shrink-0 items-center gap-4 border-b border-border bg-surface px-4",children:[a.length>0&&e.jsx(Vr,{items:a,onHomeClick:l}),c&&e.jsx("div",{className:"ml-auto flex items-center gap-2",children:c})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 pb-20 md:p-6 md:pb-0",children:t})]}),e.jsx(Br,{activeItem:r,onItemClick:g}),e.jsx(Jr,{})]})}var nt=1,Yr=.9,Xr=.8,Zr=.17,De=.1,Le=.999,en=.9999,tn=.99,rn=/[\\\/_+.#"@\[\(\{&]/,nn=/[\\\/_+.#"@\[\(\{&]/g,sn=/[\s-]/,Et=/[\s-]/g;function Ve(t,r,n,o,a,i,l){if(i===r.length)return a===t.length?nt:tn;var c=`${a},${i}`;if(l[c]!==void 0)return l[c];for(var d=o.charAt(i),m=n.indexOf(d,a),f=0,h,g,p,y;m>=0;)h=Ve(t,r,n,o,m+1,i+1,l),h>f&&(m===a?h*=nt:rn.test(t.charAt(m-1))?(h*=Xr,p=t.slice(a,m-1).match(nn),p&&a>0&&(h*=Math.pow(Le,p.length))):sn.test(t.charAt(m-1))?(h*=Yr,y=t.slice(a,m-1).match(Et),y&&a>0&&(h*=Math.pow(Le,y.length))):(h*=Zr,a>0&&(h*=Math.pow(Le,m-a))),t.charAt(m)!==r.charAt(i)&&(h*=en)),(h<De&&n.charAt(m-1)===o.charAt(i+1)||o.charAt(i+1)===o.charAt(i)&&n.charAt(m-1)!==o.charAt(i))&&(g=Ve(t,r,n,o,m+1,i+2,l),g*De>h&&(h=g*De)),h>f&&(f=h),m=n.indexOf(d,m+1);return l[c]=f,f}function st(t){return t.toLowerCase().replace(Et," ")}function an(t,r,n){return t=n&&n.length>0?`${t+" "+n.join(" ")}`:t,Ve(t,r,st(t),st(r),0,0,{})}var oe='[cmdk-group=""]',_e='[cmdk-group-items=""]',on='[cmdk-group-heading=""]',Tt='[cmdk-item=""]',at=`${Tt}:not([aria-disabled="true"])`,Ue="cmdk-item-select",re="data-value",ln=(t,r,n)=>an(t,r,n),It=s.createContext(void 0),pe=()=>s.useContext(It),Pt=s.createContext(void 0),tt=()=>s.useContext(Pt),Rt=s.createContext(void 0),Dt=s.forwardRef((t,r)=>{let n=ne(()=>{var u,j;return{search:"",value:(j=(u=t.value)!=null?u:t.defaultValue)!=null?j:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),o=ne(()=>new Set),a=ne(()=>new Map),i=ne(()=>new Map),l=ne(()=>new Set),c=Lt(t),{label:d,children:m,value:f,onValueChange:h,filter:g,shouldFilter:p,loop:y,disablePointerSelection:E=!1,vimBindings:b=!0,...C}=t,N=Y(),R=Y(),T=Y(),k=s.useRef(null),S=bn();X(()=>{if(f!==void 0){let u=f.trim();n.current.value=u,P.emit()}},[f]),X(()=>{S(6,O)},[]);let P=s.useMemo(()=>({subscribe:u=>(l.current.add(u),()=>l.current.delete(u)),snapshot:()=>n.current,setState:(u,j,I)=>{var v,D,_,K;if(!Object.is(n.current[u],j)){if(n.current[u]=j,u==="search")A(),q(),S(1,x);else if(u==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let $=document.getElementById(T);$?$.focus():(v=document.getElementById(N))==null||v.focus()}if(S(7,()=>{var $;n.current.selectedItemId=($=B())==null?void 0:$.id,P.emit()}),I||S(5,O),((D=c.current)==null?void 0:D.value)!==void 0){let $=j??"";(K=(_=c.current).onValueChange)==null||K.call(_,$);return}}P.emit()}},emit:()=>{l.current.forEach(u=>u())}}),[]),W=s.useMemo(()=>({value:(u,j,I)=>{var v;j!==((v=i.current.get(u))==null?void 0:v.value)&&(i.current.set(u,{value:j,keywords:I}),n.current.filtered.items.set(u,G(j,I)),S(2,()=>{q(),P.emit()}))},item:(u,j)=>(o.current.add(u),j&&(a.current.has(j)?a.current.get(j).add(u):a.current.set(j,new Set([u]))),S(3,()=>{A(),q(),n.current.value||x(),P.emit()}),()=>{i.current.delete(u),o.current.delete(u),n.current.filtered.items.delete(u);let I=B();S(4,()=>{A(),I?.getAttribute("id")===u&&x(),P.emit()})}),group:u=>(a.current.has(u)||a.current.set(u,new Set),()=>{i.current.delete(u),a.current.delete(u)}),filter:()=>c.current.shouldFilter,label:d||t["aria-label"],getDisablePointerSelection:()=>c.current.disablePointerSelection,listId:N,inputId:T,labelId:R,listInnerRef:k}),[]);function G(u,j){var I,v;let D=(v=(I=c.current)==null?void 0:I.filter)!=null?v:ln;return u?D(u,n.current.search,j):0}function q(){if(!n.current.search||c.current.shouldFilter===!1)return;let u=n.current.filtered.items,j=[];n.current.filtered.groups.forEach(v=>{let D=a.current.get(v),_=0;D.forEach(K=>{let $=u.get(K);_=Math.max($,_)}),j.push([v,_])});let I=k.current;J().sort((v,D)=>{var _,K;let $=v.getAttribute("id"),xe=D.getAttribute("id");return((_=u.get(xe))!=null?_:0)-((K=u.get($))!=null?K:0)}).forEach(v=>{let D=v.closest(_e);D?D.appendChild(v.parentElement===D?v:v.closest(`${_e} > *`)):I.appendChild(v.parentElement===I?v:v.closest(`${_e} > *`))}),j.sort((v,D)=>D[1]-v[1]).forEach(v=>{var D;let _=(D=k.current)==null?void 0:D.querySelector(`${oe}[${re}="${encodeURIComponent(v[0])}"]`);_?.parentElement.appendChild(_)})}function x(){let u=J().find(I=>I.getAttribute("aria-disabled")!=="true"),j=u?.getAttribute(re);P.setState("value",j||void 0)}function A(){var u,j,I,v;if(!n.current.search||c.current.shouldFilter===!1){n.current.filtered.count=o.current.size;return}n.current.filtered.groups=new Set;let D=0;for(let _ of o.current){let K=(j=(u=i.current.get(_))==null?void 0:u.value)!=null?j:"",$=(v=(I=i.current.get(_))==null?void 0:I.keywords)!=null?v:[],xe=G(K,$);n.current.filtered.items.set(_,xe),xe>0&&D++}for(let[_,K]of a.current)for(let $ of K)if(n.current.filtered.items.get($)>0){n.current.filtered.groups.add(_);break}n.current.filtered.count=D}function O(){var u,j,I;let v=B();v&&(((u=v.parentElement)==null?void 0:u.firstChild)===v&&((I=(j=v.closest(oe))==null?void 0:j.querySelector(on))==null||I.scrollIntoView({block:"nearest"})),v.scrollIntoView({block:"nearest"}))}function B(){var u;return(u=k.current)==null?void 0:u.querySelector(`${Tt}[aria-selected="true"]`)}function J(){var u;return Array.from(((u=k.current)==null?void 0:u.querySelectorAll(at))||[])}function ae(u){let j=J()[u];j&&P.setState("value",j.getAttribute(re))}function w(u){var j;let I=B(),v=J(),D=v.findIndex(K=>K===I),_=v[D+u];(j=c.current)!=null&&j.loop&&(_=D+u<0?v[v.length-1]:D+u===v.length?v[0]:v[D+u]),_&&P.setState("value",_.getAttribute(re))}function L(u){let j=B(),I=j?.closest(oe),v;for(;I&&!v;)I=u>0?gn(I,oe):vn(I,oe),v=I?.querySelector(at);v?P.setState("value",v.getAttribute(re)):w(u)}let z=()=>ae(J().length-1),Q=u=>{u.preventDefault(),u.metaKey?z():u.altKey?L(1):w(1)},he=u=>{u.preventDefault(),u.metaKey?ae(0):u.altKey?L(-1):w(-1)};return s.createElement(V.div,{ref:r,tabIndex:-1,...C,"cmdk-root":"",onKeyDown:u=>{var j;(j=C.onKeyDown)==null||j.call(C,u);let I=u.nativeEvent.isComposing||u.keyCode===229;if(!(u.defaultPrevented||I))switch(u.key){case"n":case"j":{b&&u.ctrlKey&&Q(u);break}case"ArrowDown":{Q(u);break}case"p":case"k":{b&&u.ctrlKey&&he(u);break}case"ArrowUp":{he(u);break}case"Home":{u.preventDefault(),ae(0);break}case"End":{u.preventDefault(),z();break}case"Enter":{u.preventDefault();let v=B();if(v){let D=new Event(Ue);v.dispatchEvent(D)}}}}},s.createElement("label",{"cmdk-label":"",htmlFor:W.inputId,id:W.labelId,style:jn},d),Pe(t,u=>s.createElement(Pt.Provider,{value:P},s.createElement(It.Provider,{value:W},u))))}),cn=s.forwardRef((t,r)=>{var n,o;let a=Y(),i=s.useRef(null),l=s.useContext(Rt),c=pe(),d=Lt(t),m=(o=(n=d.current)==null?void 0:n.forceMount)!=null?o:l?.forceMount;X(()=>{if(!m)return c.item(a,l?.id)},[m]);let f=_t(a,i,[t.value,t.children,i],t.keywords),h=tt(),g=U(S=>S.value&&S.value===f.current),p=U(S=>m||c.filter()===!1?!0:S.search?S.filtered.items.get(a)>0:!0);s.useEffect(()=>{let S=i.current;if(!(!S||t.disabled))return S.addEventListener(Ue,y),()=>S.removeEventListener(Ue,y)},[p,t.onSelect,t.disabled]);function y(){var S,P;E(),(P=(S=d.current).onSelect)==null||P.call(S,f.current)}function E(){h.setState("value",f.current,!0)}if(!p)return null;let{disabled:b,value:C,onSelect:N,forceMount:R,keywords:T,...k}=t;return s.createElement(V.div,{ref:de(i,r),...k,id:a,"cmdk-item":"",role:"option","aria-disabled":!!b,"aria-selected":!!g,"data-disabled":!!b,"data-selected":!!g,onPointerMove:b||c.getDisablePointerSelection()?void 0:E,onClick:b?void 0:y},t.children)}),dn=s.forwardRef((t,r)=>{let{heading:n,children:o,forceMount:a,...i}=t,l=Y(),c=s.useRef(null),d=s.useRef(null),m=Y(),f=pe(),h=U(p=>a||f.filter()===!1?!0:p.search?p.filtered.groups.has(l):!0);X(()=>f.group(l),[]),_t(l,c,[t.value,t.heading,d]);let g=s.useMemo(()=>({id:l,forceMount:a}),[a]);return s.createElement(V.div,{ref:de(c,r),...i,"cmdk-group":"",role:"presentation",hidden:h?void 0:!0},n&&s.createElement("div",{ref:d,"cmdk-group-heading":"","aria-hidden":!0,id:m},n),Pe(t,p=>s.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?m:void 0},s.createElement(Rt.Provider,{value:g},p))))}),un=s.forwardRef((t,r)=>{let{alwaysRender:n,...o}=t,a=s.useRef(null),i=U(l=>!l.search);return!n&&!i?null:s.createElement(V.div,{ref:de(a,r),...o,"cmdk-separator":"",role:"separator"})}),mn=s.forwardRef((t,r)=>{let{onValueChange:n,...o}=t,a=t.value!=null,i=tt(),l=U(m=>m.search),c=U(m=>m.selectedItemId),d=pe();return s.useEffect(()=>{t.value!=null&&i.setState("search",t.value)},[t.value]),s.createElement(V.input,{ref:r,...o,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":d.listId,"aria-labelledby":d.labelId,"aria-activedescendant":c,id:d.inputId,type:"text",value:a?t.value:l,onChange:m=>{a||i.setState("search",m.target.value),n?.(m.target.value)}})}),fn=s.forwardRef((t,r)=>{let{children:n,label:o="Suggestions",...a}=t,i=s.useRef(null),l=s.useRef(null),c=U(m=>m.selectedItemId),d=pe();return s.useEffect(()=>{if(l.current&&i.current){let m=l.current,f=i.current,h,g=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let p=m.offsetHeight;f.style.setProperty("--cmdk-list-height",p.toFixed(1)+"px")})});return g.observe(m),()=>{cancelAnimationFrame(h),g.unobserve(m)}}},[]),s.createElement(V.div,{ref:de(i,r),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":c,"aria-label":o,id:d.listId},Pe(t,m=>s.createElement("div",{ref:de(l,d.listInnerRef),"cmdk-list-sizer":""},m)))}),pn=s.forwardRef((t,r)=>{let{open:n,onOpenChange:o,overlayClassName:a,contentClassName:i,container:l,...c}=t;return s.createElement(tr,{open:n,onOpenChange:o},s.createElement(rr,{container:l},s.createElement(nr,{"cmdk-overlay":"",className:a}),s.createElement(sr,{"aria-label":t.label,"cmdk-dialog":"",className:i},s.createElement(Dt,{ref:r,...c}))))}),hn=s.forwardRef((t,r)=>U(n=>n.filtered.count===0)?s.createElement(V.div,{ref:r,...t,"cmdk-empty":"",role:"presentation"}):null),xn=s.forwardRef((t,r)=>{let{progress:n,children:o,label:a="Loading...",...i}=t;return s.createElement(V.div,{ref:r,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},Pe(t,l=>s.createElement("div",{"aria-hidden":!0},l)))}),Z=Object.assign(Dt,{List:fn,Item:cn,Input:mn,Group:dn,Separator:un,Dialog:pn,Empty:hn,Loading:xn});function gn(t,r){let n=t.nextElementSibling;for(;n;){if(n.matches(r))return n;n=n.nextElementSibling}}function vn(t,r){let n=t.previousElementSibling;for(;n;){if(n.matches(r))return n;n=n.previousElementSibling}}function Lt(t){let r=s.useRef(t);return X(()=>{r.current=t}),r}var X=typeof window>"u"?s.useEffect:s.useLayoutEffect;function ne(t){let r=s.useRef();return r.current===void 0&&(r.current=t()),r}function U(t){let r=tt(),n=()=>t(r.snapshot());return s.useSyncExternalStore(r.subscribe,n,n)}function _t(t,r,n,o=[]){let a=s.useRef(),i=pe();return X(()=>{var l;let c=(()=>{var m;for(let f of n){if(typeof f=="string")return f.trim();if(typeof f=="object"&&"current"in f)return f.current?(m=f.current.textContent)==null?void 0:m.trim():a.current}})(),d=o.map(m=>m.trim());i.value(t,c,d),(l=r.current)==null||l.setAttribute(re,c),a.current=c}),a}var bn=()=>{let[t,r]=s.useState(),n=ne(()=>new Map);return X(()=>{n.current.forEach(o=>o()),n.current=new Map},[t]),(o,a)=>{n.current.set(o,a),r({})}};function yn(t){let r=t.type;return typeof r=="function"?r(t.props):"render"in r?r.render(t.props):t}function Pe({asChild:t,children:r},n){return t&&s.isValidElement(r)?s.cloneElement(yn(r),{ref:r.ref},n(r.props.children)):n(r)}var jn={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function kn({className:t,...r}){return e.jsx(Z,{"data-slot":"command",className:M("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",t),...r})}function wn({title:t="Command Palette",description:r="Search for a command to run...",children:n,className:o,showCloseButton:a=!0,shouldFilter:i,...l}){return e.jsxs(we,{...l,children:[e.jsxs(Ne,{className:"sr-only",children:[e.jsx(Se,{children:t}),e.jsx(Ee,{children:r})]}),e.jsx(Ce,{className:M("overflow-hidden p-0",o),showCloseButton:a,children:e.jsx(kn,{shouldFilter:i,className:"[&_[cmdk-group-heading]]:text-muted-foreground **:data-[slot=command-input-wrapper]:h-12 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group]]:px-2 [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:n})})]})}function Cn({className:t,...r}){return e.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[e.jsx(ke,{className:"size-4 shrink-0 opacity-50"}),e.jsx(Z.Input,{"data-slot":"command-input",className:M("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",t),...r})]})}function Nn({className:t,...r}){return e.jsx(Z.List,{"data-slot":"command-list",className:M("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",t),...r})}function Sn({...t}){return e.jsx(Z.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...t})}function ie({className:t,...r}){return e.jsx(Z.Group,{"data-slot":"command-group",className:M("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",t),...r})}function Ae({className:t,...r}){return e.jsx(Z.Separator,{"data-slot":"command-separator",className:M("bg-border -mx-1 h-px",t),...r})}function F({className:t,...r}){return e.jsx(Z.Item,{"data-slot":"command-item",className:M("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...r})}function En({className:t,...r}){return e.jsx("span",{"data-slot":"command-shortcut",className:M("text-muted-foreground ml-auto text-xs tracking-widest",t),...r})}const ot="command-palette-recent",Tn=5;function it(t){switch(t){case"project":return e.jsx(ue,{className:"size-4"});case"issue":return e.jsx(Fe,{className:"size-4"});case"contact":return e.jsx(mr,{className:"size-4"});case"epic":return e.jsx(gr,{className:"size-4"});case"initiative":return e.jsx(ue,{className:"size-4"});default:return e.jsx(Fe,{className:"size-4"})}}function In({open:t,onOpenChange:r,onSearch:n,onSelect:o,onNavigate:a,onToggleTheme:i,onToggleSidebar:l,onCreateTask:c,isDark:d=!1,sidebarCollapsed:m=!1,recentItems:f}){const[h,g]=s.useState(t??!1),[p,y]=s.useState(""),[E,b]=s.useState([]),[C,N]=s.useState(!1),[R,T]=s.useState(()=>{if(f)return f;if(typeof window>"u")return[];try{const x=localStorage.getItem(ot);return x?JSON.parse(x):[]}catch{return[]}});s.useEffect(()=>{t!==void 0&&g(t)},[t]),s.useEffect(()=>{const x=A=>{(A.metaKey||A.ctrlKey)&&A.key==="k"&&(A.preventDefault(),g(O=>!O))};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[]),s.useEffect(()=>{if(!p.trim()||!n){b([]);return}const x=setTimeout(async()=>{N(!0);try{const A=await n(p);b(A)}catch(A){console.error("Search failed:",A),b([])}finally{N(!1)}},200);return()=>clearTimeout(x)},[p,n]);const k=s.useCallback(x=>{g(x),r?.(x),x||(y(""),b([]))},[r]),S=s.useCallback(x=>{const A=[{id:x.id,type:x.type,title:x.title,timestamp:new Date},...R.filter(O=>O.id!==x.id)].slice(0,Tn);T(A),typeof window<"u"&&localStorage.setItem(ot,JSON.stringify(A)),o?.(x),k(!1)},[R,o,k]),P=s.useCallback(x=>{a?.(x),k(!1)},[a,k]),W=s.useCallback(x=>{if(x==="toggle-theme"){i?.(),k(!1);return}if(x==="toggle-sidebar"){l?.(),k(!1);return}if(x==="create-task"){c?.(),k(!1);return}o?.(x),k(!1)},[o,i,l,c,k]),{typeFilter:G}=s.useMemo(()=>{const x=p.match(/^(@|#|!)(\S*)\s*(.*)/);if(x){const[,A]=x;let O;return A==="@"?O="contact":A==="#"?O="project":A==="!"&&(O="issue"),{filteredQuery:x[3]||"",typeFilter:O}}return{filteredQuery:p,typeFilter:void 0}},[p]),q=G?E.filter(x=>x.type===G):E;return e.jsxs(wn,{open:h,onOpenChange:k,title:"Command Palette",description:"Search for commands, projects, issues, or contacts",shouldFilter:!1,children:[e.jsx(Cn,{placeholder:"Type a command or search...",value:p,onValueChange:y,"data-testid":"command-palette-input"}),e.jsxs(Nn,{children:[e.jsx(Sn,{children:C?"Searching...":"No results found."}),q.length>0&&e.jsx(ie,{heading:G?`${G}s`:"Search Results",children:q.map(x=>e.jsxs(F,{value:`${x.type}-${x.id}-${x.title}`,onSelect:()=>S(x),children:[it(x.type),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:x.title}),x.subtitle&&e.jsx("span",{className:"text-xs text-muted-foreground",children:x.subtitle})]})]},`${x.type}-${x.id}`))}),!p&&R.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ie,{heading:"Recent",children:R.map(x=>e.jsxs(F,{value:`recent-${x.type}-${x.id}-${x.title}`,onSelect:()=>S(x),children:[e.jsx(or,{className:"size-4 text-muted-foreground"}),it(x.type),e.jsx("span",{children:x.title})]},`recent-${x.type}-${x.id}`))}),e.jsx(Ae,{})]}),!p&&e.jsx(e.Fragment,{children:e.jsxs(ie,{heading:"Navigate",children:[e.jsxs(F,{value:"go-to-dashboard",onSelect:()=>P("dashboard"),children:[e.jsx(jr,{className:"size-4"}),e.jsx("span",{children:"Go to Dashboard"})]}),e.jsxs(F,{value:"go-to-projects",onSelect:()=>P("projects"),children:[e.jsx(ue,{className:"size-4"}),e.jsx("span",{children:"Go to Projects"})]}),e.jsxs(F,{value:"go-to-activity",onSelect:()=>P("activity"),children:[e.jsx(Ye,{className:"size-4"}),e.jsx("span",{children:"Go to Activity"})]}),e.jsxs(F,{value:"go-to-contacts",onSelect:()=>P("people"),children:[e.jsx(Xe,{className:"size-4"}),e.jsx("span",{children:"Go to Contacts"})]}),e.jsxs(F,{value:"go-to-memory",onSelect:()=>P("memory"),children:[e.jsx(ir,{className:"size-4"}),e.jsx("span",{children:"Go to Memory"})]}),e.jsxs(F,{value:"go-to-communications",onSelect:()=>P("communications"),children:[e.jsx(er,{className:"size-4"}),e.jsx("span",{children:"Go to Communications"})]}),e.jsxs(F,{value:"go-to-settings",onSelect:()=>P("settings"),children:[e.jsx(Ge,{className:"size-4"}),e.jsx("span",{children:"Go to Settings"})]})]})}),!p&&e.jsxs(e.Fragment,{children:[e.jsx(Ae,{}),e.jsxs(ie,{heading:"Actions",children:[e.jsxs(F,{value:"create-task",onSelect:()=>W("create-task"),children:[e.jsx(Qe,{className:"size-4"}),e.jsx("span",{children:"Create task"}),e.jsx(En,{children:"N"})]}),e.jsxs(F,{value:"toggle-theme",onSelect:()=>W("toggle-theme"),children:[d?e.jsx(lr,{className:"size-4"}):e.jsx(cr,{className:"size-4"}),e.jsx("span",{children:"Toggle theme"})]}),e.jsxs(F,{value:"toggle-sidebar",onSelect:()=>W("toggle-sidebar"),children:[m?e.jsx(dr,{className:"size-4"}):e.jsx(ur,{className:"size-4"}),e.jsx("span",{children:"Toggle sidebar"})]})]})]}),!p&&e.jsxs(e.Fragment,{children:[e.jsx(Ae,{}),e.jsx(ie,{heading:"Search Tips",children:e.jsx(F,{disabled:!0,children:e.jsxs("span",{className:"text-muted-foreground",children:[e.jsx("kbd",{className:"rounded border bg-muted px-1 text-xs",children:"@"})," contacts",e.jsx("kbd",{className:"ml-2 rounded border bg-muted px-1 text-xs",children:"#"})," projects",e.jsx("kbd",{className:"ml-2 rounded border bg-muted px-1 text-xs",children:"!"})," issues"]})})})]})]})]})}const Pn=s.createContext(null);function At(){const t=s.useContext(Pn);return t||{isEnabled:!0,setEnabled:()=>{}}}function Mt(t){if(!t||!(t instanceof HTMLElement))return!1;const r=t.tagName.toLowerCase();return r==="input"||r==="textarea"||r==="select"||t.isContentEditable}function Rn(t){const r=t.toLowerCase().split("+");return{key:r[r.length-1],ctrl:r.includes("ctrl"),meta:r.includes("meta")||r.includes("cmd"),alt:r.includes("alt"),shift:r.includes("shift")}}function lt(t){const r={escape:"escape",esc:"escape",enter:"enter",return:"enter",space:" ",backspace:"backspace",delete:"delete",arrowup:"arrowup",arrowdown:"arrowdown",arrowleft:"arrowleft",arrowright:"arrowright"},n=t.toLowerCase();return r[n]||n}function Dn(t,r){const n=lt(t.key),o=lt(r.key),a=n===o,i=r.ctrl===t.ctrlKey,l=r.meta===t.metaKey,c=r.alt===t.altKey,d=!r.shift||r.shift===t.shiftKey;return a&&i&&l&&c&&d}function H(t,r,n={}){const{isEnabled:o}=At(),{enabled:a=!0}=n,i=s.useRef(r);i.current=r;const l=Rn(t),c=s.useCallback(d=>{!a||!o||Mt(d.target)||Dn(d,l)&&(d.preventDefault(),i.current(d))},[a,o,l.key,l.ctrl,l.meta,l.alt,l.shift]);s.useEffect(()=>(document.addEventListener("keydown",c),()=>document.removeEventListener("keydown",c)),[c])}function le(t,r,n={}){const{isEnabled:o}=At(),{timeout:a=1e3,enabled:i=!0}=n,l=s.useRef(r);l.current=r;const c=s.useRef([]),d=s.useRef(null),m=s.useCallback(()=>{c.current=[],d.current&&(clearTimeout(d.current),d.current=null)},[]),f=s.useCallback(h=>{if(!i||!o||Mt(h.target))return;const g=h.key.toLowerCase();d.current&&clearTimeout(d.current),c.current.push(g);const p=c.current,y=t.map(b=>b.toLowerCase());let E=!0;for(let b=0;b<p.length;b++)if(p[b]!==y[b]){E=!1;break}if(E&&p.length===y.length){h.preventDefault(),m(),l.current(h);return}if(!E)if(g===y[0])c.current=[g];else{m();return}d.current=setTimeout(m,a)},[i,o,t,a,m]);s.useEffect(()=>(document.addEventListener("keydown",f),()=>{document.removeEventListener("keydown",f),m()}),[f,m])}function Ln({onNavigate:t,onSearch:r,onNewItem:n,onNewItemFullForm:o,onEdit:a,onDelete:i,onChangeStatus:l,onMoveUp:c,onMoveDown:d,onSelect:m,onBack:f,onOpenSelected:h}){const g=s.useCallback(()=>t?.("activity"),[t]),p=s.useCallback(()=>t?.("projects"),[t]),y=s.useCallback(()=>t?.("timeline"),[t]),E=s.useCallback(()=>t?.("people"),[t]),b=s.useCallback(()=>t?.("settings"),[t]);return le(["g","a"],g),le(["g","p"],p),le(["g","t"],y),le(["g","c"],E),le(["g","s"],b),H("meta+k",()=>r?.()),H("ctrl+k",()=>r?.()),H("j",()=>d?.()),H("k",()=>c?.()),H("enter",()=>h?.()),H("backspace",()=>f?.()),H("n",()=>n?.()),H("shift+n",()=>o?.()),H("e",()=>a?.()),H("d",()=>i?.()),H("s",()=>l?.()),H(" ",()=>m?.()),null}const _n={project:"Project",initiative:"Initiative",epic:"Epic",issue:"Issue"};function An({open:t,onOpenChange:r,onCreated:n,defaultParentId:o,defaultKind:a="issue"}){const[i,l]=s.useState(""),[c,d]=s.useState(a),[m,f]=s.useState(!1),[h,g]=s.useState(null),p=s.useCallback(()=>{l(""),d(a),g(null)},[a]),y=s.useCallback(async()=>{if(m)return;f(!0),g(null);const C={title:i.trim(),kind:c,parentId:o??null};try{const N=await fetch("/api/work-items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)});if(!N.ok){const k=(await N.json().catch(()=>({}))).error??`Failed to create work item (${N.status})`;g(k),f(!1);return}const R=await N.json();n?.(R),p(),r(!1)}catch(N){g(N instanceof Error?N.message:"Network error")}finally{f(!1)}},[i,c,o,m,n,r,p]),E=s.useCallback(C=>{C.key==="Enter"&&!C.shiftKey&&(C.preventDefault(),y()),C.key==="Escape"&&r(!1)},[y,r]),b=s.useCallback(C=>{C||p(),r(C)},[r,p]);return e.jsx(we,{open:t,onOpenChange:b,children:e.jsxs(Ce,{className:"sm:max-w-md",children:[e.jsxs(Ne,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"size-5"}),"Quick Add"]}),e.jsx(Ee,{children:"Create a new work item quickly."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Oe,{value:c,onValueChange:C=>d(C),children:[e.jsx($e,{className:"w-[140px]","aria-label":"Kind",children:e.jsx(ze,{placeholder:"Kind"})}),e.jsx(Ke,{children:Object.entries(_n).map(([C,N])=>e.jsx(ye,{value:C,children:N},C))})]}),e.jsx(We,{placeholder:"Title...",value:i,onChange:C=>l(C.target.value),onKeyDown:E,className:"flex-1",autoFocus:!0})]}),h&&e.jsx("p",{className:"text-sm text-destructive",role:"alert",children:h})]}),e.jsxs(ht,{children:[e.jsx(je,{variant:"outline",onClick:()=>b(!1),disabled:m,children:"Cancel"}),e.jsx(je,{onClick:y,disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(xt,{className:"mr-2 size-4 animate-spin"}),"Creating..."]}):"Create"})]})]})})}var Mn="Label",Ot=s.forwardRef((t,r)=>e.jsx(V.label,{...t,ref:r,onMouseDown:n=>{n.target.closest("button, input, select, textarea")||(t.onMouseDown?.(n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));Ot.displayName=Mn;var On=Ot;function ce({className:t,...r}){return e.jsx(On,{"data-slot":"label",className:M("flex items-center gap-2 text-sm font-medium leading-none select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...r})}const te={project:"Project",initiative:"Initiative",epic:"Epic",issue:"Issue"},$n={project:"Top-level container for initiatives",initiative:"Strategic goal or theme (belongs to a project)",epic:"Large body of work (belongs to an initiative)",issue:"Specific task or bug (belongs to an epic)"},Me={project:null,initiative:"project",epic:"initiative",issue:"epic"};function $t(t,r=0){const n=[];for(const o of t)n.push({id:o.id,title:o.title,kind:o.kind,depth:r}),o.children?.length>0&&n.push(...$t(o.children,r+1));return n}function zn({open:t,onOpenChange:r,onCreated:n,defaultParentId:o,defaultKind:a="issue"}){const[i,l]=s.useState(""),[c,d]=s.useState(a),[m,f]=s.useState(""),[h,g]=s.useState(o),[p,y]=s.useState(""),[E,b]=s.useState(!1),[C,N]=s.useState(null),[R,T]=s.useState({}),[k,S]=s.useState([]),[P,W]=s.useState(!1);s.useEffect(()=>{if(!t)return;async function w(){W(!0);try{const L=await fetch("/api/work-items/tree",{headers:{accept:"application/json"}});if(L.ok){const z=await L.json();S($t(z.items))}}catch{}finally{W(!1)}}w()},[t]);const G=s.useCallback(()=>{l(""),d(a),f(""),g(o),y(""),N(null),T({})},[a,o]),q=s.useCallback(()=>{const w={};i.trim()||(w.title="Title is required");const L=Me[c];if(L&&!h&&c!=="issue"&&(w.parent=`${te[c]} requires a parent ${te[L]}`),h&&L){const z=k.find(Q=>Q.id===h);z&&z.kind!==L&&(w.parent=`${te[c]} parent must be a ${te[L]}`)}if(p){const z=parseInt(p,10);(isNaN(z)||z<0||z>525600)&&(w.estimate="Estimate must be between 0 and 525600 minutes")}return T(w),Object.keys(w).length===0},[i,c,h,k,p]),x=s.useCallback(async()=>{if(E||!q())return;b(!0),N(null);const w={title:i.trim(),kind:c,description:m.trim()||void 0,parentId:h??null,estimateMinutes:p?parseInt(p,10):null};try{const L=await fetch("/api/work-items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)});if(!L.ok){const he=(await L.json().catch(()=>({}))).error??`Failed to create work item (${L.status})`;N(he),b(!1);return}const z=await L.json();n?.(z),G(),r(!1)}catch(L){N(L instanceof Error?L.message:"Network error")}finally{b(!1)}},[i,c,m,h,p,E,q,n,r,G]),A=s.useCallback(w=>{w||G(),r(w)},[r,G]),O=Me[c],B=O?k.filter(w=>w.kind===O):[],J=c!=="project",ae=c==="issue"||c==="epic";return e.jsx(we,{open:t,onOpenChange:A,children:e.jsxs(Ce,{className:"sm:max-w-lg",children:[e.jsxs(Ne,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"size-5"}),"Create Work Item"]}),e.jsx(Ee,{children:"Fill in the details to create a new work item."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{htmlFor:"title",children:"Title"}),e.jsx(We,{id:"title",placeholder:"Enter title...",value:i,onChange:w=>l(w.target.value),"aria-invalid":!!R.title,autoFocus:!0}),R.title&&e.jsx("p",{className:"text-sm text-destructive",children:R.title})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{htmlFor:"kind",children:"Kind"}),e.jsxs(Oe,{value:c,onValueChange:w=>{if(d(w),h){const L=Me[w];k.find(Q=>Q.id===h)?.kind!==L&&g(void 0)}},children:[e.jsx($e,{id:"kind","aria-label":"Kind",children:e.jsx(ze,{placeholder:"Select kind"})}),e.jsx(Ke,{children:Object.entries(te).map(([w,L])=>e.jsx(ye,{value:w,children:e.jsxs("span",{className:"flex flex-col",children:[e.jsx("span",{children:L}),e.jsx("span",{className:"text-xs text-muted-foreground",children:$n[w]})]})},w))})]})]}),J&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{htmlFor:"parent",children:"Parent"}),e.jsxs(Oe,{value:h??"__none__",onValueChange:w=>g(w==="__none__"?void 0:w),disabled:c==="project"||P,children:[e.jsx($e,{id:"parent","aria-label":"Parent",disabled:c==="project"||P,children:e.jsx(ze,{placeholder:P?"Loading...":B.length===0?`No ${O?te[O]+"s":"parents"} available`:"Select parent..."})}),e.jsxs(Ke,{children:[e.jsx(ye,{value:"__none__",children:"None"}),B.map(w=>e.jsx(ye,{value:w.id,children:e.jsx("span",{style:{paddingLeft:`${w.depth*12}px`},children:w.title})},w.id))]})]}),R.parent&&e.jsx("p",{className:"text-sm text-destructive",children:R.parent})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{htmlFor:"description",children:"Description"}),e.jsx(fr,{id:"description",placeholder:"Enter description...",value:m,onChange:w=>f(w.target.value),rows:3})]}),ae&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{htmlFor:"estimate",children:"Estimate (minutes)"}),e.jsx(We,{id:"estimate",type:"number",placeholder:"e.g., 60",value:p,onChange:w=>y(w.target.value),min:0,max:525600,"aria-invalid":!!R.estimate}),R.estimate&&e.jsx("p",{className:"text-sm text-destructive",children:R.estimate})]}),C&&e.jsx("p",{className:"text-sm text-destructive",role:"alert",children:C})]}),e.jsxs(ht,{children:[e.jsx(je,{variant:"outline",onClick:()=>A(!1),disabled:E,children:"Cancel"}),e.jsx(je,{onClick:x,disabled:E,children:E?e.jsxs(e.Fragment,{children:[e.jsx(xt,{className:"mr-2 size-4 animate-spin"}),"Creating..."]}):"Create"})]})]})})}function Kn(t){return t.startsWith("/dashboard")?"dashboard":t.startsWith("/activity")?"activity":t.startsWith("/timeline")?"timeline":t.startsWith("/contacts")?"people":t.startsWith("/communications")?"communications":t.startsWith("/settings")?"settings":t.startsWith("/search")?"search":t.startsWith("/work-items")||t.startsWith("/kanban")?"projects":"dashboard"}const ct={dashboard:"/dashboard",activity:"/activity",projects:"/work-items",timeline:"/timeline",people:"/contacts",communications:"/communications",settings:"/settings"};function Fn(t,r){if(t.startsWith("/dashboard"))return[{id:"dashboard",label:"Dashboard"}];if(t.startsWith("/activity"))return[{id:"activity",label:"Activity"}];if(t.startsWith("/timeline"))return[{id:"timeline",label:"Timeline"}];if(t.startsWith("/contacts"))return[{id:"contacts",label:"People"}];if(t.startsWith("/communications"))return[{id:"communications",label:"Communications"}];if(t.startsWith("/settings"))return[{id:"settings",label:"Settings"}];const n=[{id:"work-items",label:"Projects",href:"/work-items"}];if(t.startsWith("/kanban"))return n.push({id:"kanban",label:"Kanban Board"}),n;const o=/^\/work-items\/([^/]+)\/timeline\/?$/.exec(t);if(o){const l=o[1];return n.push({id:"detail",label:r?.workItem?.title||l,href:`/work-items/${l}`},{id:"timeline",label:"Timeline"}),n}const a=/^\/work-items\/([^/]+)\/graph\/?$/.exec(t);if(a){const l=a[1];return n.push({id:"detail",label:r?.workItem?.title||l,href:`/work-items/${l}`},{id:"graph",label:"Dependencies"}),n}const i=/^\/work-items\/([^/]+)\/?$/.exec(t);if(i){const l=i[1];return n.push({id:"detail",label:r?.workItem?.title||l}),n}return n}function bs(){const t=zt(),r=Kt(),n=hr(),[o,a]=s.useState(!1),[i,l]=s.useState(!1),[c,d]=s.useState(void 0),m=s.useMemo(()=>Kn(t.pathname),[t.pathname]),f=s.useMemo(()=>Fn(t.pathname,n),[t.pathname,n]),h=s.useCallback(T=>{const k=ct[T];k&&r(k)},[r]),g=s.useCallback(async T=>{try{return(await pr.get(`/api/search?q=${encodeURIComponent(T)}&limit=10`)).results.map(S=>({id:S.id,type:S.type==="work_item"?"issue":S.type==="contact"?"contact":"issue",title:S.title,subtitle:S.description?.slice(0,80)||void 0,href:S.url}))}catch{return[]}},[]),p=s.useCallback(T=>{if(typeof T=="string")T==="create-issue"||T==="create-project"?r("/work-items"):T==="view-all"&&r("/search");else if(T.href){const k=T.href.startsWith("/app/")?T.href.replace("/app",""):T.href;r(k)}else r(`/work-items/${T.id}`)},[r]),y=s.useCallback(T=>{const k=ct[T];k&&r(k)},[r]),E=s.useCallback(()=>{h("search")},[h]),b=s.useMemo(()=>/^\/work-items\/([^/]+)/.exec(t.pathname)?.[1],[t.pathname]),C=s.useCallback(()=>{d(b||void 0),a(!0)},[b]),N=s.useCallback(T=>{r(`/work-items/${T.id}`)},[r]),R=s.useCallback(()=>{d(b||void 0),l(!0)},[b]);return e.jsxs(e.Fragment,{children:[e.jsx(Ln,{onNavigate:y,onSearch:E,onNewItem:C,onNewItemFullForm:R}),e.jsx(An,{open:o,onOpenChange:a,onCreated:N,defaultParentId:c}),e.jsx(zn,{open:i,onOpenChange:l,onCreated:N,defaultParentId:c}),e.jsx(In,{onSearch:g,onSelect:p,onNavigate:y}),e.jsx(Qr,{activeSection:m,onSectionChange:h,onCreateClick:R,breadcrumbs:f,onHomeClick:()=>r("/dashboard"),children:e.jsx(Ft,{})})]})}export{bs as AppLayout};
//# sourceMappingURL=app-layout-BhpPfMMT.js.map
